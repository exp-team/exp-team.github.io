<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>exp team</title>
  
  <subtitle>together, stronger</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://exp-team.github.io/"/>
  <updated>2017-11-05T02:48:25.000Z</updated>
  <id>https://exp-team.github.io/</id>
  
  <author>
    <name>exp developer</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>ä» React ç»‘å®š thisï¼Œçœ‹ JS è¯­è¨€å‘å±•å’Œæ¡†æ¶è®¾è®¡</title>
    <link href="https://exp-team.github.io/blog/2017/11/04/js/react-this/"/>
    <id>https://exp-team.github.io/blog/2017/11/04/js/react-this/</id>
    <published>2017-11-03T16:00:00.000Z</published>
    <updated>2017-11-05T02:48:25.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://upload-images.jianshu.io/upload_images/4363003-37229a920f78982c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="react"></p><p>åœ¨ javascript è¯­è¨€ä¸­ï¼Œå…³äº this è¿™ä¸ªå…³é”®å­—çš„è¡Œä¸ºä¸€ç›´ä»¥æ¥å›°æ‰°ç€ä¸€ä»£åˆä¸€ä»£åˆçº§å¼€å‘è€…ã€‚åŒæ—¶ thisï¼Œä¹Ÿå……åˆ†ååº”äº† javascript çš„è¯¡å¼‚ä¸çµæ´»ã€‚</p><p>ä½†æ˜¯è¯·åˆ«è¯¯ä¼šï¼Œè¿™ç¯‡æ–‡ç« å¹¶ä¸ä¼šå¯¹ this çš„ç‰¹å¾è¿›è¡Œå…¨æ–¹ä½è®²è§£ï¼Œå› ä¸ºè¿™äº›å†…å®¹éƒ½å¯ä»¥åœ¨å„ç§å‰ç«¯ä¹¦ç±ä¸­æ‰¾åˆ°ç­”æ¡ˆã€‚è¿™é‡Œï¼Œæˆ‘è¯•å›¾ç»“åˆ React äº‹ä»¶å¤„ç†å‡½æ•°å…³äº this ç»‘å®šçš„æ¼”åŒ–å²ï¼Œ<strong>è°ˆä¸€è°ˆè¿™ä¸ªæ¡†æ¶è®¾è®¡ä»¥åŠ javascript è¯­è¨€åœ¨è¿™ä¸€ç»†èŠ‚ä¸Šçš„è¿›æ­¥å’Œå®Œå–„</strong>ã€‚åŒæ—¶å¯¹æ¯” this ç»‘å®šçš„ä¸åŒæ–¹æ¡ˆï¼Œè®©å¤§å®¶å¯¹ React ã€ES next æœ‰ä¸€ä¸ªæ›´æ¸…æ™°çš„è®¤è¯†ã€‚</p><p>React å¤„ç† this ä¸Šä¸‹æ–‡ç¯å¢ƒå·²ç»æœ‰è‡³å°‘äº”å¹´å†å²äº†ã€‚äº”å¹´æœŸé—´ï¼Œæ–¹æ¡ˆè¾ˆå‡ºï¼Œæˆ‘ä»¬å…ˆæ¥æ€»ç»“ä¸€ä¸‹ã€‚<br><br></p><h2 id="æ–¹æ³•ä¸€ï¼šReact-createClass-è‡ªåŠ¨ç»‘å®š"><a href="#æ–¹æ³•ä¸€ï¼šReact-createClass-è‡ªåŠ¨ç»‘å®š" class="headerlink" title="æ–¹æ³•ä¸€ï¼šReact.createClass è‡ªåŠ¨ç»‘å®š"></a>æ–¹æ³•ä¸€ï¼šReact.createClass è‡ªåŠ¨ç»‘å®š</h2><p>React ä¸­åˆ›å»ºç»„ä»¶çš„æ–¹å¼å·²ç»å¾ˆå¤šï¼Œæ¯”è¾ƒå¤è€çš„è¯¸å¦‚ React.createClass åº”è¯¥å¾ˆå¤šäººå¹¶ä¸é™Œç”Ÿã€‚å½“ç„¶ï¼Œä» React 0.13 å¼€å§‹ï¼Œå¯ä»¥ä½¿ç”¨ ES6 Class ä»£æ›¿ React.createClass äº†ï¼Œè¿™åº”è¯¥æ˜¯ä»Šåæ¨èçš„æ–¹æ³•ã€‚<br>ä½†æ˜¯éœ€è¦çŸ¥é“ï¼ŒReact.createClass åˆ›å»ºçš„ç»„ä»¶ï¼Œå¯ä»¥è‡ªåŠ¨ç»‘å®š thisã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œthis è¿™ä¸ªå…³é”®å­—ä¼šè‡ªåŠ¨ç»‘å®šåœ¨ç»„ä»¶å®ä¾‹ä¸Šé¢ã€‚</p><pre><code>// This magically works with React.createClass// because `this` is bound for you.onChange = {this.handleChange}</code></pre><p>å½“ç„¶å¾ˆé—æ†¾ï¼Œå¯¹äºç»„ä»¶çš„åˆ›å»ºï¼Œå®˜æ–¹å·²ç»æ¨èä½¿ç”¨ class å£°æ˜ç»„ä»¶æˆ–ä½¿ç”¨ functional æ— çŠ¶æ€ç»„ä»¶ï¼š</p><blockquote><p>Later, classes were added to the language as part of ES2015, so we added the ability to create React components using JavaScript classes. Along with functional components, JavaScript classes are now the preferred way to create components in React.<br>For your existing createClass components, we recommend that you migrate them to JavaScript classes. </p></blockquote><p>æˆ‘è®¤ä¸ºï¼Œè¿™å…¶å®æ˜¯ React æ¡†æ¶æœ¬èº«çš„è‡ªæˆ‘å®Œå–„å’Œå¯¹æœªæ¥çš„è¿åˆï¼Œæ˜¯æ¡†æ¶å’Œè¯­è¨€å‘å±•çš„å¤§åŠ¿æ‰€è¶‹ã€‚</p><p><br></p><h2 id="æ–¹æ³•äºŒï¼šæ¸²æŸ“æ—¶ç»‘å®š"><a href="#æ–¹æ³•äºŒï¼šæ¸²æŸ“æ—¶ç»‘å®š" class="headerlink" title="æ–¹æ³•äºŒï¼šæ¸²æŸ“æ—¶ç»‘å®š"></a>æ–¹æ³•äºŒï¼šæ¸²æŸ“æ—¶ç»‘å®š</h2><p>é€šè¿‡å‰æ–‡ï¼Œæˆ‘ä»¬çŸ¥é“æœ€ä¼ ç»Ÿçš„ç»„ä»¶åˆ›å»ºæ–¹å¼ä¸ä¼šæœ‰ this ç»‘å®šçš„å›°æ‰°ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å‡å®šæ‰€æœ‰çš„ç»„ä»¶éƒ½é‡‡å– ES6 classes æ–¹å¼å£°æ˜ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œthis æ— æ³•è‡ªåŠ¨ç»‘å®šã€‚ä¸€ä¸ªå¸¸è§çš„è§£å†³æ–¹æ¡ˆä¾¿æ˜¯ï¼š</p><pre><code>onChange = {this.handleChange.bind(this)}</code></pre><p>è¿™ç§æ–¹æ³•ç®€æ˜æ‰¼è¦ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªæ½œåœ¨çš„æ€§èƒ½é—®é¢˜ï¼š<strong>å½“ç»„ä»¶æ¯æ¬¡é‡æ–°æ¸²æŸ“æ—¶ï¼Œéƒ½ä¼šæœ‰ä¸€ä¸ªæ–°çš„å‡½æ•°åˆ›å»º</strong>ã€‚OMG! è¿™å¬ä¸Šå»è²Œä¼¼æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„é—®é¢˜ï¼Œä½†æ˜¯å…¶å®åœ¨çœŸæ­£çš„å¼€å‘åœºæ™¯ä¸­ï¼Œç”±æ­¤å¼•å‘çš„æ€§èƒ½é—®é¢˜å¾€å¾€ä¸å€¼ä¸€æï¼ˆé™¤éæ˜¯å¤§å‹ç»„ä»¶æ¶ˆè´¹ç±»åº”ç”¨æˆ–æ¸¸æˆï¼‰ã€‚</p><p><br></p><h2 id="æ–¹æ³•ä¸‰ï¼šç®­å¤´å‡½æ•°ç»‘å®š"><a href="#æ–¹æ³•ä¸‰ï¼šç®­å¤´å‡½æ•°ç»‘å®š" class="headerlink" title="æ–¹æ³•ä¸‰ï¼šç®­å¤´å‡½æ•°ç»‘å®š"></a>æ–¹æ³•ä¸‰ï¼šç®­å¤´å‡½æ•°ç»‘å®š</h2><p>è¿™ç§æ–¹æ³•å…¶å®å’Œç¬¬äºŒç§ç±»ä¼¼ï¼Œæ‹œ ES6 ç®­å¤´å‡½æ•°æ‰€èµï¼Œæˆ‘ä»¬å¯ä»¥éšå¼ç»‘å®š thisï¼š</p><pre><code>onChange = {e =&gt; this.handleChange(e)}</code></pre><p>å½“ç„¶ï¼Œä¹Ÿä¸ç¬¬äºŒç§æ–¹æ³•ä¸€æ ·ï¼Œ<strong>å®ƒåŒæ ·å­˜åœ¨æ½œåœ¨çš„æ€§èƒ½é—®é¢˜</strong>ã€‚<br>ä¸‹é¢å°†è¦ä»‹ç»çš„ä¸¤ç§æ–¹æ³•ï¼Œå¯ä»¥æœ‰æ•ˆè§„é¿ä¸å¿…è¦çš„æ€§èƒ½æ¶ˆè€—ï¼Œè¯·ç»§ç»­é˜…è¯»ã€‚</p><p><br></p><h2 id="æ–¹æ³•å››ï¼šConstructor-å†…ç»‘å®š"><a href="#æ–¹æ³•å››ï¼šConstructor-å†…ç»‘å®š" class="headerlink" title="æ–¹æ³•å››ï¼šConstructor å†…ç»‘å®š"></a>æ–¹æ³•å››ï¼šConstructor å†…ç»‘å®š</h2><p>constructor æ–¹æ³•æ˜¯ç±»çš„é»˜è®¤æ–¹æ³•ï¼Œé€šè¿‡newå‘½ä»¤ç”Ÿæˆå¯¹è±¡å®ä¾‹æ—¶ï¼Œè‡ªåŠ¨è°ƒç”¨è¯¥æ–¹æ³•ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ï¼š</p><pre><code>constructor(props) {    super(props);    this.handleChange = this.handleChange.bind(this);}</code></pre><p>è¿™ç§æ–¹å¼å¾€å¾€è¢«æ¨èä¸ºâ€œ<strong>æœ€ä½³å®è·µ</strong>â€ï¼Œä¹Ÿæ˜¯ç¬”è€…æœ€ä¸ºå¸¸ç”¨çš„æ–¹æ³•ã€‚</p><p>ä½†æ˜¯å°±ä¸ªäººä¹ æƒ¯è€Œè¨€ï¼Œæˆ‘è®¤ä¸ºä¸å‰ä¸¤ç§æ–¹æ³•ç›¸æ¯”ï¼Œconstructor å†…ç»‘å®šåœ¨å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ä¸Šä¹Ÿè®¸æœ‰äº›æ¬ ç¼ºã€‚<br>åŒæ—¶ï¼Œæˆ‘ä»¬çŸ¥é“åœ¨ constructor å£°æ˜çš„æ–¹æ³•ä¸ä¼šå­˜åœ¨å®ä¾‹çš„åŸå‹ä¸Šï¼Œè€Œå±äºå®ä¾‹æœ¬èº«çš„æ–¹æ³•ã€‚æ¯ä¸ªå®ä¾‹éƒ½æœ‰åŒæ ·ä¸€ä¸ª handleChangeï¼Œè¿™æœ¬èº«ä¹Ÿæ˜¯ä¸€ç§é‡å¤å’Œæµªè´¹ã€‚</p><p>å¦‚æœä½ å¯¹ ES next ä¸€ç›´æŠ±æœ‰å¼€æ”¾çš„æ€æƒ³ï¼Œä¸”èƒ½å¤Ÿä½¿ç”¨ stage-2 çš„ç‰¹æ€§ï¼Œä¸å¦¨å°è¯•ä¸€ä¸‹æœ€åä¸€ç§æ–¹æ¡ˆã€‚</p><p><br></p><h2 id="æ–¹æ³•äº”ï¼šClass-å±æ€§ä¸­ä½¿ç”¨-å’Œç®­å¤´å‡½æ•°"><a href="#æ–¹æ³•äº”ï¼šClass-å±æ€§ä¸­ä½¿ç”¨-å’Œç®­å¤´å‡½æ•°" class="headerlink" title="æ–¹æ³•äº”ï¼šClass å±æ€§ä¸­ä½¿ç”¨ = å’Œç®­å¤´å‡½æ•°"></a>æ–¹æ³•äº”ï¼šClass å±æ€§ä¸­ä½¿ç”¨ = å’Œç®­å¤´å‡½æ•°</h2><p>è¿™ä¸ªæ–¹æ³•ä¾èµ–äº ES next çš„æ–°ç‰¹æ€§ï¼Œè¯·å‚è€ƒ<a href="https://tc39.github.io/proposal-class-public-fields/" target="_blank" rel="external"> tc 39: Public Class Fields</a></p><pre><code>handleChange = () =&gt; {      // call this function from render       // and this.whatever in here works fine.};</code></pre><p>æˆ‘ä»¬æ¥æ€»ç»“ä¸€ä¸‹è¿™ç§æ–¹å¼çš„ä¼˜ç‚¹ï¼š</p><ul><li>ä½¿ç”¨ç®­å¤´å‡½æ•°ï¼Œæœ‰æ•ˆç»‘å®šäº† thisï¼›</li><li>æ²¡æœ‰ç¬¬äºŒç§æ–¹æ³•å’Œç¬¬ä¸‰ç§æ–¹æ³•çš„æ½œåœ¨æ€§èƒ½é—®é¢˜ï¼›</li><li>é¿å…äº†æ–¹æ³•å››çš„ç»„ä»¶å®ä¾‹é‡å¤é—®é¢˜ï¼›</li><li>æˆ‘ä»¬å¯ä»¥ç›´æ¥ä» ES5 createClass é‡æ„å¾—æ¥ã€‚</li></ul><p><br></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ¬æ–‡åœ¨å¯¹æ¯” React ç»‘å®š this çš„äº”ç§æ–¹æ³•çš„åŒæ—¶ï¼Œä¹Ÿç”±è¿œåŠè¿‘äº†è§£äº† javascript è¯­è¨€çš„å‘å±•ï¼šä» ES5 çš„ bindï¼Œ åˆ° ES6 çš„ç®­å¤´å‡½æ•°ï¼Œå†åˆ° ES next å¯¹ class çš„æ”¹è¿›ã€‚</p><p>React ä½œä¸ºè“¬å‹ƒå‘å±•çš„æ¡†æ¶ä¹ŸåŒæ ·åœ¨ä¸æ—¶å…·è¿›ï¼Œä¸æ–­å®Œå–„ï¼Œç»“åˆè¯­è¨€ç‰¹æ€§çš„å‘å±•ä¸æ–­è°ƒæ•´ç€è‡ªèº«ã€‚</p><p>æœ€åï¼Œæˆ‘ä»¬é€šè¿‡è¿™å¼ å›¾ç‰‡æ¥å®Œæ•´å›é¡¾ï¼š</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-25a0fd5ac57e5b6c?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å„ç§æ–¹å¼é€»è¾‘"></p><p>æœ¬æ–‡å‚è€ƒäº† Cory House çš„æ–‡ç« ï¼š<a href="https://medium.freecodecamp.com/react-binding-patterns-5-approaches-for-handling-this-92c651b5af56" target="_blank" rel="external">5 Approaches for Handling <code>this</code></a>ï¼Œå¹¶åœ¨æ­¤åŸºç¡€ä¸Šè¿›è¡Œå»¶ä¼¸ã€‚<br><br><br><br><strong>æˆ‘çš„å…¶ä»–ä¸€äº›å…³äº React æ–‡ç« ï¼š</strong></p><ul><li><a href="http://www.jianshu.com/p/78cfc7e0067f" target="_blank" rel="external">React ç»„ä»¶è®¾è®¡å’Œåˆ†è§£æ€è€ƒ</a></li><li><a href="http://www.jianshu.com/p/49029b49f2b4" target="_blank" rel="external">åšå‡ºUberç§»åŠ¨ç½‘é¡µç‰ˆè¿˜ä¸å¤Ÿ æè‡´æ€§èƒ½æ‰“é€ æ‰è§çœŸç« </a></li><li><a href="http://www.jianshu.com/p/7a56ac1de2a8" target="_blank" rel="external">è§£æTwitterå‰ç«¯æ¶æ„ å­¦ä¹ å¤æ‚åœºæ™¯æ•°æ®è®¾è®¡</a></li><li><a href="http://www.jianshu.com/p/83c86dd0802d" target="_blank" rel="external">React Conf 2017 å¹²è´§æ€»ç»“1: React + ES next = â™¥</a></li><li><a href="http://www.jianshu.com/p/cde3cf7e2760" target="_blank" rel="external">React+Reduxæ‰“é€ â€œNEWS EARLYâ€å•é¡µåº”ç”¨ ä¸€ä¸ªé¡¹ç›®ç†è§£æœ€å‰æ²¿æŠ€æœ¯æ ˆçœŸè°›</a></li><li><a href="http://www.jianshu.com/p/8e28be0e7ab1" target="_blank" rel="external">ä¸€ä¸ªreact+reduxå·¥ç¨‹å®ä¾‹</a></li><li>â€¦â€¦</li></ul><p>Happy Coding!</p><p>PS: ä½œè€…<a href="https://github.com/HOUCe" target="_blank" rel="external">Githubä»“åº“</a>ï¼Œæ¬¢è¿é€šè¿‡ä»£ç å„ç§å½¢å¼äº¤æµã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/4363003-37229a920f78982c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; 
      
    
    </summary>
    
      <category term="js" scheme="https://exp-team.github.io/categories/js/"/>
    
    
      <category term="js" scheme="https://exp-team.github.io/tags/js/"/>
    
  </entry>
  
  <entry>
    <title>React æœåŠ¡ç«¯æ¸²æŸ“å¦‚æ­¤è½»æ¾ ä»é›¶å¼€å§‹æ„å»ºå‰åç«¯åº”ç”¨</title>
    <link href="https://exp-team.github.io/blog/2017/11/04/js/next/"/>
    <id>https://exp-team.github.io/blog/2017/11/04/js/next/</id>
    <published>2017-11-03T16:00:00.000Z</published>
    <updated>2017-11-05T02:44:12.000Z</updated>
    
    <content type="html"><![CDATA[<p>å‚åŠ æˆ–ç•™æ„äº†æœ€è¿‘ä¸¾è¡Œçš„<a href="https://www.zhihu.com/question/62154473/answer/200045569" target="_blank" rel="external">JSConf CN 2017</a>çš„åŒå­¦ï¼Œæƒ³å¿…å¯¹ Next.js ä¸å†é™Œç”Ÿï¼Œ Next.js çš„ä½œè€…ä¹‹ä¸€ Guillermo Rauch åˆ°åœºè¿›è¡Œäº†ç²¾å½©çš„æ¼”è®²ã€‚å…¶å®åœ¨æ›´æ—©äº›æ—¶å€™ï¼Œç”± Facebook ä¸¾åŠçš„ React Conf 2017ï¼Œä»–å°±åˆ°åœºå¹¶æœ‰è¿‘40åˆ†é’Ÿçš„åˆ†äº«ã€‚ä½†ä¸¤æ¬¡åˆ†äº«å¸¦æ¥çš„ demo éƒ½æ˜¯ hacker newsã€‚æˆ‘è§‚å¯Ÿ Next.js æ—¶é—´è¾ƒé•¿ï¼Œçœ‹ç€å®ƒä»1.x ç‰ˆæœ¬ä¸€ç›´åˆ°äº†ä»Šå¤©çš„ 3.xï¼Œç»ˆäºå†³å®šå†™ä¸€ç¯‡å…¥é—¨çº§çš„æ–°æ‰‹æŒ‡å¯¼æ–‡ç« ã€‚è€Œè¿™ç¯‡æ–‡ç« è¯•å›¾é€šè¿‡ä¸€ä¸ªå…¨æ–°çš„ä¾‹å­ï¼Œæ¥è®©å¤§å®¶äº†è§£ Next.js åˆ°åº•æ˜¯å¦‚ä½•ä¸ React é…åˆï¼Œè¾¾åˆ°æœåŠ¡ç«¯æ¸²æŸ“çš„ã€‚</p><p>â€œReact universalâ€ æ˜¯ç¤¾åŒºä¸Šå½¢å®¹åŸºäº React æ„å»º web åº”ç”¨ï¼Œå¹¶é‡‡ç”¨â€œæœåŠ¡ç«¯æ¸²æŸ“â€æ–¹å¼çš„ä¸€ä¸ªè¯è¯­ã€‚ä¹Ÿè®¸å¾ˆå¤šäººå¯¹ â€œisomorphicâ€ è¿™ä¸ªå•è¯æ›´åŠ ç†Ÿæ‚‰ï¼Œå…¶å®è¿™ä¸¤ä¸ªè¯è¯­æƒ³è¦è¡¨è¾¾çš„æ¦‚å¿µç±»ä¼¼ã€‚ä»Šå¤©è¿™ç¯‡æ–‡ç« æ˜¾ç„¶ä¸æ˜¯è®¨è®ºè¿™ä¸¤ä¸ªè¯è¯­çš„ï¼Œ<strong>æˆ‘ä»¬è¦å°è¯•ä½¿ç”¨æœ€æ–°ç‰ˆ <a href="https://github.com/zeit/next.js" target="_blank" rel="external">Next.js</a>ï¼Œæ„ä»¶ä¸€ä¸ªç®€å•çš„æœåŠ¡ç«¯æ¸²æŸ“ React åº”ç”¨ã€‚</strong>æœ€ç»ˆé¡¹ç›®åœ°å€å¯ä»¥<a href="https://github.com/HOUCe/server-side-react-football" target="_blank" rel="external">ç‚¹å‡»è¿™é‡ŒæŸ¥çœ‹ã€‚</a></p><h2 id="ä¸ºä½•è¦å¼€å‘-Universal-åº”ç”¨ï¼Ÿ"><a href="#ä¸ºä½•è¦å¼€å‘-Universal-åº”ç”¨ï¼Ÿ" class="headerlink" title="ä¸ºä½•è¦å¼€å‘ Universal åº”ç”¨ï¼Ÿ"></a>ä¸ºä½•è¦å¼€å‘ Universal åº”ç”¨ï¼Ÿ</h2><p>React app å®ç°äº†è™šæ‹Ÿ DOMï¼Œæ¥å®ç°å¯¹çœŸå® DOM çš„æŠ½è±¡ã€‚è¿™æ ·çš„è®¾è®¡è¿…é€Ÿå¼•é¢†äº†å‰ç«¯å¼€å‘æµªæ½®ã€‚ä½†æ˜¯ â€œEvery great thing comes with a priceâ€ï¼Œè™šæ‹Ÿ DOM åŒæ ·å¸¦æ¥äº†ä¸€äº›å¼Šç«¯ï¼Œæ¯”å¦‚åœ¨å‰åç«¯åˆ†ç¦»çš„å¼€å‘æ¨¡å¼ä¸‹ï¼ŒSEOå°±æˆäº†é—®é¢˜ï¼›åŒæ ·é¦–å±åŠ è½½æ—¶é—´å˜é•¿ï¼Œå„ç§ loading æ¶ˆç£¨äººçš„è€å¿ƒã€‚å°±åƒä¸‹é¢æˆªå›¾æ‰€å±•ç°çš„é‚£æ ·ï¼š</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-0caa6abef06e4c3a.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="é¡µé¢"></p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-fec93cb7b90b4938.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æŸ¥çœ‹ç½‘é¡µæºç "></p><h2 id="ä½¿ç”¨-Next-js-å®ç°-Universal"><a href="#ä½¿ç”¨-Next-js-å®ç°-Universal" class="headerlink" title="ä½¿ç”¨ Next.js å®ç° Universal"></a>ä½¿ç”¨ Next.js å®ç° Universal</h2><p>Universal åº”ç”¨æ¶æ„å¯ä»¥ç®€å•ç²—æš´å…ˆè€Œç‰‡é¢çš„ç†è§£æˆåº”ç”¨å°†åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å…±åŒå®Œæˆæ¸²æŸ“ã€‚è¿™æ ·å–ä»£äº†å®Œå…¨ç”±å®¢æˆ·ç«¯æ¸²æŸ“ï¼ˆå‰åç«¯åˆ†ç¦»æ–¹å¼ï¼‰æ¨¡å¼ã€‚åœ¨ React åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ React è‡ªèº«çš„ renderToString å®ŒæˆæœåŠ¡ç«¯åˆæ¬¡æ¸²æŸ“ã€‚ä½†æ˜¯å¦‚æœæˆ‘ä»¬æ¯æ¬¡æ‰‹åŠ¨æ¥å®Œæˆè¿™äº›è¿‡ç¨‹ï¼Œæ‰‹åŠ¨å®ç°æœåŠ¡ç«¯ç¹çé…ç½®ï¼Œéš¾å…ä»¤äººå¤´å¤§å¿ƒçƒ¦ã€‚</p><p>Next.js çš„å‡ºç°ï¼Œå°±æ˜¯ä¸ºä½ è§£å†³è¿™ç§æ¼äººçš„é—®é¢˜ã€‚æˆ‘ä»¬å…ˆæ¥è®¤è¯†ä¸€ä¸‹å®ƒçš„å‡ ä¸ªåŸåˆ™å’Œæ€æƒ³ï¼š</p><ul><li>ä¸éœ€è¦é™¤ Next ä¹‹å¤–ï¼Œå¤šä½™çš„é…ç½®å’Œå®‰è£…ï¼ˆæ¯”å¦‚ webpackï¼Œbabelï¼‰ï¼›</li><li>ä½¿ç”¨ <a href="https://github.com/threepointone/glamor" target="_blank" rel="external">Glamor</a> å¤„ç†æ ·å¼ï¼›</li><li>è‡ªåŠ¨ç¼–è¯‘å’Œæ‰“åŒ…ï¼›</li><li>çƒ­æ›´æ–°ï¼›</li><li>æ–¹ä¾¿çš„é™æ€èµ„æºç®¡ç†ï¼›</li><li>æˆç†Ÿçµæ´»çš„è·¯ç”±é…ç½®ï¼ŒåŒ…æ‹¬è·¯ç”±çº§åˆ« prefetchingï¼›</li></ul><h2 id="Demoï¼šè‹±è¶…è”èµ›ç§¯åˆ†æ¦œ"><a href="#Demoï¼šè‹±è¶…è”èµ›ç§¯åˆ†æ¦œ" class="headerlink" title="Demoï¼šè‹±è¶…è”èµ›ç§¯åˆ†æ¦œ"></a>Demoï¼šè‹±è¶…è”èµ›ç§¯åˆ†æ¦œ</h2><p>å…¶å®å…³äºæ›´å¤šçš„ Next.js è®¾è®¡ç†å¿µæˆ‘ä¸æƒ³å†èµ˜è¿°äº†ï¼Œè¯»è€…éƒ½å¯ä»¥åœ¨å…¶å®˜ç½‘æ‰¾åˆ°ä¸°å¯Œçš„å†…å®¹ã€‚ä¸‹é¢ï¼Œæˆ‘å°†ä½¿ç”¨ Football Data API æ¥ç®€å•å¼€å‘ä¸€ä¸ªåŸºäº Next.js çš„åº”ç”¨ï¼Œè¿™ä¸ªåº”ç”¨å°†å±•ç°è‹±è¶…è”èµ›çš„å®æ—¶ç§¯åˆ†æ¦œã€‚åŒæ—¶åŒ…å«äº†ç®€å•çš„è·¯ç”±å¼€å‘å’Œé¡µé¢è·³è½¬ã€‚</p><h3 id="å°è¯•ç‰›åˆ€"><a href="#å°è¯•ç‰›åˆ€" class="headerlink" title="å°è¯•ç‰›åˆ€"></a>å°è¯•ç‰›åˆ€</h3><p>ç›¸ä¿¡æ‰€æœ‰çš„å¼€å‘è€…éƒ½åŒæ¶è¶…é•¿æ—¶é—´çš„å®‰è£…å’Œå„ç§ä¾èµ–ã€æ’ä»¶é…ç½®ã€‚ä¸è¦æ‹…å¿ƒï¼ŒNext.js ä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„ npm package æœ€å¤§é™åº¦çš„æ›¿ä½ å®Œæˆäº†å¾ˆå¤šè€—æ—¶ä¸”æ— è¶£çš„å·¥ä½œã€‚æˆ‘ä»¬é¦–å…ˆéœ€è¦è¿›è¡Œå®‰è£…ï¼š</p><pre><code># Start a new projectnpm init# Install Next.jsnpm install next@beta react react-dom --save</code></pre><p>å®‰è£…ç»“æŸåï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å¯è„šæœ¬ï¼š</p><pre><code>&quot;scripts&quot;: {   &quot;start&quot;: &quot;next&quot; },</code></pre><p>æ¥ä¸‹æ¥æ‰€éœ€è¦åšçš„å¾ˆç®€å•ï¼Œå°±æ˜¯åœ¨æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª pages æ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨å…¶ä¸‹æ–°å»ºä¸€ä¸ª index.js æ–‡ä»¶ï¼š</p><pre><code>// ./pages/index.js// Import Reactimport React from &apos;react&apos;// Export an anonymous arrow function// which returns the templateexport default () =&gt; (  &lt;h1&gt;This is just so easy!&lt;/h1&gt;)</code></pre><p>å¥½äº†ï¼Œç°åœ¨å°±å¯ä»¥ç›´æ¥çœ‹åˆ°ç»“æœï¼š</p><pre><code># Start your appnpm start</code></pre><p><img src="http://upload-images.jianshu.io/upload_images/4363003-b1afa6031e077f67.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="é¡µé¢"></p><p>éªŒè¯ä¸€ä¸‹å®ƒæ¥è‡ªæœåŠ¡ç«¯æ¸²æŸ“ï¼š</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-e1310faf126ca61e.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æŸ¥çœ‹ç½‘é¡µæºç "></p><p>å°±æ˜¯è¿™ä¹ˆç®€å•æ¸…æ–°ã€‚æ€»ç»“ä¸€ä¸‹ï¼Œ<strong>å®‰è£…è¿™ä¸ªæ¡†æ¶ä¼šæ­å»ºä¸€ä¸ªåŸºäº Reactã€webpack å’Œ Babel çš„æ„å»ºè¿‡ç¨‹ã€‚</strong>å¦‚æœæˆ‘ä»¬è‡ªå·±æ‰‹æ®µå®ç°è¿™ä¸€åˆ‡çš„è¯ï¼Œé™¤äº† NodeJS çš„ç§ç§ç¹çä¸è¯´ï¼Œwebpack é…ç½®ï¼Œnode_modules ä¾èµ–ï¼Œbabelæ’ä»¶ç­‰ç­‰å°±å¤ŸæŠ˜è…¾åŠå¤©çš„äº†ã€‚</p><h2 id="æ·»åŠ -Page-Head"><a href="#æ·»åŠ -Page-Head" class="headerlink" title="æ·»åŠ  Page Head"></a>æ·»åŠ  Page Head</h2><p>åœ¨ ./pages/index.js æ–‡ä»¶å†…ï¼Œæˆ‘ä»¬å¯ä»¥æ·»åŠ é¡µé¢ head æ ‡ç­¾ã€meta ä¿¡æ¯ã€æ ·å¼èµ„æºç­‰ç­‰ï¼š</p><pre><code>// ./pages/index.jsimport React from &apos;react&apos;// Import the Head Componentimport Head from &apos;next/head&apos;export default () =&gt; (  &lt;div&gt;    &lt;Head&gt;        &lt;title&gt;League Table&lt;/title&gt;        &lt;meta name=&quot;viewport&quot; content=&quot;initial-scale=1.0, width=device-width&quot; /&gt;        &lt;link rel=&quot;stylesheet&quot; href=&quot;https://unpkg.com/purecss@0.6.1/build/pure-min.css&quot; /&gt;    &lt;/Head&gt;    &lt;h1&gt;This is just so easy!&lt;/h1&gt;  &lt;/div&gt;)</code></pre><p>è¿™ä¸ª head å½“ç„¶ä¸æ˜¯æŒ‡çœŸå®çš„ DOMï¼Œåƒä¸‡åˆ«å¿˜äº† React è™šæ‹Ÿ DOM çš„æ¦‚å¿µã€‚å…¶å®è¿™æ˜¯ Next æä¾›çš„ Head ç»„ä»¶ï¼Œä¸è¿‡æœ€ç»ˆä¸€å®šè¿˜æ˜¯è¢«æ¸²æŸ“æˆä¸ºçœŸå®çš„ head æ ‡ç­¾ã€‚</p><h2 id="å‘é€-Ajax-è¯·æ±‚"><a href="#å‘é€-Ajax-è¯·æ±‚" class="headerlink" title="å‘é€ Ajax è¯·æ±‚"></a>å‘é€ Ajax è¯·æ±‚</h2><p>Next è¿˜æä¾›äº† getInitialProps() ç»„ä»¶ç”Ÿå‘½å‘¨æœŸé’©å­æ–¹æ³•ï¼Œä½¿å¾—æ¡†æ¶èƒ½å¤Ÿåœ¨æœåŠ¡å™¨ä¸Šè¿›è¡Œåˆå§‹æ¸²æŸ“ï¼Œå¦‚æœéœ€è¦çš„è¯ï¼Œè¿˜å¯ä»¥åœ¨å®¢æˆ·ç«¯ç»§ç»­è¿›è¡Œæ¸²æŸ“ã€‚è¿™ä¸ªé«˜çº§ç‰¹æ€§å¾ˆå°å´åŠŸèƒ½å¼ºå¤§ã€‚</p><p>è¿™ä¸ªæ–¹æ³•æ”¯æŒå¼‚æ­¥é€‰é¡¹ï¼Œå¹¶ä¸”æ˜¯æœåŠ¡ç«¯/å®¢æˆ·ç«¯åŒæ„çš„ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ async/await æ–¹å¼ï¼Œå¤„ç†å¼‚æ­¥è¯·æ±‚ã€‚è¯·çœ‹ä¸‹é¢çš„ç¤ºä¾‹ï¼š</p><pre><code>import React from &apos;react&apos;import Head from &apos;next/head&apos;import axios from &apos;axios&apos;;export default class extends React.Component {    // Async operation with getInitialProps    static async getInitialProps () {        // res is assigned the response once the axios        // async get is completed        const res = await axios.get(&apos;http://api.football-data.org/v1/competitions/426/leagueTable&apos;);        // Return properties        return {data: res.data}      } }</code></pre><p>æˆ‘ä»¬ä½¿ç”¨äº† axios ç±»åº“æ¥å‘é€ HTTP è¯·æ±‚ã€‚ç½‘ç»œè¯·æ±‚æ˜¯å¼‚æ­¥çš„ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦åœ¨æœªæ¥æŸä¸ªåˆé€‚çš„æ—¶å€™ï¼ˆè¯·æ±‚ç»“æœè¿”å›æ—¶ï¼‰æ¥æ”¶æ•°æ®ã€‚è¿™é‡Œä½¿ç”¨å…ˆè¿›çš„ async/awaitï¼Œä»¥åŒæ­¥çš„æ–¹å¼å¤„ç†ï¼Œä»è€Œé¿å…äº†å›è°ƒåµŒå¥—å’Œ promises é“¾ã€‚</p><p>æˆ‘ä»¬å°†å¼‚æ­¥è·å¾—çš„æ•°æ®è¿”å›ï¼Œå®ƒå°†è‡ªåŠ¨æŒ‚è½½åœ¨ props ä¸Šï¼ˆæ³¨æ„ getInitialProps æ–¹æ³•åï¼Œé¡¾åæ€ä¹‰ï¼‰ï¼Œrender æ–¹æ³•é‡Œä¾¿å¯ä»¥é€šè¿‡ this.props.data è·å–ï¼š</p><pre><code>import React from &apos;react&apos;import Head from &apos;next/head&apos;import axios from &apos;axios&apos;;export default class extends React.Component {  static async getInitialProps () {    const res = await axios.get(&apos;http://api.football-data.org/v1/competitions/426/leagueTable&apos;);    return {data: res.data}  }  render () {    return (      &lt;div&gt;        &lt;Head&gt;            ......        &lt;/Head&gt;        &lt;div className=&quot;pure-g&quot;&gt;            &lt;div className=&quot;pure-u-1-3&quot;&gt;&lt;/div&gt;            &lt;div className=&quot;pure-u-1-3&quot;&gt;              &lt;h1&gt;Barclays Premier League&lt;/h1&gt;              &lt;table className=&quot;pure-table&quot;&gt;                &lt;thead&gt;                  &lt;tr&gt;                    ......                  &lt;/tr&gt;                &lt;/thead&gt;                &lt;tbody&gt;                {this.props.data.standing.map((standing, i) =&gt; {                  const oddOrNot = i % 2 == 1 ? &quot;pure-table-odd&quot; : &quot;&quot;;                  return (                      &lt;tr key={i} className={oddOrNot}&gt;                        &lt;td&gt;{standing.position}&lt;/td&gt;                        &lt;td&gt;&lt;img className=&quot;pure-img logo&quot; src={standing.crestURI}/&gt;&lt;/td&gt;                        &lt;td&gt;{standing.points}&lt;/td&gt;                        &lt;td&gt;{standing.goals}&lt;/td&gt;                        &lt;td&gt;{standing.wins}&lt;/td&gt;                        &lt;td&gt;{standing.draws}&lt;/td&gt;                        &lt;td&gt;{standing.losses}&lt;/td&gt;                      &lt;/tr&gt;                    );                })}                &lt;/tbody&gt;              &lt;/table&gt;            &lt;/div&gt;            &lt;div className=&quot;pure-u-1-3&quot;&gt;&lt;/div&gt;        &lt;/div&gt;      &lt;/div&gt;    );  }}</code></pre><p>è¿™æ ·ï¼Œå†è®¿é—®æˆ‘ä»¬çš„é¡µé¢ï¼Œå°±æœ‰äº†ï¼š</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-da9e671c438902f2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="é¡µé¢"></p><h2 id="è·¯ç”±å’Œé¡µé¢è·³è½¬"><a href="#è·¯ç”±å’Œé¡µé¢è·³è½¬" class="headerlink" title="è·¯ç”±å’Œé¡µé¢è·³è½¬"></a>è·¯ç”±å’Œé¡µé¢è·³è½¬</h2><p>ä¹Ÿè®¸ä½ å·²ç»æœ‰æ‰€æ„ŸçŸ¥ï¼šæˆ‘ä»¬å·²ç»æœ‰äº†æœ€åŸºæœ¬çš„ä¸€ä¸ªè·¯ç”±ã€‚Next ä¸éœ€è¦ä»»ä½•é¢å¤–çš„è·¯ç”±é…ç½®ä¿¡æ¯ï¼Œä½ åªéœ€è¦åœ¨ pages æ–‡ä»¶å¤¹ä¸‹æ–°å»ºæ–‡ä»¶ï¼Œæ¯ä¸€ä¸ªæ–‡ä»¶éƒ½å°†æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„é¡µé¢ã€‚äº‹å®ä¸Šï¼ŒNext.js ä½¿ç”¨ <a href="https://zeit.co/blog/next#zero-setup.-use-the-filesystem-as-an-api" target="_blank" rel="external">filesystemä½œä¸ºAPI</a>ï¼Œæ‰€ä»¥æ¯ä¸ªæ”¾åˆ° pages æ–‡ä»¶å¤¹ä¸­çš„ç»„ä»¶å°†ä¼šè‡ªåŠ¨æ˜ å°„ä¸ºä¸€ä¸ªåŸºäºæœåŠ¡å™¨çš„è·¯ç”±ã€‚æ¯”å¦‚ï¼Œç£ç›˜ä¸Šçš„ pages/detail.js ç»„ä»¶å°†ä¼šè‡ªåŠ¨æœåŠ¡äº /about è¿™ä¸ª URLã€‚</p><p>è®©æˆ‘ä»¬æ¥æ–°å»ºä¸€ä¸ª team é¡µé¢å§ï¼æ–°å»º ./pages/details.js æ–‡ä»¶ï¼š</p><pre><code>// ./pages/details.jsimport React from &apos;react&apos;export default () =&gt; (  &lt;p&gt;Coming soon. . .!&lt;/p&gt;)</code></pre><p>æˆ‘ä»¬ä½¿ç”¨ Next å·²ç»å‡†å¤‡å¥½çš„ç»„ä»¶ <link> æ¥è¿›è¡Œé¡µé¢è·³è½¬ï¼š</p><pre><code>// ./pages/details.jsimport React from &apos;react&apos;// Import Link from nextimport Link from &apos;next/link&apos;export default () =&gt; (  &lt;div&gt;      &lt;p&gt;Coming soon. . .!&lt;/p&gt;      &lt;Link href=&quot;/&quot;&gt;&lt;a&gt;Go Home&lt;/a&gt;&lt;/Link&gt;  &lt;/div&gt;)</code></pre><p>è¿™ä¸ªé¡µé¢ä¸èƒ½æ€»æ˜¯ â€œComing soon. . .!â€ çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬æ¥è¿›è¡Œå®Œå–„ä»¥å±•ç¤ºæ›´å¤šå†…å®¹ï¼Œé€šè¿‡é¡µé¢ URL çš„ query id å˜é‡ï¼Œæˆ‘ä»¬æ¥è¯·æ±‚å¹¶å±•ç°å½“å‰ç›¸åº”é˜Ÿä¼çš„ä¿¡æ¯ï¼š</p><pre><code>import React from &apos;react&apos;import Head from &apos;next/head&apos;import Link from &apos;next/link&apos;import axios from &apos;axios&apos;;export default class extends React.Component {    static async getInitialProps ({query}) {        // Get id from query        const id = query.id;        if(!process.browser) {            // Still on the server so make a request            const res = await axios.get(&apos;http://api.football-data.org/v1/competitions/426/leagueTable&apos;)            return {                data: res.data,                // Filter and return data based on query                standing: res.data.standing.filter(s =&gt; s.position == id)            }        } else {            // Not on the server just navigating so use            // the cache            const bplData = JSON.parse(sessionStorage.getItem(&apos;bpl&apos;));            // Filter and return data based on query            return {standing: bplData.standing.filter(s =&gt; s.position == id)}        }    }    componentDidMount () {        // Cache data in localStorage if        // not already cached        if(!sessionStorage.getItem(&apos;bpl&apos;)) sessionStorage.setItem(&apos;bpl&apos;, JSON.stringify(this.props.data))    }    // . . . render method truncated }</code></pre><p>è¿™ä¸ªé¡µé¢æ ¹æ® query å˜é‡ï¼ŒåŠ¨æ€å±•ç°å‡ºçƒé˜Ÿä¿¡æ¯ã€‚å…·ä½“æ¥çœ‹ï¼ŒgetInitialProps æ–¹æ³•è·å– URL query idï¼Œæ ¹æ® id ç­›é€‰å‡ºï¼ˆfilter æ–¹æ³•ï¼‰å±•ç¤ºä¿¡æ¯ã€‚æœ‰æ„æ€çš„æ˜¯ï¼Œå› ä¸ºä¸€ç›´çƒé˜Ÿçš„ä¿¡æ¯æ¯”è¾ƒç¨³å®šï¼Œæ‰€ä»¥åœ¨å®¢æˆ·ç«¯ä½¿ç”¨äº† sessionStorage è¿›è¡Œå­˜å‚¨ã€‚</p><p>å®Œæ•´çš„ render æ–¹æ³•ï¼š</p><pre><code>// . . . truncatedexport default class extends React.Component {    // . . . truncated    render() {        const detailStyle = {            ul: {                marginTop: &apos;100px&apos;            }        }        return  (             &lt;div&gt;                &lt;Head&gt;                    &lt;title&gt;League Table&lt;/title&gt;                    &lt;meta name=&quot;viewport&quot; content=&quot;initial-scale=1.0, width=device-width&quot; /&gt;                    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://unpkg.com/purecss@0.6.1/build/pure-min.css&quot; /&gt;                &lt;/Head&gt;                &lt;div className=&quot;pure-g&quot;&gt;                    &lt;div className=&quot;pure-u-8-24&quot;&gt;&lt;/div&gt;                    &lt;div className=&quot;pure-u-4-24&quot;&gt;                        &lt;h2&gt;{this.props.standing[0].teamName}&lt;/h2&gt;                        &lt;img src={this.props.standing[0].crestURI} className=&quot;pure-img&quot;/&gt;                        &lt;h3&gt;Points: {this.props.standing[0].points}&lt;/h3&gt;                    &lt;/div&gt;                    &lt;div className=&quot;pure-u-12-24&quot;&gt;                        &lt;ul style={detailStyle.ul}&gt;                            &lt;li&gt;&lt;strong&gt;Goals&lt;/strong&gt;: {this.props.standing[0].goals}&lt;/li&gt;                            &lt;li&gt;&lt;strong&gt;Wins&lt;/strong&gt;: {this.props.standing[0].wins}&lt;/li&gt;                            &lt;li&gt;&lt;strong&gt;Losses&lt;/strong&gt;: {this.props.standing[0].losses}&lt;/li&gt;                            &lt;li&gt;&lt;strong&gt;Draws&lt;/strong&gt;: {this.props.standing[0].draws}&lt;/li&gt;                            &lt;li&gt;&lt;strong&gt;Goals Against&lt;/strong&gt;: {this.props.standing[0].goalsAgainst}&lt;/li&gt;                            &lt;li&gt;&lt;strong&gt;Goal Difference&lt;/strong&gt;: {this.props.standing[0].goalDifference}&lt;/li&gt;                            &lt;li&gt;&lt;strong&gt;Played&lt;/strong&gt;: {this.props.standing[0].playedGames}&lt;/li&gt;                        &lt;/ul&gt;                        &lt;Link href=&quot;/&quot;&gt;Home&lt;/Link&gt;                    &lt;/div&gt;                &lt;/div&gt;             &lt;/div&gt;            )    }}</code></pre><p>æ³¨æ„ä¸‹é¢æˆªå›¾ä¸­ï¼ŒåŒä¸€é¡µé¢ä¸åŒ query å€¼ï¼Œåˆ†åˆ«å±•ç¤ºäº†å† å†›ğŸ†åˆ‡å°”è¥¿å’Œæ›¼è”çš„ä¿¡æ¯ã€‚</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-463c88cdb1e175ed.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="åˆ‡å°”è¥¿"></p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-14352128450bb0fb.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æ›¼è”"></p><p>åˆ«å¿˜äº†æˆ‘ä»¬çš„ä¸»é¡µï¼ˆæ’è¡Œæ¦œé¡µé¢ï¼‰index.js ä¸­ï¼Œä¹Ÿè¦ä½¿ç”¨ç›¸åº”çš„ sessionStorage é€»è¾‘ã€‚åŒæ—¶ï¼Œåœ¨ render æ–¹æ³•é‡ŒåŠ å…¥ä¸€æ¡é“¾æ¥åˆ°è¯¦æƒ…é¡µçš„ <link>ï¼š</p><pre><code>&lt;td&gt;&lt;Link href={`/details?id=${standing.position}`}&gt;More...&lt;/Link&gt;&lt;/td&gt;</code></pre><h2 id="é”™è¯¯é¡µé¢"><a href="#é”™è¯¯é¡µé¢" class="headerlink" title="é”™è¯¯é¡µé¢"></a>é”™è¯¯é¡µé¢</h2><p>åœ¨ Next ä¸­ï¼Œæˆ‘ä»¬åŒæ ·å¯ä»¥é€šè¿‡  error.js æ–‡ä»¶å®šä¹‰é”™è¯¯é¡µé¢ã€‚åœ¨ ./pages ä¸‹æ–°å»º error.jsï¼š</p><pre><code>// ./pages/_error.jsimport React from &apos;react&apos;export default class Error extends React.Component {  static getInitialProps ({ res, xhr }) {    const statusCode = res ? res.statusCode : (xhr ? xhr.status : null)    return { statusCode }  }  render () {    return (      &lt;p&gt;{        this.props.statusCode        ? `An error ${this.props.statusCode} occurred on server`        : &apos;An error occurred on client&apos;      }&lt;/p&gt;    )  }}</code></pre><p>å½“ä¼ ç»Ÿæƒ…å†µä¸‹é¡µé¢404æ—¶ï¼Œå¾—åˆ°ï¼š</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-811c8bca1607cca0.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="404é¡µé¢"></p><p>åœ¨æˆ‘ä»¬è®¾ç½® _ error.js ä¹‹åï¼Œä¾¿æœ‰ï¼š</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-af29722f2a62216e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="è‡ªå®šä¹‰é”™è¯¯é¡µé¢"></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¿™ç¯‡æ–‡ç« å®ç°äº†ä¸€ä¸ªç®€æ˜“ demoï¼Œåªæ˜¯ä»‹ç»äº†<strong>æœ€åŸºæœ¬</strong>çš„ Next.JS æ­å»º React åŒæ„åº”ç”¨çš„åŸºæœ¬æ­¥éª¤ã€‚</p><p>æƒ³æƒ³ä½ æ˜¯å¦åŒçƒ¦äº† webpack æ¼äººçš„é…ç½®ï¼Ÿæ˜¯å¦å¯¹äº Babel å„ç§æ’ä»¶äº‘é‡Œé›¾é‡Œï¼Ÿ<br><strong>ä½¿ç”¨ Next.jsï¼Œç®€å•ã€æ¸…æ–°è€Œåˆè®¾è®¡è‰¯å¥½ã€‚è¿™ä¹Ÿæ˜¯å®ƒåœ¨æ¨å‡ºçŸ­çŸ­æ—¶é—´ä»¥æ¥ï¼Œä¾¿è¿…é€Ÿèµ°çº¢çš„åŸå› ä¹‹ä¸€ã€‚</strong></p><p>é™¤æ­¤ä¹‹å¤–ï¼ŒNext è¿˜æœ‰éå¸¸å¤šçš„åŠŸèƒ½ï¼Œéå¸¸å¤šçš„å…ˆè¿›ç†å¿µå¯ä»¥åº”ç”¨ã€‚</p><ul><li>æ¯”å¦‚ <link> æ­é… prefetchï¼Œé¢„å…ˆè¯·æ±‚èµ„æºï¼›</li><li>å†å¦‚åŠ¨æ€åŠ è½½ç»„ä»¶ï¼ˆNext.js æ”¯æŒ TC39 dynamic import proposalï¼‰ï¼Œä»è€Œå‡å°‘é¦–æ¬¡ bundle sizeï¼›</li><li>è™½ç„¶å®ƒæ›¿æˆ‘ä»¬å°è£…å¥½äº† Webpackã€Babel ç­‰å·¥å…·ï¼Œä½†æ˜¯æˆ‘ä»¬åˆèƒ½ customizingï¼Œæ ¹æ®éœ€è¦è‡ªå®šä¹‰ã€‚</li></ul><p>æœ€åï¼Œå¯¹äºè¿™äº›æœ¬æ–‡ç« æ²¡æœ‰æ¼”ç¤ºåˆ°çš„åŠŸèƒ½æ˜¯å¦æœ‰äº›æ‰‹ç—’ï¼Ÿæ„Ÿå…´è¶£çš„è¯»è€…å¯ä»¥å…³æ³¨æœ¬æ–‡ demo çš„<a href="https://github.com/HOUCe/server-side-react-football" target="_blank" rel="external">Githubé¡¹ç›®åœ°å€</a>ï¼Œè‡ªå·±æ‰‹åŠ¨å°è¯•èµ·æ¥å§ï½</p><p>æœ¬æ–‡æ„è¯‘äº†<a href="https://scotch.io/tutorials/react-universal-with-next-js-server-side-react" target="_blank" rel="external">Chris Nwambaçš„ï¼šReact Universal with Next.js: Server-side React ä¸€æ–‡ï¼Œ</a>å¹¶å¯¹åŸæ–‡è¿›è¡Œäº†å‡çº§ï¼Œå…¼å®¹äº†æœ€æ–°çš„ Next è®¾è®¡ã€‚</p><p>æˆ‘çš„å…¶ä»–å…³äº React æ–‡ç« ï¼š</p><ul><li><a href="http://www.jianshu.com/p/49029b49f2b4" target="_blank" rel="external">åšå‡ºUberç§»åŠ¨ç½‘é¡µç‰ˆè¿˜ä¸å¤Ÿ æè‡´æ€§èƒ½æ‰“é€ æ‰è§çœŸç« </a></li><li><a href="http://www.jianshu.com/p/7a56ac1de2a8" target="_blank" rel="external">è§£æTwitterå‰ç«¯æ¶æ„ å­¦ä¹ å¤æ‚åœºæ™¯æ•°æ®è®¾è®¡</a></li><li><a href="http://www.jianshu.com/p/83c86dd0802d" target="_blank" rel="external">React Conf 2017 å¹²è´§æ€»ç»“1: React + ES next = â™¥</a></li><li><a href="http://www.jianshu.com/p/cde3cf7e2760" target="_blank" rel="external">React+Reduxæ‰“é€ â€œNEWS EARLYâ€å•é¡µåº”ç”¨ ä¸€ä¸ªé¡¹ç›®ç†è§£æœ€å‰æ²¿æŠ€æœ¯æ ˆçœŸè°›</a></li><li><a href="http://www.jianshu.com/p/8e28be0e7ab1" target="_blank" rel="external">ä¸€ä¸ªreact+reduxå·¥ç¨‹å®ä¾‹</a></li></ul><p>Happy Coding!</p><p>PS:<br>ä½œè€…<a href="https://github.com/HOUCe" target="_blank" rel="external">Githubä»“åº“</a> å’Œ <a href="https://www.zhihu.com/people/lucas-hc/answers" target="_blank" rel="external">çŸ¥ä¹é—®ç­”é“¾æ¥</a><br>æ¬¢è¿å„ç§å½¢å¼äº¤æµã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;å‚åŠ æˆ–ç•™æ„äº†æœ€è¿‘ä¸¾è¡Œçš„&lt;a href=&quot;https://www.zhihu.com/question/62154473/answer/200045569&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;JSConf CN 2017&lt;/a&gt;çš„åŒå­¦ï¼Œæƒ³å¿…å¯¹ Ne
      
    
    </summary>
    
      <category term="js" scheme="https://exp-team.github.io/categories/js/"/>
    
    
      <category term="js" scheme="https://exp-team.github.io/tags/js/"/>
    
  </entry>
  
  <entry>
    <title>ä»è´ºè€å¾®åšå¼•å‡ºçš„â€œéå†å™¨ï¼ˆIteratorsï¼‰åŠ é€Ÿé‚£äº›å¥¥ç§˜â€</title>
    <link href="https://exp-team.github.io/blog/2017/11/04/js/iterator/"/>
    <id>https://exp-team.github.io/blog/2017/11/04/js/iterator/</id>
    <published>2017-11-03T16:00:00.000Z</published>
    <updated>2017-11-05T02:43:30.000Z</updated>
    
    <content type="html"><![CDATA[<p>æˆ‘å…³æ³¨çš„è´ºè€â€”è´ºå¸ˆä¿Šå‰è¾ˆ@johnhax æœ€è¿‘å‘è¡¨ä¸ªè¿™æ ·ä¸€æ¡å¾®åšï¼š</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-2178ac3c9b666439.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="åŸå¾®åš"></p><p>è™½ç„¶è¿™æ¡å¾®åšæ²¡æœ‰å¼•èµ·å¤§èŒƒå›´çš„å…³æ³¨å’Œè®¨è®ºï¼Œä½†æ˜¯ä½œä¸ºæ–°äººï¼Œæˆ‘é™·å…¥äº†æ€è€ƒã€‚<strong>ç©¶ç«Ÿ V8 å¼•æ“åšäº†å“ªäº›é­”æ³•ï¼Œè¾¾åˆ°äº†æå¤§é™åº¦çš„ä¼˜åŒ–å‘¢ï¼Ÿ</strong></p><p>è¿™ç¯‡æ–‡ç« ï¼Œå°†ä¼šæ·±å…¥æµ…å‡ºåˆ†æè¿™äº›ä¼˜åŒ–èƒŒåçš„å¥¥ç§˜ã€‚å¸Œæœ›å¤§ç¥ç»™äºˆæ–§æ­£å’Œå¼•å¯¼ï¼ŒåŒæ—¶å¯¹è¯»è€…æœ‰æ‰€å¯å‘å’Œå¸®åŠ©ã€‚</p><h2 id="æˆ‘ä»¬åˆ°åº•åœ¨è®¨è®ºä»€ä¹ˆï¼Ÿ"><a href="#æˆ‘ä»¬åˆ°åº•åœ¨è®¨è®ºä»€ä¹ˆï¼Ÿ" class="headerlink" title="æˆ‘ä»¬åˆ°åº•åœ¨è®¨è®ºä»€ä¹ˆï¼Ÿ"></a>æˆ‘ä»¬åˆ°åº•åœ¨è®¨è®ºä»€ä¹ˆï¼Ÿ</h2><p><a href="https://www.ecma-international.org/ecma-262/6.0/" target="_blank" rel="external">ECMAScript 2015 è¯­è¨€æ ‡å‡†è§„æ ¼</a>ä»‹ç»äº†å‡ ç§æ–°çš„æ•°æ®ç»“æ„ï¼šæ¯”å¦‚ Maps å’Œ Setsï¼ˆå½“ç„¶è¿˜æœ‰ç±»ä¼¼ WeakMaps å’Œ WeakSetsç­‰ï¼‰ï¼Œè€Œè¿™å‡ ä¸ªæ–°å¼•å…¥çš„æ•°æ®ç»“æ„æœ‰ä¸€ä¸ªå…±æ€§ï¼Œé‚£å°±æ˜¯éƒ½å¯ä»¥æ ¹æ®åŒæ ·æ–°å¼•å…¥çš„<strong>éå†åè®®ï¼ˆiteration protocolï¼‰è¿›è¡Œéå†</strong>ã€‚è¿™å°±æ„å‘³ç€ä½ å¯ä»¥ä½¿ç”¨ forâ€¦of å¾ªç¯æˆ–è€…æ‰©å±•è¿ç®—ç¬¦è¿›è¡Œæ“ä½œã€‚ä¸¾ä¸€ä¸ª Sets ç®€å•çš„ä¾‹å­ï¼š</p><pre><code>const s = new Set([1, 2, 3, 4]);console.log(...s);// 1 2 3 4for (const x of s) console.log(x);// 1// 2// 3// 4</code></pre><p>åŒæ ·å¯¹äº Mapsï¼š</p><pre><code>const m = new Map([[1, &quot;1&quot;], [2, &quot;2&quot;], [3, &quot;3&quot;], [4, &quot;4&quot;]]);console.log(...m);// (2) [1, &quot;1&quot;] (2) [2, &quot;2&quot;] (2) [3, &quot;3&quot;] (2) [4, &quot;4&quot;]console.log(...m.keys());// 1 2 3 4console.log(...m.values());//  1 2 3 4for (const [x, y] of m) console.log(x, &quot;is&quot;, y);// 1 &quot;is&quot; &quot;1&quot;// 2 &quot;is&quot; &quot;2&quot;// 3 &quot;is&quot; &quot;3&quot;// 4 &quot;is&quot; &quot;4&quot;</code></pre><p>é€šè¿‡è¿™ä¸¤ä¸ªç®€å•çš„ä¾‹å­ï¼Œå±•ç¤ºäº†æœ€åŸºæœ¬çš„ç”¨æ³•ã€‚æ„Ÿå…´è¶£çš„è¯»è€…å¯ä»¥å‚è€ƒ ECMA è§„èŒƒï¼š<a href="https://www.ecma-international.org/ecma-262/6.0/#sec-map-iterator-objects" target="_blank" rel="external"> Map Iterator Objects</a> å’Œ <a href="https://www.ecma-international.org/ecma-262/6.0/#sec-set-iterator-objects" target="_blank" rel="external">Set Iterator Objects</a>ã€‚</p><p>ç„¶è€Œä¸å¹¸çš„æ˜¯ï¼Œè¿™äº›å¯éå†çš„æ•°æ®ç»“æ„åœ¨ V8 å¼•æ“ä¸­å¹¶æ²¡æœ‰å¾ˆå¥½çš„è¿›è¡Œä¼˜åŒ–ã€‚æˆ–è€…è¯´ï¼Œå¯¹äºè¿™äº›å®ç°ç»†èŠ‚ä¼˜åŒ–ç¨‹åº¦å¾ˆå·®ã€‚åŒ…æ‹¬ ECMAScript æˆå‘˜ Brian Terlson ä¹Ÿæ›¾åœ¨ Twitter ä¸ŠæŠ±æ€¨ï¼ŒæŒ‡å‡ºä»–ä½¿ç”¨ Sets æ¥å®ç°ä¸€ä¸ªæ­£åˆ™å¼•æ“æ—¶é‡åˆ°äº†æ¼äººçš„æ€§èƒ½é—®é¢˜ã€‚</p><p>æ‰€ä»¥ï¼Œç°åœ¨æ˜¯æ—¶é—´æ¥å¯¹ä»–ä»¬è¿›è¡Œä¼˜åŒ–äº†ï¼ä½†åœ¨ç€æ‰‹ä¼˜åŒ–å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆå½»åº•è®¤æ¸…ä¸€ä¸ªé—®é¢˜ï¼š<strong>è¿™äº›æ•°æ®ç»“æ„å¤„ç†æ…¢çš„çœŸå®åŸå› ç©¶ç«Ÿæ˜¯ä»€ä¹ˆï¼Ÿæ€§èƒ½ç“¶é¢ˆåˆ°åº•åœ¨å“ªé‡Œï¼Ÿ</strong><br>ä¸ºäº†å¼„æ¸…è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å°±éœ€è¦ç†è§£<strong>åº•å±‚å®ç°ä¸Šï¼Œè¿­ä»£å™¨ç©¶ç«Ÿæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ</strong></p><h2 id="æ·±å…¥ä¸»é¢˜æ¢ç´¢ç©¶ç«Ÿ"><a href="#æ·±å…¥ä¸»é¢˜æ¢ç´¢ç©¶ç«Ÿ" class="headerlink" title="æ·±å…¥ä¸»é¢˜æ¢ç´¢ç©¶ç«Ÿ"></a>æ·±å…¥ä¸»é¢˜æ¢ç´¢ç©¶ç«Ÿ</h2><p>ä¸ºæ­¤ï¼Œæˆ‘ä»¬å…ˆä»ä¸€ä¸ªç®€å•çš„ forâ€¦of å¾ªç¯è¯´èµ·ã€‚</p><p>ES6 å€Ÿé‰´ C++ã€Javaã€C# å’Œ Python è¯­è¨€ï¼Œå¼•å…¥äº† forâ€¦of å¾ªç¯ï¼Œä½œä¸ºéå†æ‰€æœ‰æ•°æ®ç»“æ„çš„ç»Ÿä¸€æ–¹æ³•ã€‚</p><p>ä¸€ä¸ªæœ€ç®€å•çš„ä½¿ç”¨ï¼š</p><pre><code>function sum(iterable) {  let x = 0;  for (const y of iterable) x += y;  return x;}</code></pre><p>å°†è¿™æ®µä»£ç ä½¿ç”¨ Babel è¿›è¡Œç¼–è¯‘ï¼Œæˆ‘ä»¬å¾—åˆ°ï¼š</p><pre><code>function sum(iterable) {  var x = 0;  var _iteratorNormalCompletion = true;  var _didIteratorError = false;  var _iteratorError = undefined;  try {    for (var _iterator = iterable[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {      var y = _step.value;      x += y;    }  } catch (err) {    _didIteratorError = true;    _iteratorError = err;  } finally {    try {      if (!_iteratorNormalCompletion &amp;&amp; _iterator.return) {        _iterator.return();      }    } finally {      if (_didIteratorError) {        throw _iteratorError;      }    }  }  return x;}</code></pre><p>éœ€è¦å‘Šè¯‰å¤§å®¶çš„ä¸€ä¸ªäº‹å®æ˜¯ï¼šç›®å‰ç°ä»£ JavaScript å¼•æ“åœ¨æœ¬è´¨ä¸Šå’Œ Babel å¯¹ forâ€¦of çš„å»è¯­æ³•ç³–åŒ–å¤„ç†æ˜¯ç›¸åŒçš„ï¼Œä»…ä»…æ˜¯åœ¨å…·ä½“ä¸€äº›ç»†èŠ‚ä¸Šæœ‰å·®åˆ«ã€‚</p><p>è¿™ä¸ªäº‹å®å‡ºå¤„ï¼š</p><blockquote><p>All modern JavaScript engines essentially perform the same desugaring that Babel does here to implement for-of (details vary)</p></blockquote><p>ä¸Šæ–‡å¼•è‡ª V8 æ ¸å¿ƒæˆå‘˜ï¼Œè°·æ­Œå·¥ç¨‹å¸ˆ Benedikt Meurerã€‚</p><p>å¯æ˜¯ä¸Šé¢ç»è¿‡ Babel ç¼–è¯‘åçš„ä»£ç ä¸å¤ªå¥½é˜…è¯»ã€‚åˆ«æ€¥ï¼Œæˆ‘åˆ å»äº†çƒ¦äººçš„å¼‚å¸¸å¤„ç†ï¼Œåªä¿ç•™äº†æœ€æ ¸å¿ƒçš„é€»è¾‘ä¾›å¤§å®¶å‚è€ƒï¼Œä»¥ä¾¿ç ”ç©¶ï¼š</p><pre><code>function sum(iterable) {  var x = 0;  var iterator = iterable[Symbol.iterator]();  for (;;) {    var iterResult = iterator.next();    if (iterResult.done) break;    x += iterResult.value;  }  return x;}</code></pre><p>ç†è§£è¿™æ®µä»£ç éœ€è¦çš„é¢„å¤‡çŸ¥è¯†éœ€è¦æ¸…æ¥š forâ€¦of å’Œ  Symbol.iterator æ–¹æ³•å…³ç³»ï¼š</p><blockquote><p>ä¸€ä¸ªæ•°æ®ç»“æ„åªè¦éƒ¨ç½²äº† Symbol.iterator å±æ€§ï¼Œå°±è¢«è§†ä¸ºå…·æœ‰ iterator æ¥å£ï¼Œå°±å¯ä»¥ç”¨ forâ€¦of å¾ªç¯éå†å®ƒçš„æˆå‘˜ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œforâ€¦of å¾ªç¯å†…éƒ¨è°ƒç”¨çš„æ˜¯æ•°æ®ç»“æ„çš„ Symbol.iterator æ–¹æ³•ã€‚</p></blockquote><p>forâ€¦of å¾ªç¯å¯ä»¥ä½¿ç”¨çš„èŒƒå›´åŒ…æ‹¬æ•°ç»„ã€Set å’Œ Map ç»“æ„ã€æŸäº›ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼ˆæ¯”å¦‚ arguments å¯¹è±¡ã€DOM NodeList å¯¹è±¡ï¼‰ã€Generator å¯¹è±¡ï¼Œä»¥åŠå­—ç¬¦ä¸²ã€‚</p><p>æˆ‘ä»¬ä»”ç»†è§‚å¯Ÿä¸Šæ®µæ®µä»£ç ï¼Œä¾¿å¯ä»¥å‘ç°è¿­ä»£å™¨æ€§èƒ½ä¼˜åŒ–çš„å…³é”®æ˜¯ï¼š<strong>ä¿è¯åœ¨å¾ªç¯ä¸­å¤šæ¬¡é‡å¤è°ƒç”¨çš„ iterator.next() èƒ½å¾—åˆ°æœ€å¤§é™åº¦çš„ä¼˜åŒ–</strong>ï¼ŒåŒæ—¶ï¼Œæœ€ç†æƒ³çš„æƒ…å†µæ˜¯å®Œå…¨é¿å…å¯¹ iterResult çš„å†…å­˜åˆ†é…ã€‚èƒ½å¤Ÿè¾¾åˆ°è¿™ç§ç›®çš„çš„å‡ ä¸ªæ‰‹æ®µä¾¿æ˜¯ä½¿ç”¨ç±»ä¼¼  store-load propagationï¼Œ escape analysis å’Œ scalar replacement of aggregates å…ˆè¿›çš„ç¼–è¯‘å¤„ç†æŠ€æœ¯ã€‚</p><p>åŒæ—¶ï¼Œä¼˜åŒ–åçš„ç¼–è¯‘è¿˜éœ€è¦å®Œå…¨æ¶ˆé™¤è¿­ä»£å™¨æœ¬èº« â€”â€” iterable[Symbol.iterator] çš„è°ƒç”¨åˆ†é…ï¼Œè€Œç›´æ¥åœ¨è¿­ä»£å™¨ backing-store ä¸Šç›´æ¥æ“ä½œã€‚</p><p>äº‹å®ä¸Šï¼Œåœ¨æ•°ç»„å’Œå­—ç¬¦ä¸²è¿­ä»£å™¨çš„ä¼˜åŒ–è¿‡ç¨‹ä¸­ï¼Œå°±æ˜¯ä½¿ç”¨äº†è¿™æ ·çš„æŠ€æœ¯å’Œç†å¿µã€‚å…·ä½“çš„å®æ–½æ–‡æ¡£å¯ä»¥<a href="https://docs.google.com/document/d/13z1fvRVpe_oEroplXEEX0a3WK94fhXorHjcOMsDmR-8" target="_blank" rel="external">å‚è€ƒè¿™é‡Œã€‚</a></p><p><strong>é‚£ä¹ˆå…·ä½“åˆ° Set è¿­ä»£å™¨çš„æ€§èƒ½é—®é¢˜ï¼Œå…¶å®å…³é”®åŸå› åœ¨ä¸ï¼šå…¶å®ç°ä¸Šæ··åˆäº† JavaScript å’Œ C++ ç¯å¢ƒã€‚</strong>æ¯”å¦‚ï¼Œæˆ‘ä»¬çœ‹ %SetIteratorPrototype%.next() çš„å®ç°ï¼š</p><pre><code>function SetIteratorNextJS() {  if (!IS_SET_ITERATOR(this)) {    throw %make_type_error(kIncompatibleMethodReceiver,                        &apos;Set Iterator.prototype.next&apos;, this);  }  var value_array = [UNDEFINED, UNDEFINED];  var result = %_CreateIterResultObject(value_array, false);  switch (%SetIteratorNext(this, value_array)) {    case 0:      result.value = UNDEFINED;      result.done = true;      break;    case ITERATOR_KIND_VALUES:      result.value = value_array[0];      break;    case ITERATOR_KIND_ENTRIES:      value_array[1] = value_array[0];      break;  }  return result;}</code></pre><p> è¿™æ®µä»£ç å®é™…ä¸ŠæŒ‰éƒ¨å°±ç­åšäº†è¿™ä¹ˆå‡ ä»¶äº‹æƒ…ï¼š</p><ul><li>å®šä¹‰åˆ†é…äº† value_array æ•°ç»„ï¼Œåˆå§‹åŒ–æ—¶ä¸ºä¸¤é¡¹ undefinedï¼›</li><li>å®šä¹‰åˆ†é…äº† result å¯¹è±¡ï¼Œå…¶æ ¼å¼ä¸º {value: value_array, done: false}ï¼›</li><li>è°ƒç”¨ C++ %SetIteratorNext runtime å‡½æ•°ï¼Œå°†è¿­ä»£å™¨çš„ this å’Œ value_array ä½œä¸ºå‚æ•°ä¼ é€’ã€‚</li><li>æ ¹æ® C++ %SetIteratorNext runtime å‡½æ•°è¿”å›ç»“æœï¼Œå°† result æ­£ç¡®èµ‹å€¼</li></ul><p>è¿™å°±é€ æˆä»€ä¹ˆæ ·çš„åæœå‘¢ï¼Ÿéå†çš„æ¯ä¸€æ­¥æˆ‘ä»¬éƒ½åœ¨ä¸æ–­åœ°åˆ†é…ä¸¤ä¸ªå¯¹è±¡ï¼švalue_array å’Œ resultã€‚ä¸ç®¡æ˜¯ V8 çš„ TurboFan è¿˜æ˜¯ Crankshaft ï¼ˆV8çš„ä¼˜åŒ–ç¼–è¯‘å™¨ï¼‰ æˆ‘ä»¬éƒ½æ— æ³•æ¶ˆé™¤è¿™æ ·çš„æ“ä½œã€‚æ›´ç³Ÿç³•çš„æ˜¯ï¼Œæ¯ä¸€æ­¥éå†æˆ‘ä»¬éƒ½è¦åœ¨ JavaScript å’Œ C++ ä¹‹é—´è¿›è¡Œåˆ‡æ¢ã€‚ä¸‹é¢çš„å›¾ï¼Œç®€è¦è¡¨ç¤ºäº†ä¸€ä¸ªç®€å•çš„ SUM å‡½æ•°åœ¨åº•å±‚çš„è¿è¡Œæµç¨‹ï¼š</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-cda48b6ba23d106b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="set-iterator-next-js-20170714.png"></p><p>åœ¨ V8 æ‰§è¡Œæ—¶ï¼Œæ€»å¤„åœ¨ä¸¤ä¸ªçŠ¶æ€ï¼ˆäº‹å®ä¸Šæ›´å¤šï¼‰ï¼šæ‰§è¡Œ C++ ä»£ç å’Œæ‰§è¡Œ JavaScript å½“ä¸­ã€‚è¿™ä¸¤ä¸ªçŠ¶æ€ä¹‹é—´çš„è½¬æ¢å¼€é”€å·¨å¤§ã€‚ä» JavaScript åˆ° C++ï¼Œæ˜¯ä¾èµ–æ‰€è°“çš„ CEntryStub å®Œæˆï¼ŒCEntryStub ä¼šè§¦å‘ C++ å½“ä¸­æŒ‡å®šçš„ Runtime_Something å‡½æ•°ï¼ˆæœ¬ä¾‹ä¸­ä¸º Runtime_SetIteratorNextï¼‰ã€‚æ‰€ä»¥ï¼Œ<strong>æ˜¯å¦å¯ä»¥é¿å…è¿™ç§è½¬æ¢ï¼Œä»¥åŠé¿å… value_array å’Œ result å¯¹è±¡çš„åˆ†é…åˆå†³å®šäº†æ€§èƒ½çš„å…³é”®ã€‚</strong></p><p>æœ€æ–°çš„ %SetIteratorPrototype%.next() å®ç°æ­£æ˜¯åˆ‡ä¸­è¦å®³ï¼Œåšäº†è¿™ä¸ªâ€œå…³é”®â€çš„å¤„ç†ã€‚æˆ‘ä»¬æƒ³è¦æ‰§è¡Œçš„ä»£ç åœ¨è°ƒç”¨ä¹‹å‰å°±ä¼šå˜å¾— hot ï¼ˆçƒ­å¤„ç†ï¼‰ï¼ŒTurboFan è¿›è€Œæœ€ç»ˆå¾—ä»¥çƒ­å¤„ç†ä¼˜åŒ–ã€‚å€ŸåŠ©æ‰€è°“çš„ <a href="https://github.com/v8/v8/wiki/CodeStubAssembler-Builtins" target="_blank" rel="external">CodeStubAssembler</a>ï¼Œ<a href="https://chromium-review.googlesource.com/563626" target="_blank" rel="external">baseline implementationï¼Œ</a>ç°åœ¨å·²ç»å®Œå…¨åœ¨ JavaScript å±‚é¢å®ç°æ¥å…¥ã€‚è¿™æ ·æˆ‘ä»¬ä»…ä»…åªéœ€è¦è°ƒç”¨ C++ æ¥åšåƒåœ¾å›æ”¶ï¼ˆåœ¨å¯ç”¨å†…å­˜è€—å°½æ—¶ï¼‰ä»¥åŠå¼‚å¸¸å¤„ç†çš„å·¥ä½œã€‚</p><h2 id="åŸºäºå›è°ƒå‡½æ•°çš„éå†"><a href="#åŸºäºå›è°ƒå‡½æ•°çš„éå†" class="headerlink" title="åŸºäºå›è°ƒå‡½æ•°çš„éå†"></a>åŸºäºå›è°ƒå‡½æ•°çš„éå†</h2><p>åœ¨éå†åè®®ä¸­ï¼ŒJavaScript åŒæ ·æä¾›  Set.prototype.forEach å’Œ Map.prototype.forEach æ–¹æ³•ï¼Œæ¥æ¥æ”¶ä¸€ä¸ªå›è°ƒå‡½æ•°ã€‚è¿™äº›åŒæ ·ä¾èµ–äº C++ çš„å¤„ç†é€»è¾‘ï¼Œè¿™æ ·ä¸ä»…ä»…éœ€è¦æˆ‘ä»¬å°† JavaScript è½¬æ¢ä¸º C++ï¼Œè¿˜è¦å¤„ç†å›è°ƒå‡½æ•°è½¬æ¢ä¸º Javascriptï¼Œè¿™æ ·çš„å·¥ä½œæ¨¡å¼å¦‚ä¸‹å›¾ï¼š</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-a7c35b576fc03f3c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="set-iterator-foreach-20170714.png"></p><p>æ‰€ä»¥ï¼Œä¸Šé¢ä½¿ç”¨ <a href="https://github.com/v8/v8/wiki/CodeStubAssembler-Builtins" target="_blank" rel="external">CodeStubAssembler</a> çš„æ–¹å¼åªèƒ½å¤„ç†ç®€å•çš„éå›è°ƒå‡½æ•°åœºæ™¯ã€‚çœŸæ­£å®Œå…¨æ„ä¹‰ä¸Šçš„ä¼˜åŒ–ï¼ŒåŒ…æ‹¬ forEach æ–¹æ³•çš„ TurboFan åŒ–è¿˜éœ€è¦ä¸€äº›å¾…å¼€å‘çš„é­”æ³•ã€‚</p><h2 id="ä¼˜åŒ–æå‡-Benchmark"><a href="#ä¼˜åŒ–æå‡-Benchmark" class="headerlink" title="ä¼˜åŒ–æå‡ Benchmark"></a>ä¼˜åŒ–æå‡ Benchmark</h2><p>æˆ‘ä»¬ä½¿ç”¨ä¸‹é¢çš„ benchmark ä»£ç è¿›è¡Œä¼˜åŒ–ç¨‹åº¦çš„è¯„æµ‹ï¼š</p><pre><code>const s = new Set;const m = new Map;for (let i = 0; i &lt; 1e7; ++i) {  m.set(i, i);  s.add(i);}function SetForOf() {  for (const x of s) {}}function SetForOfEntries() {  for (const x of s.entries()) {}}function SetForEach() {  s.forEach(function(key, key, set) {});}function MapForOf() {  for (const x of m) {}}function MapForOfKeys() {  for (const x of m.keys()) {}}function MapForOfValues() {  for (const x of m.values()) {}}function MapForEach() {  m.forEach(function(val, key, map) {});}const TESTS = [    SetForOf,    SetForOfEntries,    SetForEach,    MapForOf,    MapForOfKeys,    MapForOfValues,    MapForEach];// Warmup.for (const test of TESTS) {  for (let i = 0; i &lt; 10; ++i) test();}// Actual tests.for (const test of TESTS) {  console.time(test.name);  test();  console.timeEnd(test.name);}</code></pre><p>åœ¨ Chrome60 å’Œ Chrome61 ç‰ˆæœ¬çš„å¯¹æ¯”ä¸­ï¼Œå¾—åˆ°ä¸‹é¢å›¾æ ‡ç»“è®ºï¼š</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-f59e194150f56b9f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="improvements-20170714.png"></p><p>å¯è§ï¼Œè™½ç„¶å¤§å¹…æå‡ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜æ˜¯å¾—åˆ°äº†ä¸€äº›ä¸å¤ªç†æƒ³çš„ç»“æœã€‚å°¤å…¶ä½“ç°åœ¨ SetForOfEntries å’Œ MapForOf ä¸Šã€‚ä½†æ˜¯è¿™å°†ä¼šåœ¨æ›´é•¿è¿œçš„è®¡åˆ’ä¸Šè¿›è¡Œå¤„ç†ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¿™ç¯‡æ–‡ç« åªæ˜¯åœ¨å¤§é¢ä¸Šä»‹ç»äº†éå†å™¨æ€§èƒ½æ‰€é¢ä¸´çš„ç“¶é¢ˆå’Œç°æœ‰çš„è§£å†³æ–¹æ¡ˆã€‚é€šè¿‡è´ºè€çš„å¾®åšï¼Œå¯¹ä¸€ä¸ªé—®é¢˜è¿›è¡Œæ¢ç©¶ï¼Œæœ€ç»ˆæ‰¾åˆ° V8 æ ¸å¿ƒæˆå‘˜ Benedikt Meurer  çš„ <a href="http://benediktmeurer.de/2017/07/14/faster-collection-iterators/" target="_blank" rel="external">Faster Collection Iterators</a>ä¸€æ–‡ï¼Œè¿›è¡Œå‚è€ƒå¹¶ç¿»è¯‘ã€‚æƒ³è¦å®Œå…¨é€å½»ç†è§£åŸæ–‡ç« ä¸­å†…å®¹ï¼Œè¿˜éœ€è¦æ‰å®çš„è®¡ç®—æœºåŸºç¡€ã€v8<br> å¼•æ“å·¥ä½œæ–¹å¼ä»¥åŠç¼–è¯‘åŸç†æ–¹é¢çš„çŸ¥è¯†å‚¨å¤‡ã€‚</p><p>å› æˆ‘æ‰ç–å­¦æµ…ï¼Œå…¥è¡Œä¹Ÿä¸åˆ°ä¸¤å¹´ï¼Œæ›´ä¸ç®—è®¡ç®—æœºç§‘ç­å‡ºèº«ï¼Œæ‹¾äººç‰™æ…§çš„åŒæ—¶éš¾å…ç†è§£æœ‰åå·®å’Œç–æ¼ã€‚æ›´å¤š V8 å¼•æ“æ–¹é¢çš„çŸ¥è¯†ï¼Œå»ºè®®å¤§å®¶æ›´å¤šå…³æ³¨@justjavacï¼Œç¼–è¯‘æ–¹é¢çš„çŸ¥è¯†å…³æ³¨ Vue ä½œè€…@å°¤é›¨æºª ä»¥åŠä»–åœ¨ JS Conf ä¸Šçš„æ¼”è®²å†…å®¹ï¼š <a href="http://2017.jsconf.cn/files/04-compile-time-optimizations-evan-you.pdf" target="_blank" rel="external">å‰ç«¯å·¥ç¨‹ä¸­çš„ç¼–è¯‘æ—¶ä¼˜åŒ–ã€‚</a>æ¯•ç«Ÿï¼Œæˆ‘ä»¬å…³æ³¨å‰ç«¯å¤§ Vã€ç½‘çº¢çš„æ ¹æœ¬å¹¶ä¸æ˜¯ä¸ºäº†çœ‹çƒ­é—¹ã€çœ‹æ’• bï¼Œè€Œæ˜¯å¸Œæœ›åœ¨å‰è¾ˆèº«ä¸Šå­¦ä¹ åˆ°æ›´å¤šçŸ¥è¯†ã€å¾—åˆ°æ›´å¤šå¯å‘ã€‚</p><p>æœ€åï¼Œéšç€ ECMAScript çš„é£é€Ÿå‘å±•ï¼Œè®©æ¯ä¸€åå‰ç«¯å¼€å‘è€…å¯èƒ½éƒ½ä¼šæ„Ÿè§‰åˆ°å¤„åœ¨ä¸æ–­åœ°å­¦ä¹ å½“ä¸­ï¼Œç”šè‡³æœ‰äº›ç–²äºå¥”å‘½ã€‚ä½†æ˜¯åœ¨å­¦ä¹ æ–°çš„ç‰¹æ€§å’Œè¯­æ³•ä¹‹å¤–ï¼Œç†è§£æ›´æ·±å±‚çš„å†…å®¹æ‰æ˜¯å­¦ä¹ è¿›é˜¶çš„å…³é”®ã€‚</p><blockquote><p>æˆ‘åŒæ ·ä¸çŸ¥é“ä»€ä¹ˆæ˜¯æµ·ï¼Œ</p><p>èµ¤è„šç«™åœ¨æ²™æ»©ä¸Šï¼Œ</p><p>æ€¥åˆ‡åœ°ç­‰å¾…ç€é»æ˜çš„åˆ°æ¥ã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;æˆ‘å…³æ³¨çš„è´ºè€â€”è´ºå¸ˆä¿Šå‰è¾ˆ@johnhax æœ€è¿‘å‘è¡¨ä¸ªè¿™æ ·ä¸€æ¡å¾®åšï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/4363003-2178ac3c9b666439.png?imageMogr2/
      
    
    </summary>
    
      <category term="js" scheme="https://exp-team.github.io/categories/js/"/>
    
    
      <category term="js" scheme="https://exp-team.github.io/tags/js/"/>
    
  </entry>
  
  <entry>
    <title>æ•™ä½ ç¼–å†™ Node.js ä¸­é—´ä»¶ï¼Œå®ç°æœåŠ¡ç«¯ç¼“å­˜ï¼ˆé™„demoæºç ï¼‰</title>
    <link href="https://exp-team.github.io/blog/2017/11/04/js/node-cache/"/>
    <id>https://exp-team.github.io/blog/2017/11/04/js/node-cache/</id>
    <published>2017-11-03T16:00:00.000Z</published>
    <updated>2017-11-05T02:45:00.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://upload-images.jianshu.io/upload_images/4363003-bd4c498721be23c5.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p><p>Express ä½œä¸º Node.js çš„æ¡†æ¶ï¼Œå¦‚ä»Šå‘å±•å¯è°“å¦‚æ—¥ä¸­å¤©ã€‚æˆ‘å¾ˆå–œæ¬¢å…¶çµæ´»ã€æ˜“æ‰©å±•çš„è®¾è®¡ç†å¿µã€‚å°¤å…¶æ˜¯è¯¥æ¡†æ¶çš„ä¸­é—´ä»¶æ¶æ„è®¾è®¡ï¼šä½¿å¾—åœ¨åº”ç”¨ä¸­åŠ å…¥æ–°ç‰¹æ€§æ›´åŠ æ ‡å‡†åŒ–ã€æˆæœ¬æœ€å°åŒ–ã€‚<strong>è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘ä¼šå°è¯•ç¼–å†™ä¸€ä¸ªéå¸¸ç®€å•ã€å°å·§çš„ä¸­é—´ä»¶ï¼Œå®ŒæˆæœåŠ¡ç«¯ç¼“å­˜åŠŸèƒ½ï¼Œè¿›è€Œä¼˜åŒ–æ€§èƒ½ã€‚</strong></p><h2 id="å…³äºä¸­é—´ä»¶"><a href="#å…³äºä¸­é—´ä»¶" class="headerlink" title="å…³äºä¸­é—´ä»¶"></a>å…³äºä¸­é—´ä»¶</h2><p>è¯´åˆ°ä¸­é—´ä»¶ï¼ŒExpress å®˜ç½‘å¯¹å®ƒçš„é˜è¿°æ˜¯è¿™æ ·çš„ï¼š</p><blockquote><p>â€œExpress æ˜¯ä¸€ä¸ªè‡ªèº«åŠŸèƒ½æç®€ï¼Œå®Œå…¨æ˜¯è·¯ç”±å’Œä¸­é—´ä»¶æ„æˆä¸€ä¸ªwebå¼€å‘æ¡†æ¶ï¼šä»æœ¬è´¨ä¸Šæ¥è¯´ï¼Œä¸€ä¸ª Express åº”ç”¨å°±æ˜¯åœ¨è°ƒç”¨å„ç§ä¸­é—´ä»¶ã€‚â€</p></blockquote><p>ä¹Ÿè®¸ä½ ä½¿ç”¨è¿‡å„ç§å„æ ·çš„ä¸­é—´ä»¶è¿›è¡Œå¼€å‘ï¼Œä½†æ˜¯å¯èƒ½å¹¶ä¸ç†è§£ä¸­é—´ä»¶åŸç†ï¼Œä¹Ÿæ²¡æœ‰æ·±å…¥è¿‡ Express æºç ï¼Œæ¢ç©¶å…¶å®ç°ã€‚è¿™é‡Œå¹¶ä¸æ‰“ç®—é•¿ç¯‡å¤§è®ºå¸®æ‚¨åˆ†æï¼Œä½†æ˜¯ä½¿ç”¨å±‚é¢ä¸Šå¤§è‡´å¯ä»¥å‚è€ƒä¸‹å›¾ï¼š</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-f8d70520775b89c4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ä¸­é—´ä»¶åŸç†"></p><p>å»ºè®®æœ‰å…´è¶£ã€æƒ³æ·±å…¥çš„è¯»è€…è‡ªå·±åˆ†æï¼Œæœ‰ä»»ä½•é—®é¢˜æ¬¢è¿ä¸æˆ‘è®¨è®ºã€‚å³ä¾¿æ‚¨ä¸æ‰“ç®—æ·±å…¥ï¼Œä¹Ÿä¸ä¼šå½±å“å¯¹ä¸‹æ–‡ä¸­é—´ä»¶ç¼–å†™çš„ç†è§£ã€‚</p><h2 id="å…³äºæœåŠ¡ç«¯ç¼“å­˜"><a href="#å…³äºæœåŠ¡ç«¯ç¼“å­˜" class="headerlink" title="å…³äºæœåŠ¡ç«¯ç¼“å­˜"></a>å…³äºæœåŠ¡ç«¯ç¼“å­˜</h2><p>ç¼“å­˜å·²ç»è¢«å¹¿æ³›åº”ç”¨ï¼Œæ¥æé«˜é¡µé¢æ€§èƒ½ã€‚ä¸€è¯´åˆ°ç¼“å­˜ï¼Œå¯èƒ½è¯»è€…è„‘æµ·é‡Œé©¬ä¸Šå†’å‡ºæ¥ï¼šâ€œå®¢æˆ·ç«¯ç¼“å­˜ï¼ŒCDN ç¼“å­˜ï¼ŒæœåŠ¡å™¨ç«¯ç¼“å­˜â€¦â€¦â€ã€‚å¦ä¸€ç»´åº¦ä¸Šï¼Œä¹Ÿä¼šæƒ³åˆ°ï¼šâ€œ200ï¼ˆfrom cacheï¼‰ï¼Œexpireï¼ŒeTagâ€¦â€¦â€ç­‰æ¦‚å¿µã€‚</p><p>å½“ç„¶ä½œä¸ºå‰ç«¯å¼€å‘è€…ï¼Œæˆ‘ä»¬ä¸€å®šè¦æ˜ç™½è¿™äº›ç¼“å­˜æ¦‚å¿µï¼Œè¿™äº›ç¼“å­˜ç†å¿µæ˜¯ç›¸å¯¹äºæŸä¸ªå…·ä½“ç”¨æˆ·è®¿é—®æ¥è¯´çš„ï¼Œæ€§èƒ½ä¼˜åŒ–ä½“ç°åœ¨å•ä¸ªç”¨æˆ·ä¸Šã€‚æ¯”å¦‚è¯´ï¼Œæˆ‘ç¬¬ä¸€æ¬¡æ‰“å¼€é¡µé¢ Aï¼Œè€—æ—¶è¶…é•¿ï¼Œä¸‹ä¸€æ¬¡æ‰“å¼€é¡µé¢ç”±äºç¼“å­˜çš„ä½œç”¨ï¼Œæ—¶é—´ç¼©çŸ­äº†ã€‚</p><p>ä½†æ˜¯åœ¨æœåŠ¡å™¨ç«¯ï¼Œè¿˜å­˜åœ¨å¦å¤–ä¸€ä¸ªç»´åº¦ï¼Œæ€è€ƒä¸€ä¸‹è¿™æ ·çš„åœºæ™¯ï¼š</p><p>æˆ‘ä»¬æœ‰ä¸€ä¸ª<strong>é™æ€</strong>é¡µé¢ Bï¼Œè¿™ä¸ªé¡µé¢æœåŠ¡ç«¯éœ€è¦ä»æ•°æ®åº“è·å–éƒ¨åˆ†æ•°æ® b1ï¼Œæ ¹æ® b1 åˆè¦è®¡ç®—å¾—åˆ°éƒ¨åˆ†æ•°æ® b2ï¼Œè¿˜å¾—åšå„ç§é«˜å¤æ‚åº¦æ“ä½œï¼Œæœ€ç»ˆæ‰èƒ½â€œä¸œæ‹¼è¥¿å‡‘â€å‡ºéœ€è¦è¿”å›çš„å®Œæ•´é¡µé¢ Bï¼Œæ•´ä¸ªè¿‡ç¨‹è€—æ—¶2sã€‚</p><p>é‚£ä¹ˆé¢ä¸´çš„ç¾éš¾å°±æ˜¯ï¼Œuser1 æ‰“å¼€é¡µé¢è€—æ—¶2sï¼Œuser2åŒæ ·æ‰“å¼€é¡µé¢è€—æ—¶2sâ€¦â€¦è€Œè¿™äº›é¡µé¢éƒ½æ˜¯é™æ€é¡µé¢ Bï¼Œå†…å®¹æ˜¯å®Œå…¨ä¸€æ ·çš„ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªç¾éš¾ï¼Œè¿™æ—¶å€™æˆ‘ä»¬ä¹Ÿéœ€è¦ç¼“å­˜ï¼Œè¿™ç§ç¼“å­˜å°±å«å…ˆåšæœåŠ¡ç«¯ç¼“å­˜ï¼ˆserver-side cacheï¼‰ã€‚</p><p><strong>æ€»ç»“ä¸€ä¸‹ï¼ŒæœåŠ¡ç«¯ç¼“å­˜çš„ç›®çš„å…¶å®å°±æ˜¯å¯¹äºåŒä¸€ä¸ªé¡µé¢è¯·æ±‚ï¼Œè€Œè¿”å›ï¼ˆç¼“å­˜çš„ï¼‰åŒæ ·çš„é¡µé¢å†…å®¹ã€‚è¿™ä¸ªè¿‡ç¨‹å®Œå…¨ç‹¬ç«‹äºä¸åŒçš„ç”¨æˆ·ã€‚</strong></p><p>ä¸Šé¢çš„è¯æœ‰äº›æ‹—å£ï¼Œå¯ä»¥å‚è€ƒè‹±æ–‡è¡¨è¾¾æ›´æ¸…æ™°ï¼š</p><blockquote><p>The goal of server side cache is responding to the same content for the same request independently of the clientâ€™s request. </p></blockquote><p>å› æ­¤ï¼Œä¸‹é¢å±•ç¤ºçš„ demo åœ¨ç¬¬ä¸€æ¬¡è¯·æ±‚åˆ°è¾¾æ—¶ï¼ŒæœåŠ¡ç«¯è€—è´¹5ç§’æ¥è¿”å› HTMLï¼›è€Œæ¥ä¸‹æ¥å†æ¬¡è¯·æ±‚è¯¥é¡µé¢ï¼Œå°†ä¼šå‘½ä¸­ç¼“å­˜ï¼Œä¸è¿‡æ˜¯å“ªä¸ªç”¨æˆ·è®¿é—®ï¼Œåªéœ€è¦å‡ æ¯«ç§’ä¾¿å¯å¾—åˆ°å®Œæ•´é¡µé¢ã€‚</p><h2 id="Show-me-the-code-amp-Demo"><a href="#Show-me-the-code-amp-Demo" class="headerlink" title="Show me the code &amp; Demo"></a>Show me the code &amp; Demo</h2><p>å…¶å®ä¸Šæ–‡æåˆ°çš„ç¼“å­˜æ¦‚å¿µéå¸¸ç®€å•ï¼Œç¨å¾®æœ‰äº›åç«¯ç»éªŒçš„åŒå­¦éƒ½èƒ½å¾ˆå¥½ç†è§£ã€‚ä½†æ˜¯è¿™ç¯‡æ–‡ç« é™¤å»ç§‘æ™®åŸºæœ¬æ¦‚å¿µå¤–ï¼Œæ›´é‡è¦çš„å°±æ˜¯ä»‹ç» Express  ä¸­é—´ä»¶æ€æƒ³ï¼Œå¹¶è‡ªå·±æ¥å®ç°ä¸€ä¸ªæœåŠ¡ç«¯ç¼“å­˜ä¸­é—´ä»¶ã€‚</p><p>è®©æˆ‘ä»¬å¼€å·¥å§ï¼<br>æœ€ç»ˆ Demo ä»£ç ï¼Œæ¬¢è¿è®¿é—®<a href="https://github.com/HOUCe/server-side-cache-with-express" target="_blank" rel="external">å®ƒçš„Githubåœ°å€</a>ã€‚</p><p>æˆ‘å°†ä¼šä½¿ç”¨ npm ä¸Š memory-cache è¿™ä¸ªåŒ…ï¼Œä»¥æ–¹ä¾¿è¿›è¡Œç¼“å­˜çš„è¯»å†™ã€‚æœ€ç»ˆçš„ä¸­é—´ä»¶ä»£ç å¾ˆç®€å•ï¼š</p><pre><code>&apos;use strict&apos;var mcache = require(&apos;memory-cache&apos;);var cache = (duration) =&gt; {  return (req, res, next) =&gt; {    let key = &apos;__express__&apos; + req.originalUrl || req.url    let cachedBody = mcache.get(key)    if (cachedBody) {      res.send(cachedBody)      return    } else {      res.sendResponse = res.send      res.send = (body) =&gt; {        mcache.put(key, body, duration * 1000);        res.sendResponse(body)      }      next()    }  }}</code></pre><p>ä¸ºäº†ç®€å•ï¼Œæˆ‘ä½¿ç”¨äº†è¯·æ±‚ URL ä½œä¸º cache çš„ keyï¼š</p><ul><li>å½“å®ƒï¼ˆcache keyï¼‰åŠå…¶å¯¹åº”çš„ value å€¼å­˜åœ¨æ—¶ï¼Œä¾¿ç›´æ¥è¿”å›å…¶ value å€¼ï¼›</li><li>å½“å®ƒï¼ˆcache keyï¼‰åŠå…¶å¯¹åº”çš„ value å€¼ä¸å­˜åœ¨æ—¶ï¼Œæˆ‘ä»¬å°†å¯¹ Express send æ–¹æ³•åšä¸€å±‚æ‹¦æˆªï¼šåœ¨æœ€ç»ˆè¿”å›å‰ï¼Œå­˜å…¥è¿™å¯¹ key-valueã€‚</li></ul><p>ç¼“å­˜çš„æœ‰æ•ˆæ—¶é—´æ˜¯10ç§’ã€‚</p><p>æœ€ç»ˆåœ¨åˆ¤æ–­ä¹‹å¤–ï¼Œ<strong>æˆ‘ä»¬çš„ä¸­é—´ä»¶æŠŠæ§åˆ¶æƒäº¤ç»™ä¸‹ä¸€ä¸ªä¸­é—´ä»¶ã€‚</strong></p><p>æœ€ç»ˆä½¿ç”¨å’Œæµ‹è¯•å¦‚ä¸‹ä»£ç ï¼š</p><pre><code>app.get(&apos;/&apos;, cache(10), (req, res) =&gt; {  setTimeout(() =&gt; {    res.render(&apos;index&apos;, { title: &apos;Hey&apos;, message: &apos;Hello there&apos;, date: new Date()})  }, 5000) //setTimeout was used to simulate a slow processing request})</code></pre><p>æˆ‘ä½¿ç”¨äº† setTimeout æ¥æ¨¡æ‹Ÿä¸€ä¸ªè¶…é•¿ï¼ˆ5sï¼‰çš„æ“ä½œã€‚</p><p>æ‰“å¼€æµè§ˆå™¨æ§åˆ¶é¢æ¿ï¼Œå‘ç°åœ¨10ç§’ç¼“å­˜åˆ°æœŸä»¥å†…ï¼š</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-c46f7fbd8238dc23.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="åŠ è½½ä¿¡æ¯"></p><p>è‡³äºä¸ºä»€ä¹ˆ cache ä¸­é—´ä»¶è¦é‚£æ ·å­å†™ã€next() ä¸ºä»€ä¹ˆæ˜¯ä¸­é—´ä»¶æŠŠæ§åˆ¶æƒä¼ é€’ï¼Œæˆ‘å¹¶ä¸æ‰“ç®—å±•å¼€å»è®²ã€‚æœ‰å…´è¶£çš„è¯»è€…å¯ä»¥çœ‹ä¸€ä¸‹ Express æºç ã€‚</p><h2 id="è¿˜æœ‰å‡ ä¸ªå°é—®é¢˜"><a href="#è¿˜æœ‰å‡ ä¸ªå°é—®é¢˜" class="headerlink" title="è¿˜æœ‰å‡ ä¸ªå°é—®é¢˜"></a>è¿˜æœ‰å‡ ä¸ªå°é—®é¢˜</h2><p>ä»”ç»†çœ‹æˆ‘ä»¬çš„é¡µé¢ï¼Œå†å»ä½“ä¼šä¸€ä¸‹å®ç°ä»£ç ã€‚ä¹Ÿè®¸ç»†å¿ƒçš„è¯»è€…èƒ½å‘ç°ä¸€ä¸ªé—®é¢˜ï¼šåˆšæ‰çš„å®ç°æˆ‘ä»¬<strong>ç¼“å­˜äº†æ•´ä¸ªé¡µé¢</strong>ï¼Œå¹¶å°† date: new Date() ä¼ å…¥äº† jade æ¨¡ç‰ˆ index.jade é‡Œã€‚é‚£ä¹ˆï¼Œåœ¨å‘½ä¸­ç¼“å­˜çš„æ¡ä»¶ä¸‹ï¼Œ10ç§’å†…ï¼Œé¡µé¢æ— æ³•åŠ¨æ€åˆ·æ–°æ¥åŒæ­¥ï¼Œç›´åˆ°10ç§’ç¼“å­˜åˆ°æœŸã€‚</p><p>åŒæ—¶ï¼Œæˆ‘ä»¬ä»€ä¹ˆæ—¶å€™å¯ä»¥ä½¿ç”¨ä¸Šè¿°ä¸­é—´ä»¶ï¼Œè¿›è¡ŒæœåŠ¡ç«¯ç¼“å­˜å‘¢ï¼Ÿå½“ç„¶æ˜¯é™æ€å†…å®¹æ‰å¯ä»¥ä½¿ç”¨ã€‚åŒæ—¶ï¼ŒPUT, DELETE å’Œ POST æ“ä½œéƒ½ä¸åº”è¯¥è¿›è¡Œç±»ä¼¼çš„ç¼“å­˜å¤„ç†ã€‚</p><p>åŒæ ·ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† npm æ¨¡å—ï¼šmemory-cacheï¼Œå®ƒå­˜åœ¨ä¼˜ç¼ºç‚¹å¦‚ä¸‹ï¼š</p><ul><li>è¯»å†™è¿…é€Ÿè€Œç®€å•ï¼Œä¸éœ€è¦å…¶ä»–ä¾èµ–ï¼›</li><li>å½“æœåŠ¡å™¨æˆ–è€…è¿™ä¸ªè¿›ç¨‹æŒ‚æ‰çš„æ—¶å€™ï¼Œç¼“å­˜ä¸­çš„å†…å®¹å°†ä¼šå…¨éƒ¨ä¸¢å¤±ã€‚</li><li>memcache æ˜¯å°†ç¼“å­˜å†…å®¹å­˜æ”¾åœ¨äº†è‡ªå·±è¿›ç¨‹çš„å†…å­˜ä¸­ï¼Œæ‰€ä»¥è¿™éƒ¨åˆ†å†…å®¹æ˜¯æ— æ³•åœ¨å¤šä¸ª Node.js è¿›ç¨‹ä¹‹é—´å…±äº«çš„ã€‚</li></ul><p>å¦‚æœè¿™äº›å¼Šç«¯ really matterï¼Œåœ¨å®é™…å¼€å‘ä¸­æˆ‘ä»¬å¯ä»¥é€‰æ‹©åˆ†å¸ƒå¼çš„ cache æœåŠ¡ï¼Œæ¯”å¦‚ Redisã€‚åŒæ ·ä½ å¯ä»¥åœ¨ npm ä¸Šæ‰¾åˆ°ï¼šexpress-redis-cache æ¨¡å—ä½¿ç”¨ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>åœ¨çœŸå®çš„å¼€å‘åœºæ™¯ä¸­ï¼ŒæœåŠ¡ç«¯ç¼“å­˜å·²ç»æˆä¸º common senseï¼Œä½†æ˜¯åœ¨ Node.js çš„ä¸–ç•Œé‡Œï¼Œä½“ä¼šå…¶ä¸­é—´ä»¶æ€æƒ³ï¼Œè‡ªå·±æ‰‹åŠ¨ç¼–å†™æœåŠ¡ï¼ŒåŒæ ·ä¹è¶£æ— ç©·ã€‚</p><p>ä¸å®è·µç›¸ç»“åˆï¼Œæˆ‘è®¤ä¸ºçœŸæ­£ç¼“å­˜æ•´ä¸ªé¡µé¢ï¼ˆå¦‚åŒ demo é‚£æ ·ï¼‰å¹¶ä¸æ˜¯ä¸€ä¸ªæ¨èçš„åšæ³•ï¼ˆå½“æ—¶å®é™…åœºæ™¯å®é™…åˆ†æï¼‰ï¼ŒåŒæ ·ä½¿ç”¨è¯·æ±‚ url ä½œä¸ºç¼“å­˜çš„ key ä¹Ÿæœ‰å¾…è€ƒè™‘ã€‚æ¯”å¦‚ï¼Œé¡µé¢ä¸­çš„ä¸€äº›é™æ€å†…å®¹å¯èƒ½ä¼šåœ¨å…¶ä»–é¡µé¢ä¸­é‡å¤ä½¿ç”¨åˆ°ï¼Œå¤ç”¨å°±æˆäº†é—®é¢˜ã€‚</p><p>çœŸå®åœºæ™¯ä¸‹ï¼Œ<strong>ä¸€åˆ‡è®¾è®¡å’Œé€»è¾‘éƒ½è¦ä¸ºè‡ªå·±ä¸šåŠ¡æƒ…å†µæ‰€è´Ÿè´£ã€‚è„±ç¦»éœ€æ±‚è°ˆå®ç°ï¼Œéƒ½æ˜¯è€æµæ°“ã€‚</strong>è¿™ä¸ª demo ç®€æ˜“è½»å·§ï¼Œæœ‰éœ€è¦çš„è¯»è€…å¯ä»¥è®¿é—®<a href="https://github.com/HOUCe/server-side-cache-with-express" target="_blank" rel="external">å®ƒçš„Githubåœ°å€</a>ï¼Œæ¬¢è¿ç©å‡ºå„ç§èŠ±æ ·ã€‚</p><p>Happy Coding!</p><p>PS:<br>ä½œè€…<a href="https://github.com/HOUCe" target="_blank" rel="external">Githubä»“åº“</a> å’Œ <a href="https://www.zhihu.com/people/lucas-hc/answers" target="_blank" rel="external">çŸ¥ä¹é—®ç­”é“¾æ¥</a><br>æ¬¢è¿å„ç§å½¢å¼äº¤æµã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/4363003-bd4c498721be23c5.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; 
      
    
    </summary>
    
      <category term="js" scheme="https://exp-team.github.io/categories/js/"/>
    
    
      <category term="js" scheme="https://exp-team.github.io/tags/js/"/>
    
  </entry>
  
  <entry>
    <title>ä» setState promise åŒ–çš„æ¢è®¨ ä½“ä¼š React å›¢é˜Ÿè®¾è®¡æ€æƒ³</title>
    <link href="https://exp-team.github.io/blog/2017/11/04/js/setState-promise/"/>
    <id>https://exp-team.github.io/blog/2017/11/04/js/setState-promise/</id>
    <published>2017-11-03T16:00:00.000Z</published>
    <updated>2017-11-05T02:42:46.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://upload-images.jianshu.io/upload_images/4363003-cf1dab2cd6997834.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Tomorrow Land 2017 - Martin Garrix"></p><h2 id="ä»-setState-é‚£ä¸ªä¼—æ‰€å‘¨çŸ¥çš„å°ç§˜å¯†è¯´èµ·â€¦"><a href="#ä»-setState-é‚£ä¸ªä¼—æ‰€å‘¨çŸ¥çš„å°ç§˜å¯†è¯´èµ·â€¦" class="headerlink" title="ä» setState é‚£ä¸ªä¼—æ‰€å‘¨çŸ¥çš„å°ç§˜å¯†è¯´èµ·â€¦"></a>ä» setState é‚£ä¸ªä¼—æ‰€å‘¨çŸ¥çš„å°ç§˜å¯†è¯´èµ·â€¦</h2><p>åœ¨ React ç»„ä»¶ä¸­ï¼Œè°ƒç”¨ this.setState() æ˜¯æœ€åŸºæœ¬çš„åœºæ™¯ã€‚è¿™ä¸ªæ–¹æ³•æè¿°äº† state çš„å˜åŒ–ã€è§¦å‘äº†ç»„ä»¶ re-renderingã€‚ä½†æ˜¯ï¼Œä¹Ÿè®¸çœ‹ä¼¼å¹³å¸¸çš„ this.setState() é‡Œé¢å´ä¹Ÿè®¸<strong>è•´å«äº†å¾ˆå¤šé²œä¸ºäººçŸ¥çš„è®¾è®¡å’Œè®¨è®ºã€‚</strong></p><p>ç›¸ä¿¡å¾ˆå¤šå¼€å‘è€…å·²ç»æ„è¯†åˆ°ï¼ŒsetState æ–¹æ³•â€œæˆ–è®¸â€æ˜¯<strong>å¼‚æ­¥çš„ã€‚</strong>ä¹Ÿè®¸ä½ è§‰å¾—ï¼Œçœ‹ä¸Šå»æ›´æ–° state æ˜¯å¦‚æ­¤è½»è€Œæ˜“ä¸¾çš„æ“ä½œï¼Œè¿™å¹¶æ²¡æœ‰ä»€ä¹ˆå¯å¼‚æ­¥å¤„ç†çš„ã€‚ä½†æ˜¯è¦æ„è¯†åˆ°ï¼Œå› ä¸º state çš„æ›´æ–°ä¼šè§¦å‘ re-renderingï¼Œè€Œ re-rendering ä»£ä»·æ˜‚è´µï¼ŒçŸ­æ—¶é—´å†…åå¤è¿›è¡Œæ¸²æŸ“åœ¨æ€§èƒ½ä¸Šè‚¯å®šæ˜¯ä¸å¯å–çš„ã€‚æ‰€ä»¥ï¼ŒReact é‡‡ç”¨ batching æ€æƒ³ï¼Œå®ƒä¼š batches ä¸€ç³»åˆ—è¿ç»­çš„ state æ›´æ–°ï¼Œè€Œåªè§¦å‘ä¸€æ¬¡ re-renderã€‚</p><p>å…³äºè¿™äº›å†…å®¹ï¼Œå¦‚æœä½ è¿˜ä¸æ¸…æ¥šï¼Œæ¨èå‚è€ƒ@ç¨‹å¢¨çš„ç³»åˆ—æ–‡ç« ï¼š<a href="https://zhuanlan.zhihu.com/p/25954470" target="_blank" rel="external">setStateï¼šè¿™ä¸ªAPIè®¾è®¡åˆ°åº•æ€ä¹ˆæ ·</a>ï¼›è‹±è¯­å¥½çš„è¯ï¼Œå¯ä»¥ç›´æ¥å…³æ³¨é•¿å‘é£˜é£˜çš„ <a href="https://medium.com/javascript-scene/setstate-gate-abc10a9b2d82" target="_blank" rel="external">Eric Elliott è‘—åçš„å¼•èµ·ç³»åˆ—å£æ°´æˆ˜çš„åæ§½æ–‡ï¼šsetState() Gate</a>ã€‚</p><p>æˆ–è€…ï¼Œç›´æ¥çœ‹ä¸‹é¢çš„ä¸€ä¸ªå°ä¾‹å­ã€‚<br>æ¯”å¦‚ï¼Œæœ€ç®€å•çš„ä¸€ä¸ªåœºæ™¯æ˜¯ï¼š</p><pre><code>function incrementMultiple() {  this.setState({count: this.state.count + 1});  this.setState({count: this.state.count + 1});  this.setState({count: this.state.count + 1});}</code></pre><p>ç›´è§‚ä¸Šæ¥çœ‹ï¼Œå½“ä¸Šé¢çš„ incrementMultiple å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œç»„ä»¶çŠ¶æ€çš„<br> count å€¼è¢«å¢åŠ äº†3æ¬¡ï¼Œæ¯æ¬¡å¢åŠ 1ï¼Œé‚£æœ€å count è¢«å¢åŠ äº†3ã€‚ä½†æ˜¯ï¼Œå®é™…ä¸Šçš„ç»“æœåªç»™ state å¢åŠ äº†1ã€‚ä¸ä¿¡ä½ è‡ªå·±è¯•è¯•ï½</p><h2 id="è®©-setState-è¿ç»­æ›´æ–°çš„å‡ ä¸ª-hack"><a href="#è®©-setState-è¿ç»­æ›´æ–°çš„å‡ ä¸ª-hack" class="headerlink" title="è®© setState è¿ç»­æ›´æ–°çš„å‡ ä¸ª hack"></a>è®© setState è¿ç»­æ›´æ–°çš„å‡ ä¸ª hack</h2><p>å¦‚æœæƒ³è®© count ä¸€æ¬¡æ€§åŠ 3ï¼Œ<strong>åº”è¯¥å¦‚ä½•ä¼˜é›…åœ°å¤„ç†æ½œåœ¨çš„å¼‚æ­¥æ“ä½œï¼Œè§„é¿ä¸Šè¿°é—®é¢˜å‘¢ï¼Ÿ</strong></p><p>ä»¥ä¸‹æä¾›å‡ ç§è§£å†³æ–¹æ¡ˆï¼š</p><ul><li><p><strong>æ–¹æ³•ä¸€ï¼š</strong>å¸¸è§çš„ä¸€ç§åšæ³•ä¾¿æ˜¯å°†ä¸€ä¸ªå›è°ƒå‡½æ•°ä¼ å…¥ setState æ–¹æ³•ä¸­ã€‚å³ setState è‘—åçš„å‡½æ•°å¼ç”¨æ³•ã€‚è¿™æ ·èƒ½ä¿è¯å³ä¾¿åœ¨æ›´æ–°è¢« batched æ—¶ï¼Œä¹Ÿèƒ½è®¿é—®åˆ°é¢„æœŸçš„ state æˆ– propsã€‚ï¼ˆåé¢ä¼šè§£é‡Šè¿™ä¹ˆåšçš„åŸç†ï¼‰</p></li><li><p><strong>æ–¹æ³•äºŒï¼š</strong>å¦å¤–ä¸€ä¸ªå¸¸è§çš„åšæ³•æ˜¯éœ€è¦åœ¨ setState æ›´æ–°ä¹‹åè¿›è¡Œçš„é€»è¾‘ï¼ˆæ¯”å¦‚ä¸Šè¿°çš„è¿ç»­ç¬¬äºŒæ¬¡ count + 1ï¼‰ï¼Œå°è£…åˆ°ä¸€ä¸ªå‡½æ•°ä¸­ï¼Œå¹¶ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ä¼ ç»™ setStateã€‚è¿™æ®µå‡½æ•°é€»è¾‘å°†ä¼šåœ¨æ›´æ–°åç”± React ä»£ç†æ‰§è¡Œã€‚å³ï¼š</p><blockquote><p>setState(updater, [callback])</p></blockquote></li><li><p><strong>æ–¹æ³•ä¸‰ï¼š</strong>æŠŠéœ€è¦åœ¨ setState æ›´æ–°ä¹‹åè¿›è¡Œçš„é€»è¾‘æ”¾åœ¨ä¸€ä¸ªåˆé€‚çš„ç”Ÿå‘½å‘¨æœŸ hook å‡½æ•°ä¸­ï¼Œæ¯”å¦‚ componentDidMount æˆ–è€… componentDidUpdate ä¹Ÿå½“ç„¶å¯ä»¥è§£å†³é—®é¢˜ã€‚ä¹Ÿå°±æ˜¯è¯´ count ç¬¬ä¸€æ¬¡ +1 ä¹‹åï¼Œå‡ºå‘ componentDidUpdate ç”Ÿå‘½å‘¨æœŸ hookï¼Œç¬¬äºŒæ¬¡ count +1 æ“ä½œç›´æ¥æ”¾åœ¨ componentDidUpdate å‡½æ•°é‡Œé¢å°±å¥½å•¦ã€‚</p></li></ul><h2 id="ä¸€ä¸ªå¼•èµ·å¹¿æ³›è®¨è®ºçš„-Issue"><a href="#ä¸€ä¸ªå¼•èµ·å¹¿æ³›è®¨è®ºçš„-Issue" class="headerlink" title="ä¸€ä¸ªå¼•èµ·å¹¿æ³›è®¨è®ºçš„ Issue"></a>ä¸€ä¸ªå¼•èµ·å¹¿æ³›è®¨è®ºçš„ Issue</h2><p>è¿™äº›å†…å®¹è²Œä¼¼å·²ç»ä¸å†æ–°é²œï¼Œå¾ˆå¤š React èµ„æ·±å¼€å‘è€…å…¶å®éƒ½æ˜¯äº†è§£çš„ï¼Œæˆ–èƒ½å¾ˆå¿«ç†è§£ã€‚</p><p><strong>å¯æ˜¯ï¼Œä½ æƒ³è¿‡è¿™ä¸ªé—®é¢˜å—ï¼š</strong><br><strong>ç°ä»£ javascript å¤„ç†å¼‚æ­¥æµç¨‹ï¼Œå¾ˆæµè¡Œçš„ä¸€ä¸ªåšæ³•æ˜¯ä½¿ç”¨ promisesï¼Œé‚£ä¹ˆæˆ‘ä»¬èƒ½å¦åº”ç”¨è¿™ä¸ªæ€è·¯è§£å†³å‘¢ï¼Ÿ</strong></p><p>è¯´å…·ä½“ä¸€äº›ï¼Œå°±æ˜¯è°ƒç”¨ setState æ–¹æ³•ä¹‹åï¼Œè¿”å›ä¸€ä¸ª promiseï¼ŒçŠ¶æ€æ›´æ–°å®Œæ¯•åæˆ‘ä»¬åœ¨è°ƒç”¨ promise.then è¿›è¡Œä¸‹ä¸€æ­¥å¤„ç†ã€‚</p><p><strong>ç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œä½†æ˜¯å´è¢«å®˜æ–¹å¦å†³äº†ã€‚</strong></p><p>æˆ‘æ˜¯å¦‚ä½•å¾—å‡ºâ€œç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œä½†æ˜¯æ˜¯ä¸è¢«å®˜æ–¹å»ºè®®çš„ã€‚â€è¿™ä¸ªç»“è®ºï¼Œå–œæ¬¢åˆ¨æ ¹é—®åº•çš„è¯»è€…è¯·ç»§ç»­å¾€ä¸‹é˜…è¯»ï¼Œç›¸ä¿¡ä½ ä¸€å®šä¼šæœ‰æ‰€å¯å‘ï¼Œä¹Ÿèƒ½æ›´å……åˆ†ç†è§£ React å›¢é˜Ÿçš„è®¾è®¡æ€æƒ³ã€‚</p><h2 id="ç¬¬-2642-Issue-è§£è¯»å’Œæ·±å…¥åˆ†æ"><a href="#ç¬¬-2642-Issue-è§£è¯»å’Œæ·±å…¥åˆ†æ" class="headerlink" title="ç¬¬ 2642 Issue è§£è¯»å’Œæ·±å…¥åˆ†æ"></a>ç¬¬ 2642 Issue è§£è¯»å’Œæ·±å…¥åˆ†æ</h2><p>æˆ‘æ˜¯ä¸€æ­¥ä¸€æ­¥åœ¨ Facebook å¼€æº React çš„å®˜æ–¹ <a href="https://github.com/facebook/react" target="_blank" rel="external">Githubä»“åº“</a>ä¸Šï¼Œæ‰¾åˆ°äº†çº¿ç´¢ã€‚</p><p>æ•´ä¸ªè¿‡ç¨‹è·Ÿä¸‹æ¥ï¼Œç›¸ä¿¡åœ¨å„è·¯å¤§ç¥çš„ comments ä¹‹é—´ï¼Œä½ ä¼šå¯¹ React çš„è®¾è®¡ç†å¿µä»¥åŠ javascript è§£å†³é—®é¢˜çš„æ€è·¯æœ‰ä¸€ä¸ªæ›´æ¸…æ™°çš„è®¤è¯†ã€‚</p><p>ä¸€åˆ‡çš„æ¢ç©¶å§‹äº React ç¬¬ <a href="https://github.com/facebook/react/issues/2642" target="_blank" rel="external">#2642 å· issue: Make setState return a promise</a>ï¼Œä¸Šé¢å…³äº count è¿ç»­ +3 å¤§å®¶å·²ç»æœ‰æ‰€äº†è§£ã€‚æ¥ä¸‹æ¥æˆ‘ä¸¾ä¸€ä¸ªçœŸæ­£åœ¨ç”Ÿäº§å¼€å‘ä¸­çš„ä¾‹å­ï¼Œæ–¹ä¾¿å¤§å®¶ç†è§£è®¨è®ºã€‚</p><p>æˆ‘ä»¬ç°åœ¨å¼€å‘ä¸€ä¸ªå¯ç¼–è¾‘çš„ tableï¼Œéœ€æ±‚æ˜¯ï¼šå½“ç”¨æˆ·æ•²ä¸‹â€œå›è½¦â€ï¼Œå…‰æ ‡å°†ä¼šè¿›å…¥ä¸‹ä¸€è¡Œï¼ˆè°ƒç”¨ setState è¿›è¡Œå…‰æ ‡ç§»åŠ¨ï¼‰ï¼›å¦‚æœç”¨æˆ·å½“å‰å·²ç»åœ¨æœ€åä¸€è¡Œï¼Œé‚£ä¹ˆæ•²ä¸‹å›è½¦æ—¶ï¼Œç¬¬ä¸€æ­¥å°†å…ˆåˆ›å»ºä¸€ä¸ªæ–°è¡Œï¼ˆè°ƒç”¨ setState åˆ›å»ºæ–°çš„æœ€åä¸€è¡Œï¼‰ï¼Œåœ¨æ–°è¡Œåˆ›å»ºä¹‹åï¼Œå†å»æ–°çš„æœ€åä¸€è¡Œè¿›è¡Œå…‰æ ‡èšç„¦ï¼ˆè°ƒç”¨ setState è¿›è¡Œå…‰æ ‡ç§»åŠ¨ï¼‰ã€‚</p><p>å¸¸è§ä¸”é”™è¯¯çš„å¤„ç†åœ¨äºï¼š</p><pre><code>this.setState({  selected: input  // åˆ›å»ºæ–°è¡Œ}.bind(this));this.props.didSelect(this.state.selected);</code></pre><p>å› ä¸ºç¬¬ä¸€ä¸ª this.setState æ˜¯å¼‚æ­¥è¿›è¡Œçš„è¯ï¼Œä¸‹ä¸€å¤„ didSelect æ–¹æ³•æ‰§è¡Œ this.setState æ—¶ï¼Œæ‰€å¤„ç†çš„å‚æ•° this.state.selected å¯èƒ½è¿˜ä¸æ˜¯é¢„æœŸçš„ä¸‹ä¸€è¡Œã€‚å¾ˆæ˜æ˜¾ï¼Œè¿™å°±æ˜¯ this.setState çš„å¼‚æ­¥æ€§å¸¦æ¥çš„é—®é¢˜ã€‚</p><p>ä¸ºäº†è§£å†³è¿™ä¸ªå®Œæˆè¿™æ ·çš„é€»è¾‘ï¼Œæƒ³åˆ°äº† setState ç¬¬äºŒä¸ªå‚æ•°è§£å†³æ–¹æ¡ˆï¼Œç”¨ä»£ç ç®€å•è¡¨è¿°å°±æ˜¯ï¼š</p><pre><code>this.setState({  selected: input  // åˆ›å»ºæ–°è¡Œ}, function() {    this.props.didSelect(this.state.selected);}).bind(this));</code></pre><p>è¿™ç§è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨åµŒå¥—çš„ setState æ–¹æ³•ã€‚ä½†è¿™æ— ç–‘æ½œåœ¨åœ°ä¼šå¸¦æ¥åµŒå¥—åœ°ç‹±çš„é—®é¢˜ã€‚</p><h2 id="Promise-åŒ–æ–¹æ¡ˆç™»åœº"><a href="#Promise-åŒ–æ–¹æ¡ˆç™»åœº" class="headerlink" title="Promise åŒ–æ–¹æ¡ˆç™»åœº"></a>Promise åŒ–æ–¹æ¡ˆç™»åœº</h2><p>è¿™ä¸€åˆ‡æ˜¯ä¸æ˜¯åƒæäº†ä¼ ç»Ÿ Javascript å¤„ç†å¼‚æ­¥è€å¥—è·¯ï¼Ÿè§£å†³å›è°ƒåœ°ç‹±ï¼Œä½ æ˜¯ä¸æ˜¯åº”æ¿€æ€§åœ°æƒ³åˆ°äº† promiseï¼Ÿ</p><p>å¦‚æœ setState æ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ª promisesï¼Œè‡ªç„¶ä¼šæ›´åŠ ä¼˜é›…ï¼š</p><blockquote><p>setState() currently accepts an optional second argument for callback and returns undefined.<br>This results in a callback hell for a very stateful component. Having it return a promise would make it much more managable.</p></blockquote><p>å¦‚æœç”¨ promise é£æ ¼è§£å†³é—®é¢˜çš„è¯ï¼Œæ— éå°±æ˜¯ï¼š</p><pre><code>this.setState({  selected: input}).then(function() {  this.props.didSelect(this.state.selected);}.bind(this));</code></pre><p>çœ‹ä¸Šå»æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä¸€ä¸ªå¾ˆæ—¶é«¦çš„è®¾è®¡ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬è¿›ä¸€æ­¥æƒ³ï¼š<strong>å¦‚æœæƒ³è®© React æ”¯æŒè¿™æ ·çš„ç‰¹æ€§ï¼Œé‡‡ç”¨æå‡º pull request çš„æ–¹å¼ï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•å»æ”¹æºä»£ç å‘¢ï¼Ÿ</strong></p><h2 id="æ¢ç´¢-React-æºç ï¼Œå®Œæˆ-setState-promise-åŒ–çš„æ”¹é€ "><a href="#æ¢ç´¢-React-æºç ï¼Œå®Œæˆ-setState-promise-åŒ–çš„æ”¹é€ " class="headerlink" title="æ¢ç´¢ React æºç ï¼Œå®Œæˆ setState promise åŒ–çš„æ”¹é€ "></a>æ¢ç´¢ React æºç ï¼Œå®Œæˆ setState promise åŒ–çš„æ”¹é€ </h2><p>é¦–å…ˆæ‰¾åˆ°æºç ä¸­å…³äº setState å®šä¹‰çš„åœ°æ–¹ï¼Œå®ƒåœ¨ react/src/isomorphic/modern/class/ReactBaseClasses.js è¿™ä¸ªç›®å½•ä¸‹ï¼š</p><pre><code>ReactComponent.prototype.setState = function(partialState, callback) {  invariant(    typeof partialState === &apos;object&apos; ||      typeof partialState === &apos;function&apos; ||      partialState == null,    &apos;setState(...): takes an object of state variables to update or a &apos; +      &apos;function which returns an object of state variables.&apos;,  );  this.updater.enqueueSetState(this, partialState, callback, &apos;setState&apos;);};</code></pre><p>æˆ‘ä»¬é¦–å…ˆçœ‹åˆ°ä¸€å¥æ³¨é‡Šï¼š</p><blockquote><p>You can provide an optional callback that will be executed when the call to setState is actually completed.</p></blockquote><p>è¿™æ˜¯é‡‡ç”¨ setState ç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥å¤„ç†å›è°ƒçš„åŸºç¡€ã€‚</p><p>å¦å¤–ï¼Œä»æ³¨é‡Šä¸­æˆ‘ä»¬è¿˜æ‰¾åˆ°ï¼š</p><blockquote><p>When a function is provided to setState, it will be called at some point in the future (not synchronously). It will be called with the up to date component arguments (state, props, context). </p></blockquote><p>è¿™æ˜¯ç»™ setState æ–¹æ³•ç›´æ¥ä¼ å…¥ä¸€ä¸ªå‡½æ•°çš„åŸºç¡€ã€‚</p><p> <strong>è¨€å½’æ­£ä¼ ï¼Œå¦‚ä½•æ”¹åŠ¨æºç ï¼Œä½¿å¾— setState promise åŒ–å‘¢ï¼Ÿ</strong><br> å…¶å®å¾ˆç®€å•ï¼Œæˆ‘ç›´æ¥ä¸Šä»£ç ï¼š</p><pre><code>ReactComponent.prototype.setState = function(partialState, callback) {  invariant(    typeof partialState === &apos;object&apos; ||      typeof partialState === &apos;function&apos; ||      partialState == null,     &apos;setState(...): takes an object of state variables to update or a &apos; +       &apos;function which returns an object of state variables.&apos;,   );+  let callbackPromise;+  if (!callback) {+    class Deferred {+      constructor() {+        this.promise = new Promise((resolve, reject) =&gt; {+          this.reject = reject;+          this.resolve = resolve;+        });+      }+    }+    callbackPromise = new Deferred();+    callback = () =&gt; {+      callbackPromise.resolve();+    };+  }   this.updater.enqueueSetState(this, partialState, callback, &apos;setState&apos;);++  if (callbackPromise) {+    return callbackPromise.promise;+  } }; </code></pre><p>æˆ‘ç”¨ â€œï¼‹â€ æ ‡æ³¨äº†å¯¹æºç æ‰€åšçš„æ›´æ”¹ã€‚å¦‚æœå¼€å‘è€…è°ƒç”¨ setState æ–¹æ³•æ—¶ï¼Œä¼ å…¥çš„æ˜¯ä¸€ä¸ª javascript å¯¹è±¡çš„è¯ï¼Œé‚£ä¹ˆä¼šè¿”å›ä¸€ä¸ª promiseï¼Œè¿™ä¸ª promise å°†ä¼šåœ¨ state æ›´æ–°å®Œæ¯•å resolveã€‚<br>å¦‚æœæ‚¨çœ‹ä¸æ‡‚çš„è¯ï¼Œå»ºè®®è¡¥å……ä¸€ä¸‹ç›¸å…³çš„åŸºç¡€çŸ¥è¯†ï¼Œæˆ–è€…ç•™è¨€ä¸æˆ‘è®¨è®ºã€‚</p><h2 id="è§£å†³æ–¹æ¡ˆæœ‰äº†ï¼Œå¯æ˜¯-React-å®˜æ–¹ä¼šæ¥å—è¿™ä¸ª-PR-å—ï¼Ÿ"><a href="#è§£å†³æ–¹æ¡ˆæœ‰äº†ï¼Œå¯æ˜¯-React-å®˜æ–¹ä¼šæ¥å—è¿™ä¸ª-PR-å—ï¼Ÿ" class="headerlink" title="è§£å†³æ–¹æ¡ˆæœ‰äº†ï¼Œå¯æ˜¯ React å®˜æ–¹ä¼šæ¥å—è¿™ä¸ª PR å—ï¼Ÿ"></a>è§£å†³æ–¹æ¡ˆæœ‰äº†ï¼Œå¯æ˜¯ React å®˜æ–¹ä¼šæ¥å—è¿™ä¸ª PR å—ï¼Ÿ</h2><p>å¾ˆé—æ†¾ï¼Œç­”æ¡ˆæ˜¯å¦å®šçš„ã€‚æˆ‘ä»¬æ¥ä» React è®¾è®¡æ€æƒ³ä¸Šï¼Œå’Œ React å®˜æ–¹å›¢é˜Ÿçš„å›åº”ä¸Šï¼Œäº†è§£ä¸€ä¸‹å¦å†³ç†ç”±ã€‚</p><p>sebmarkbageï¼ˆFacebook å·¥ç¨‹å¸ˆï¼ŒReact æ ¸å¿ƒå¼€å‘è€…ï¼‰è®¤ä¸ºï¼šè§£å†³å¼‚æ­¥å¸¦æ¥çš„å›°æ‰°æ–¹æ¡ˆå…¶å®å¾ˆå¤šã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨åˆé€‚çš„ç”Ÿå‘½å‘¨æœŸ hook å‡½æ•°ä¸­å®Œæˆç›¸å…³é€»è¾‘ã€‚åœ¨è¿™ä¸ªåœºæ™¯é‡Œï¼Œå°±æ˜¯åœ¨è¡Œç»„ä»¶çš„ componentDidMount é‡Œè°ƒç”¨ focusï¼Œè‡ªç„¶å°±å®Œæˆäº†è‡ªåŠ¨èšç„¦ã€‚</p><p>æ­¤å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªæ–¹æ³•ï¼šæ–°çš„ refs æ¥å£è®¾è®¡æ”¯æŒæ¥æ”¶ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå½“å…¶å­ç»„ä»¶æŒ‚è½½æ—¶ï¼Œè¿™ä¸ªå›è°ƒå‡½æ•°å°±ä¼šç›¸åº”è§¦å‘ã€‚</p><p><strong>æ‰€æœ‰ä¸Šè¿°æ¨¡å¼éƒ½å¯ä»¥å®Œå…¨å–ä»£ä¹‹å‰çš„é—®é¢˜æ–¹æ¡ˆï¼Œå³ä½¿ä¸èƒ½ä¹Ÿä¸æ„å‘³ç€è¦æ¥å— promises åŒ–è¿™ä¸ªPRã€‚</strong></p><p>ä¸ºæ­¤ï¼Œsebmarkbage è¯´äº†ä¸€æ®µå¾ˆæ‰å¿ƒçš„è¯ï¼š</p><blockquote><p>Honestly, the current batching strategy comes with a set of problems right now. Iâ€™m hesitant to expand on itâ€™s API before weâ€™re sure that weâ€™re going to keep the current model. I think of it as a temporary escape until we figure out something better.</p></blockquote><p>é—®é¢˜çš„æ ¹æºåœ¨äºç°æœ‰çš„ batching ç­–ç•¥ï¼Œå®è¯å®è¯´ï¼Œè¿™ä¸ªç­–ç•¥å¸¦æ¥äº†ä¸€ç³»åˆ—é—®é¢˜ã€‚ä¹Ÿè®¸è¿™ä¸ªåœ¨åæœŸåæœ‰è°ƒæ•´ï¼Œåœ¨ batching ç­–ç•¥æ˜¯å¦è°ƒæ•´ä¹‹å‰ï¼Œ<strong>ç›²ç›®çš„æ‰©å…… setState æ¥å£åªä¼šæ˜¯ä¸€ä¸ªçŸ­è§†çš„è¡Œä¸ºã€‚</strong></p><p>å¯¹æ­¤ï¼ŒRedux åŸä½œè€… Dan Abramov ä¹Ÿå‘è¡¨äº†è‡ªå·±çš„çœ‹æ³•ã€‚ä»–è®¤ä¸ºï¼Œä»¥ä»–çš„ç»éªŒæ¥çœ‹ï¼Œä»»ä½•éœ€è¦ä½¿ç”¨ setState ç¬¬äºŒä¸ªå‚æ•° callback çš„åœºæ™¯ï¼Œéƒ½å¯ä»¥ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸå‡½æ•°  componentDidUpdate (and/or componentDidMount) æ¥å¤å†™ã€‚</p><blockquote><p>In my experience, whenever Iâ€™m tempted to use setState callback, I can achieve the same by overriding componentDidUpdate (and/or componentDidMount).</p></blockquote><p>å¦å¤–ï¼Œåœ¨ä¸€äº›æç«¯åœºæ™¯ä¸‹ï¼Œå¦‚æœå¼€å‘è€…ç¡®å®éœ€è¦åŒæ­¥çš„å¤„ç†æ–¹å¼ï¼Œæ¯”å¦‚å¦‚æœæˆ‘æƒ³åœ¨æŸ DOM å…ƒç´ æŒ‚è½½åˆ°å±å¹•ä¹‹å‰åšä¸€äº›æ“ä½œï¼Œpromises è¿™ç§æ–¹æ¡ˆä¾¿ä¸å¯è¡Œã€‚å› ä¸º Promises æ€»æ˜¯å¼‚æ­¥çš„ã€‚åè¿‡æ¥ï¼Œå¦‚æœ setState æ”¯æŒè¿™ä¸¤ç§ä¸åŒçš„æ–¹å¼ï¼Œé‚£ä¹ˆä¼¼ä¹ä¹Ÿæ˜¯å®Œå…¨æ²¡æœ‰å¿…è¦è€Œå¤šä½™çš„ã€‚</p><p>åœ¨ç¤¾åŒºï¼Œç¡®å®å¾ˆå¤šç¬¬ä¸‰æ–¹åº“æ¸æ¸åœ°æ¥å—ä½¿ç”¨ promises é£æ ¼ï¼Œä½†æ˜¯è¿™äº›åº“è§£å†³çš„é—®é¢˜å¾€å¾€éƒ½æ˜¯å¼ºå¼‚æ­¥æ€§çš„ï¼Œæ¯”å¦‚æ–‡ä»¶è¯»å–ã€ç½‘ç»œæ“ä½œç­‰ç­‰ã€‚ React ä¼¼ä¹æ²¡æœ‰å¿…è¦å¢åŠ è¿™ä¹ˆä¸€ä¸ª confusing çš„ç‰¹æ€§ã€‚</p><p>å¦å¤–ï¼Œå¦‚æœæ¯ä¸ª setState éƒ½è¿”å›ä¸€ä¸ª promisesï¼Œä¹Ÿä¼šå¸¦æ¥æ€§èƒ½å½±å“ï¼šå¯¹äº React æ¥è¯´ï¼ŒsetState å°†å¿…ç„¶äº§ç”Ÿä¸€ä¸ª callbackï¼Œè¿™äº› callbacks éœ€è¦åˆç†å‚¨å­˜ï¼Œä»¥ä¾¿åœ¨åˆé€‚æ—¶é—´æ¥è§¦å‘ã€‚</p><p>æ€»ç»“ä¸€ä¸‹ï¼Œè§£å†³ setState å¼‚æ­¥å¸¦æ¥çš„é—®é¢˜ï¼Œæœ‰å¾ˆå¤šæ–¹å¼èƒ½å¤Ÿå®Œç¾ä¼˜é›…åœ°è§£å†³ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç›´æ¥è®© setState è¿”å› promise æ˜¯ç”»è›‡æ·»è¶³çš„ã€‚å¦å¤–ï¼Œè¿™æ ·ä¹Ÿä¼šå¼•èµ·æ€§èƒ½é—®é¢˜ç­‰ç­‰ã€‚</p><p>æˆ‘ä¸ªäººè®¤ä¸ºï¼Œè¿™æ ·çš„æ€è·¯å¾ˆå¥½ï¼Œä½†æ˜¯éš¾å…æœ‰äº› Overengineeringã€‚</p><h2 id="è¿™ä¸€æ¬¡ä¸ºè‡ªå·±ç–¯ç‹‚ï¼Œæˆ‘å’Œæˆ‘çš„å€”å¼º"><a href="#è¿™ä¸€æ¬¡ä¸ºè‡ªå·±ç–¯ç‹‚ï¼Œæˆ‘å’Œæˆ‘çš„å€”å¼º" class="headerlink" title="è¿™ä¸€æ¬¡ä¸ºè‡ªå·±ç–¯ç‹‚ï¼Œæˆ‘å’Œæˆ‘çš„å€”å¼º"></a>è¿™ä¸€æ¬¡ä¸ºè‡ªå·±ç–¯ç‹‚ï¼Œæˆ‘å’Œæˆ‘çš„å€”å¼º</h2><p>æ€ä¹ˆæ ·ï¼Œæ˜¯å¦è¯´æœä½ äº†å‘¢ï¼Ÿå¦‚æœæ²¡æœ‰ï¼Œåœ¨ä¸èƒ½æ›´æ”¹ React æºç æƒ…å†µä¸‹ï¼Œä½ å°±æ˜¯æƒ³ç”¨ promise åŒ–çš„ setStateï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿ</p><p>è¿™é‡Œæä¾›ä¸€ä¸ªâ€œåæ¨¡å¼â€çš„æ–¹æ¡ˆï¼šæˆ‘ä»¬ä¸æ”¹å˜æºç ï¼Œè‡ªå·±ä¹Ÿå¯ä»¥è¿›è¡Œæ”¹é€ ï¼ŒåŸç†ä¸Šå°±æ˜¯ç›´æ¥å¯¹ this.setState è¿›è¡Œæ‹¦æˆªï¼Œè¿›è€Œè¿›è¡Œ promise åŒ–ï¼Œå†å°è£…ä¸€ä¸ªæ–°çš„æ¥å£å‡ºæ¥ã€‚</p><pre><code>import Promise from &quot;bluebird&quot;;export default {  componentWillMount() {    this.setStateAsync = Promise.promisify(this.setState);  },};</code></pre><p>ä¹‹åï¼Œä¾¿å¯ä»¥å¼‚æ­¥åœ°ï¼š</p><pre><code>this.setStateAsync({  loading: true,}).then(this.loadSomething).then((result) =&gt; {  return this.setStateAsync({result, loading: false});});</code></pre><p>å½“ç„¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨åŸå£°çš„ promisesï¼š</p><pre><code>function setStatePromise(that, newState) {    return new Promise((resolve) =&gt; {        that.setState(newState, () =&gt; {            resolve();        });    });}</code></pre><p>ç”šè‡³â€¦æˆ‘ä»¬è¿˜å¯ä»¥è„‘æ´å¤§å¼€ä½¿ç”¨ async/awaitã€‚</p><p>æœ€åï¼Œæ‰€æœ‰è¿™ç§åšæ³•éå¸¸çš„ dirtyï¼Œæˆ‘æ˜¯ä¸å»ºè®®è¿™ä¹ˆä½¿ç”¨çš„ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å…¶å®ç ”ç©¶ä¸€ä¸‹ React Issueï¼Œæ·±å…¥æºç å­¦ä¹ ï¼Œæ”¶è·ç¡®å®å¾ˆå¤šã€‚æ€»ç»“ä¹Ÿæ²¡æœ‰æ›´å¤šæƒ³è¯´çš„äº†ï¼Œæ— è€»æ»´åšä¸ªå¹¿å‘Šå§ï¼š</p><p> <strong>æˆ‘çš„å…¶ä»–å…³äº React æ–‡ç« ï¼š</strong></p><ul><li><p><a href="https://zhuanlan.zhihu.com/p/28525821" target="_blank" rel="external">React Redux ä¸­é—´ä»¶æ€æƒ³é‡è§ Web Worker çš„çµæ„Ÿï¼ˆé™„demoï¼‰</a></p></li><li><p><a href="https://zhuanlan.zhihu.com/p/27825741" target="_blank" rel="external">é€šè¿‡å®ä¾‹ï¼Œå­¦ä¹ ç¼–å†™ React ç»„ä»¶çš„â€œæœ€ä½³å®è·µâ€</a></p></li><li><p><a href="https://zhuanlan.zhihu.com/p/27727292" target="_blank" rel="external">React ç»„ä»¶è®¾è®¡å’Œåˆ†è§£æ€è€ƒ</a></p></li><li><p><a href="">ä» React ç»‘å®š thisï¼Œçœ‹ JS è¯­è¨€å‘å±•å’Œæ¡†æ¶è®¾è®¡</a></p></li><li><p><a href="https://zhuanlan.zhihu.com/p/28004982" target="_blank" rel="external">React æœåŠ¡ç«¯æ¸²æŸ“å¦‚æ­¤è½»æ¾ ä»é›¶å¼€å§‹æ„å»ºå‰åç«¯åº”ç”¨</a></p></li><li><p><a href="http://www.jianshu.com/p/49029b49f2b4" target="_blank" rel="external">åšå‡ºUberç§»åŠ¨ç½‘é¡µç‰ˆè¿˜ä¸å¤Ÿ æè‡´æ€§èƒ½æ‰“é€ æ‰è§çœŸç« </a></p></li><li><p><a href="http://www.jianshu.com/p/7a56ac1de2a8" target="_blank" rel="external">è§£æTwitterå‰ç«¯æ¶æ„ å­¦ä¹ å¤æ‚åœºæ™¯æ•°æ®è®¾è®¡</a></p></li><li><p><a href="http://www.jianshu.com/p/83c86dd0802d" target="_blank" rel="external">React Conf 2017 å¹²è´§æ€»ç»“1: React + ES next = â™¥</a></p></li><li><p><a href="http://www.jianshu.com/p/cde3cf7e2760" target="_blank" rel="external">React+Reduxæ‰“é€ â€œNEWS EARLYâ€å•é¡µåº”ç”¨ ä¸€ä¸ªé¡¹ç›®ç†è§£æœ€å‰æ²¿æŠ€æœ¯æ ˆçœŸè°›</a></p></li><li><p><a href="http://www.jianshu.com/p/8e28be0e7ab1" target="_blank" rel="external">ä¸€ä¸ªreact+reduxå·¥ç¨‹å®ä¾‹</a></p></li></ul><p>Happy Coding!</p><p>PS:<br>ä½œè€…<a href="https://github.com/HOUCe" target="_blank" rel="external">Githubä»“åº“</a> å’Œ <a href="https://www.zhihu.com/people/lucas-hc/answers" target="_blank" rel="external">çŸ¥ä¹é—®ç­”é“¾æ¥</a><br>æ¬¢è¿å„ç§å½¢å¼äº¤æµã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/4363003-cf1dab2cd6997834.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; 
      
    
    </summary>
    
      <category term="js" scheme="https://exp-team.github.io/categories/js/"/>
    
    
      <category term="js" scheme="https://exp-team.github.io/tags/js/"/>
    
  </entry>
  
  <entry>
    <title>äººå·¥æ™ºèƒ½ç¦»å‰ç«¯å¹¶ä¸è¿œ ä¸€æ­¥æ­¥æ•™ä½ å¼€å‘ä¸€ä¸ªæœºå™¨å­¦ä¹ APPï¼ˆé™„æºç ï¼‰</title>
    <link href="https://exp-team.github.io/blog/2017/11/04/js/ai/"/>
    <id>https://exp-team.github.io/blog/2017/11/04/js/ai/</id>
    <published>2017-11-03T16:00:00.000Z</published>
    <updated>2017-11-05T02:46:30.000Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘HBOç”µè§†ç½‘æ¨å‡ºçš„ç¾å‰§ã€Šç¡…è°·Silicon Valleyã€‹å¸­å·å…¨çƒï¼Œé‡Œé¢æœ‰ä¸€ä¸ªæ¡¥æ®µä»‹ç»äº†è¶…çº§æœ‰è¶£çš„iOS appï¼ <a href="https://www.theverge.com/tldr/2017/5/14/15639784/hbo-silicon-valley-not-hotdog-app-download" target="_blank" rel="external">Not Hotdogã€‚</a>ä½ ç”šè‡³å¯ä»¥åœ¨APP Storeä¸Š<a href="https://itunes.apple.com/app/not-hotdog/id1212457521" target="_blank" rel="external">ä¸‹è½½</a>åˆ°å®ƒã€‚</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-b6c49a02a1b0d3ba.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æ˜¯ä¸æ˜¯çƒ­ç‹—ï¼Ÿ"></p><p>å—å¯å‘äºæ­¤ï¼Œæˆ‘æ‰“ç®—å¼€å‘ä¸€ä¸ªå®ç°åŒæ ·åŠŸèƒ½çš„â€œæœºå™¨äººâ€ï¼šç”¨æˆ·åªéœ€è¦ä¸Šä¼ ä»»ä½•ä¸€å¼ å›¾ç‰‡ï¼Œé©¬ä¸Šå°±å¯ä»¥å¾—åˆ°åé¦ˆï¼Œå‘Šè¯‰ä½ è¿™å¼ å›¾ç‰‡çš„å†…å®¹æ˜¯ä¸æ˜¯ä¸€ä¸ªçƒ­ç‹—ã€‚æœ€é‡è¦çš„æ˜¯ï¼Œæˆ‘çš„ä»£ç <strong>å…¨éƒ¨ä»¥JSå®ç°</strong>ï¼Œæ˜¯æ—¶å€™è®©å‰ç«¯å·¥ç¨‹å¸ˆä»¬åœ¨äººå·¥æ™ºèƒ½ï¼æœºå™¨å­¦ä¹ é¢†åŸŸå¤§å±•èº«æ‰‹äº†ã€‚</p><h2 id="å®ç°ç»†èŠ‚"><a href="#å®ç°ç»†èŠ‚" class="headerlink" title="å®ç°ç»†èŠ‚"></a>å®ç°ç»†èŠ‚</h2><p>è¿™ä¸ªAPPä»¥Twitterä¸ºå®¿ä¸»ï¼ŒåŸºäºTwitter Botæœºå™¨äººï¼šä»»ä½•Twitterç”¨æˆ·éƒ½å¯ä»¥å‘å¸ƒä¸€å¼ å›¾ç‰‡ï¼Œå¹¶ä¸”åœ¨ä¸Šä¼ æè¿°æ–‡å­—ä¸­åŠ å…¥â€œ@IsItAHotdogâ€ï¼Œå°±èƒ½ç«‹å³å¾—åˆ°å›å¤ã€‚å°±åƒå¤§é™†å¸¸ç”¨çš„å¾®åšåŠ å…¥â€ï¼ƒâ€æè¿°ç¬¦ä¸€æ ·ç®€å•ã€‚</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-12400866446d9728.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="çƒ­ç‹—æ¢æµ‹APP"></p><p>åƒä¸‡ä¸è¦è¢«è¡¨è±¡æ‰€å›°æ‰°ï¼Œæ›´ä¸è¦è¢«â€œäººå·¥æ™ºèƒ½ï¼æœºå™¨å­¦ä¹ â€çš„æ ‡ç­¾æ‰€è¿·æƒ‘ã€‚å…¶å®å®ç°æ–¹å¼å’ŒåŸç†éå¸¸ç®€å•ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘forked <a href="http://twitter.com/BryanEBraun" target="_blank" rel="external">@BryanEBraunâ€™s </a>çš„å¼€æºä½œå“<a href="https://github.com/bryanbraun/twitter-listbot" target="_blank" rel="external">Twitter bot</a>ï¼Œå®ƒåŸºäºNodeJSï¼ŒTwitter Botè¯‘ä¸ºæœºå™¨äººï¼šä¼šå®šæ—¶å‘æ¨ï¼Œæˆ–éšæœºå›å¤ã€‚</p><p>å®˜æ–¹ä»‹ç»å†…å®¹ä¹Ÿéå¸¸ç®€æ´æ˜äº†ï¼š</p><blockquote><p>This is a simple twitter bot, designed to retweet the contents of a twitter list.</p></blockquote><p>å€ŸåŠ©è¿™ä¸ªå·¥å…·ï¼Œæ¥ä¸‹æ¥æˆ‘çš„å·¥ä½œå°±æ˜¯å¯¹æåˆ°â€IsItAHotdogâ€çš„æ¨æ–‡ï¼ˆå³å«æœ‰IsItAHotdogæ ‡ç­¾ï¼‰ï¼Œä½œå‡ºå›åº”ã€‚</p><p>åœ¨å®‰è£… <a href="https://www.npmjs.com/package/tuiter" target="_blank" rel="external">tuiter</a> NPMåŒ…ä¹‹åï¼Œä»£ç ä¸­å¼•å…¥ä¾èµ–ï¼Œå¹¶åŠ å…¥ï¼š</p><pre><code> var tu = require(&apos;tuiter&apos;)(config.keys); function listen() {        tu.filter({                track: &apos;isitahotdog&apos;        }, function(stream) {                console.log(&quot;listening to stream&quot;);        stream.on(&apos;tweet&apos;, onTweet);    })}</code></pre><p>å½“ç„¶ï¼Œæˆ‘ä»¬åªå¯¹å«æœ‰å›¾ç‰‡çš„æ¨æ–‡è¿›è¡Œå¤„ç†ï¼š</p><pre><code>if(tweet.entities.hasOwnProperty(&apos;media&apos;) &amp;&amp; tweet.entities.media.length &gt; 0)</code></pre><p>æœ€åï¼Œæˆ‘ä»¬æŠŠç»“æœå†™è¿›æ¨æ–‡å›å¤ä¸­ï¼š</p><pre><code>tu.update({    status: &quot;@&quot; + tweet.user.screen_name + message,            in_reply_to_status_id: tweet.id_str    }, onReTweet);</code></pre><h2 id="è®­ç»ƒæ¨¡å‹"><a href="#è®­ç»ƒæ¨¡å‹" class="headerlink" title="è®­ç»ƒæ¨¡å‹"></a>è®­ç»ƒæ¨¡å‹</h2><p>ä»¥ä¸Šåªæ˜¯ä»‹ç»äº†åŠ«æŒæ¨æ–‡ï¼Œå‘å¸ƒå›å¤çš„å†…å®¹ã€‚é‚£ä¹ˆå›å¤çš„ç»“æœåº”è¯¥æ€ä¹ˆè·å¾—å‘¢ï¼Ÿæˆ‘ä»¬æ€ä¹ˆçŸ¥é“å›¾ç‰‡æ˜¯ä¸æ˜¯çƒ­ç‹—å‘¢ï¼Ÿè¿™å°±åˆ°äº†æœ€é‡è¦çš„ä¸€æ­¥ã€‚</p><p>ç†Ÿæ‚‰æ·±åº¦å­¦ä¹ çš„æœ‹å‹å¯èƒ½ä¼šäº†è§£ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å¯èƒ½éœ€è¦æ”¶é›†å›¾ç‰‡ï¼Œå¹¶ç”¨Kerasæ­å»ºCNNå¸¸ç”¨ç¥ç»ç½‘ç»œã€‚å…¶ä¸­Kerasæ˜¯ä¸€ä¸ªå…¼å®¹Theanoå’ŒTensorflowçš„ç¥ç»ç½‘ç»œé«˜çº§åŒ…, é«˜åº¦æ¨¡å—åŒ–ï¼Œç”¨ä»–æ¥ç»„å»ºä¸€ä¸ªç¥ç»ç½‘ç»œéå¸¸å¿«é€Ÿä¾¿æ·ã€‚</p><p>è¿™äº›å†…å®¹å¯èƒ½ä¸­æ–‡èµ„æ–™å¹¶ä¸å¤šï¼Œä»…æœ‰çš„ä¸€äº›å¦‚æœå¤§å®¶æ„Ÿå…´è¶£çš„è¯ï¼Œæˆ‘æ¨èï¼š</p><ul><li><a href="http://www.jianshu.com/p/9efae7a20493" target="_blank" rel="external">å¯¹æ¯”å­¦ä¹ ç”¨ Keras æ­å»º CNN RNN ç­‰å¸¸ç”¨ç¥ç»ç½‘ç»œ</a></li><li><a href="https://github.com/wepe/MachineLearning" target="_blank" rel="external">Basic Machine Learning and Deep Learning</a></li></ul><p><strong>ä½†æ˜¯è¿™äº›æ·±åº¦å­¦ä¹ çš„å†…å®¹ï¼Œå¯èƒ½å¾ˆå¤šå‰ç«¯å·¥ç¨‹å¸ˆå¹¶ä¸æ˜¯å¤ªäº†è§£ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¾—é‡æ–°ä¿®ç‚¼æ‰èƒ½ç©è½¬è¿™ä¸€åˆ‡å—ï¼Ÿ</strong></p><p>åˆ«æ€¥ï¼Œç°åœ¨å°±å¯ä»¥å¼€å§‹ï¼è¿™é‡Œæˆ‘ç»™å¤§å®¶å®‰åˆ©ä¸€ä¸‹<a href="https://aws.amazon.com/rekognition/" target="_blank" rel="external">AWS Rekognitionï¼Œ</a>æˆ‘ä»¬çš„APPä¹Ÿæ˜¯åŸºäºAWS Rekognitionæ¥å®Œæˆã€‚</p><blockquote><p>Amazon Rekognition æ˜¯ä¸€ç§è®©æ‚¨èƒ½å¤Ÿè½»æ¾ä¸ºåº”ç”¨ç¨‹åºæ·»åŠ å›¾åƒåˆ†æåŠŸèƒ½çš„æœåŠ¡ã€‚åˆ©ç”¨ Rekognitionï¼Œæ‚¨å¯ä»¥æ£€æµ‹å¯¹è±¡ã€åœºæ™¯å’Œé¢å­”ï¼Œå¯ä»¥æœç´¢å’Œæ¯”è¾ƒé¢å­”ï¼Œè¿˜å¯ä»¥è¯†åˆ«å›¾åƒä¸­çš„ä¸å½“å†…å®¹ã€‚å€ŸåŠ© Rekognition çš„ APIï¼Œæ‚¨å¯ä»¥å¿«é€Ÿä¸ºåº”ç”¨ç¨‹åºæ·»åŠ åŸºäºæ·±åº¦å­¦ä¹ çš„å¤æ‚è§†è§‰æœç´¢å’Œå›¾åƒåˆ†ç±»åŠŸèƒ½ã€‚</p></blockquote><p>æ¢å¥è¯è¯´ï¼Œâ€œä¸äº†è§£æœºå™¨å­¦ä¹ ï¼Œç®€å•çš„è°ƒç”¨å‡ ä¸ªAPIéƒ½åº”è¯¥ä¼šå§ã€‚â€</p><p>Amazon RekognitionåŸºäºåŒæ ·ç”±Amazonè®¡ç®—æœºè§†è§‰ç§‘å­¦å®¶å¼€å‘çš„æˆç†Ÿä¸”é«˜åº¦å¯æ‰©å±•çš„æ·±åº¦å­¦ä¹ æŠ€æœ¯ï¼Œæ¯å¤©èƒ½å¤Ÿåˆ†ææ•°åäº¿å¼  Prime Photos å›¾åƒã€‚</p><p>è¯´åˆ°è¿™é‡Œå¯èƒ½æœ‰äº›ç»•ï¼Œå…¶å®æ¥çœ‹ä¸‹ä»£ç ï¼Œéå¸¸çš„ç®€å•ï¼š</p><pre><code> var params = {     Image: {          Bytes: body     },     MaxLabels: 20,     MinConfidence: 70 }; rekognition.detectLabels(params, function(err, data) {    if (err) console.log(err, err.stack); // an error occurred    else {        console.log(data);           // successful response        var isItAHotdog = false;        for (var label_index in data.Labels) {            var label = data.Labels[label_index];            if(label[&apos;Name&apos;] == &quot;Hot Dog&quot;) {               if(label[&apos;Confidence&apos;] &gt; 85) {                    isItAHotdog = true;                    tweetBasedOnCategorization(tweet, true);                }            }        }        if(isItAHotdog == false) {            tweetBasedOnCategorization(tweet, false);        }    }});</code></pre><p>æˆ‘æŠŠæ¨æ–‡é™„å¸¦çš„å›¾ç‰‡ä¸‹è½½åˆ°è‡ªå·±çš„æœåŠ¡å™¨æœºå™¨ä¸Šï¼Œç„¶åé€šè¿‡AWS Node SDKä¼ é€’ç»™Rekognitionï¼Œå¹¶è®¾ç½®ç›¸åº”çš„å‚æ•°ï¼ŒåŒ…æ‹¬ç½®ä¿¡åŒºé—´ç­‰ã€‚<br>æœ€åï¼Œåœ¨å›è°ƒä¸­è·å¾—æœ€ç»ˆç»“æœã€‚</p><h2 id="æœ€ç»ˆç»“æœ"><a href="#æœ€ç»ˆç»“æœ" class="headerlink" title="æœ€ç»ˆç»“æœ"></a>æœ€ç»ˆç»“æœ</h2><p>è®©æˆ‘ä»¬æ¥çœ‹ä¸€ç»„æµ‹è¯•ç»“æœå§ï¼š</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-f236923571a6f99f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æµ‹è¯•"></p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-c388ddadb880d566.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æµ‹è¯•"></p><p>è¿™ä¸€åˆ‡çš„å¼€å‘è¿‡ç¨‹éƒ½æ˜¯éå¸¸çš„ç®€å•ï¼Œå¦‚æœä½ æƒ³çœ‹åˆ°æºç ï¼Œæˆ‘forkäº†ä¸€ä»½ï¼Œå¹¶åŠ å…¥äº†ä¸­æ–‡æ³¨è§£ã€‚è¯·ç‚¹å‡»<a href="https://github.com/HOUCe/hot-dog-bot" target="_blank" rel="external">è¿™é‡ŒæŸ¥çœ‹æºç ã€‚</a></p><p>æœ¬æ–‡ç¿»è¯‘è‡ª<a href="https://hackernoon.com/building-silicon-valleys-hot-dog-app-in-one-night-aab8969cef0b" target="_blank" rel="external">Building Silicon Valleyâ€™s Hot Dog App in One Night</a>ï¼Œå¯¹äºåŸæ–‡è¿›è¡Œäº†éƒ¨åˆ†æ‰©å±•ã€‚</p><p>Happy Coding!</p><p><strong>æœ€åï¼Œå¯è€»åœ°åšä¸€æ³¢å¹¿å‘Šï¼š</strong></p><p><strong>å—åˆ°gitChatçš„é‚€è¯·ï¼Œæˆ‘è¦å¼€åˆ†äº«äº†ã€‚</strong>å½¢å¼ç±»ä¼¼çŸ¥ä¹Liveï¼Œä½†æ˜¯è¿™ä¸ªå¹³å°æˆ‘æ„Ÿè§‰å°‘äº†æµ®èºè€Œæ›´åŠ ä¸“ä¸šã€‚<br>ä¸»é¢˜å†…å®¹ä¸ºï¼š<strong>é¢å¯¹å‰ç«¯å…­å¹´å†å²ä»£ç ï¼Œå¦‚ä½•æ¥å…¥å¹¶åº”ç”¨ES6è§£æ”¾å¼€å‘æ•ˆç‡</strong>ã€‚</p><p><strong>æˆ‘é‚€è¯·äº†èµ„æ·±å‰ç«¯ä¸“å®¶ï¼Œç¤¾åŒºç½‘çº¢<a href="https://zhuanlan.zhihu.com/p/26929765?group_id=847800456846639104" target="_blank" rel="external">@é¢œæµ·é•œ</a>åŒæˆ‘ä¸€èµ·ï¼Œè¯¦æƒ…ä»‹ç»ç‚¹å‡»<a href="https://zhuanlan.zhihu.com/p/26929765?group_id=847800456846639104" target="_blank" rel="external">è¿™é‡Œã€‚</a></strong></p><p>å¾®ä¿¡æ‰«æä¸‹æ–¹äºŒç»´ç ï¼Œå³å¯å‚åŠ ï¼š</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-5058b054ba03b9bc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æ‰«ææ­¤äºŒç»´ç "></p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-ecf3f61112d467b5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å†…å®¹ä»‹ç»"></p><p>PS: ä½œè€…<a href="https://github.com/HOUCe" target="_blank" rel="external">Githubä»“åº“</a>ï¼Œæ¬¢è¿é€šè¿‡ä»£ç å„ç§å½¢å¼äº¤æµã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;æœ€è¿‘HBOç”µè§†ç½‘æ¨å‡ºçš„ç¾å‰§ã€Šç¡…è°·Silicon Valleyã€‹å¸­å·å…¨çƒï¼Œé‡Œé¢æœ‰ä¸€ä¸ªæ¡¥æ®µä»‹ç»äº†è¶…çº§æœ‰è¶£çš„iOS appï¼ &lt;a href=&quot;https://www.theverge.com/tldr/2017/5/14/15639784/hbo-silicon-valley-
      
    
    </summary>
    
      <category term="js" scheme="https://exp-team.github.io/categories/js/"/>
    
    
      <category term="js" scheme="https://exp-team.github.io/tags/js/"/>
    
  </entry>
  
  <entry>
    <title>React Render Array æ€§èƒ½å¤§ä¹±æ–—</title>
    <link href="https://exp-team.github.io/blog/2017/11/04/js/render-array/"/>
    <id>https://exp-team.github.io/blog/2017/11/04/js/render-array/</id>
    <published>2017-11-03T16:00:00.000Z</published>
    <updated>2017-11-05T02:40:01.000Z</updated>
    
    <content type="html"><![CDATA[<p>ç°åœ¨å…³äº React æœ€æ–° v16 ç‰ˆæœ¬æ–°ç‰¹æ€§çš„å®£ä¼ ã€è®²è§£å·²ç»â€œé“ºå¤©ç›–åœ°â€äº†ã€‚ä½ æœ€å–œæ¬¢å“ªä¸€ä¸ª new featureï¼Ÿ<br>æˆªè‡³ç›®å‰ï¼Œç»„ä»¶æ„å»ºæ–¹å¼å·²ç»ç³ç…æ»¡ç›®ã€‚é‚£ä¹ˆï¼Œä½ è€ƒè™‘è¿‡ä»–ä»¬çš„æ€§èƒ½å¯¹æ¯”å—ï¼Ÿè¿™ç¯‡æ–‡ç« ï¼Œèšç„¦å…¶ä¸­ä¸€ä¸ªå°ç»†èŠ‚ï¼Œè¿›è¡Œå¯¹æ¯”ï¼Œæœ›è¯»è€…å‚è€ƒçš„åŒæ—¶ï¼ŒæœŸå¾…å¤§ç¥æ–§æ­£ã€‚</p><h2 id="ä»-React-PureComponent-è¯´èµ·"><a href="#ä»-React-PureComponent-è¯´èµ·" class="headerlink" title="ä» React.PureComponent è¯´èµ·"></a>ä» React.PureComponent è¯´èµ·</h2><p>å…ˆä¸Šç»“è®ºï¼šåœ¨æˆ‘ä»¬çš„æµ‹è¯•å½“ä¸­ï¼Œä½¿ç”¨ React.PureComponent èƒ½å¤Ÿæå‡ 30% JavaScript æ‰§è¡Œæ•ˆç‡ã€‚æµ‹è¯•åœºæ™¯æ˜¯åå¤æ“ä½œæ•°ç»„ï¼Œè¿™ä¸ªâ€œåå¤æ“ä½œâ€æœ‰æ‰€è®²ç©¶ï¼Œæˆ‘ä»¬è®¡åˆ’æŒç»­ä¸æ–­åœ°æ”¹å˜æ•°ç»„çš„æŸä¸€é¡¹ï¼ˆè€Œä¸æ˜¯æ•´ä¸ªæ•°ç»„çš„å¤§èŒƒå›´å˜åŠ¨ï¼‰ã€‚</p><p>çº¿ä¸Šå‚è€ƒåœ°å€ï¼š <a href="https://react-array-perf.now.sh/" target="_blank" rel="external">è¯·ç‚¹å‡»è¿™é‡Œ</a></p><p>é‚£ä¹ˆè¿™æ ·çš„åœºæ™¯ï¼Œä½œä¸ºå¼€å‘è€…æœ‰å¿…è¦ç ”ç©¶å—ï¼Ÿå¦‚æœä½ çš„åº”ç”¨å¹¶ä¸æ¶‰åŠåˆ°é«˜é¢‘ç‡çš„æ›´æ–°æ•°ç»„æŸå‡ é¡¹ï¼Œé‚£ä¹ˆå¤§å¯ä¸å¿…åœ¨æ„è¿™äº›æ€§èƒ½çš„å¾®å¦™å·®åˆ«ã€‚ä½†æ˜¯å¦‚æœå­˜åœ¨ä¸€äº›â€œå®æ—¶æ›´æ–°â€çš„åœºæ™¯ï¼Œæ¯”å¦‚ï¼š</p><ul><li>ç”¨æˆ·è¾“å…¥æ”¹å˜æ•°ç»„ï¼ˆç‚¹èµè€…æ˜¾ç¤ºï¼‰ï¼›</li><li>è½®è¯¢ï¼ˆè‚¡ç¥¨å®æ—¶ï¼‰ï¼›</li><li>æ¨æ›´æ–°ï¼ˆæ¯”èµ›æ¯”åˆ†å®æ—¶æ’­æŠ¥ï¼‰ï¼›</li></ul><p>é‚£ä¹ˆå°±éœ€è¦è¿›è¡Œè€ƒè™‘ã€‚æˆ‘ä»¬å®šä¹‰ï¼šchangedItems.length / array.length æ¯”ä¾‹è¶Šå°ï¼Œæœ¬æ–‡æ‰€æ¶‰åŠçš„æ€§èƒ½ä¼˜åŒ–è¶Šåº”è¯¥å®æ–½ï¼Œå³è¶Šæœ‰å¿…è¦ä½¿ç”¨ React.PureComponentã€‚</p><h2 id="ä»£ç å’Œæ€§èƒ½æµ‹è¯•"><a href="#ä»£ç å’Œæ€§èƒ½æµ‹è¯•" class="headerlink" title="ä»£ç å’Œæ€§èƒ½æµ‹è¯•"></a>ä»£ç å’Œæ€§èƒ½æµ‹è¯•</h2><p>åœ¨ä½¿ç”¨ React å¼€å‘æ—¶ï¼Œç›¸ä¿¡å¾ˆå¤šå¼€å‘è€…åœ¨æ­é…å‡½æ•°å¼çš„çŠ¶æ€ç®¡ç†æ¡†æ¶ Redux ä½¿ç”¨ã€‚Redux reducers ä½œä¸ºçº¯å‡½æ•°çš„åŒæ—¶ï¼Œä¹Ÿè¦ä¿è¯ state çš„ä¸å¯å˜æ€§ï¼Œåœ¨æˆ‘ä»¬çš„åœºæ™¯ä¸­ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨ç›¸å…³ action è¢«è§¦å‘æ—¶ï¼Œéœ€è¦è¿”å›ä¸€ä¸ªæ–°çš„æ•°ç»„ã€‚</p><pre><code>const users = (state, action) =&gt; {  if (action.type === &apos;CHANGE_USER_1&apos;) {    return [action.payload, ...state.slice(1)]  }  return state}</code></pre><p>å¦‚ä¸Šä»£ç ï¼Œå½“ CHANGE_USER_1 æ—¶ï¼Œæˆ‘ä»¬å¯¹æ•°ç»„çš„ç¬¬ä¸€é¡¹è¿›è¡Œæ›´æ–°ï¼Œä½¿ç”¨ slice æ–¹æ³•ï¼Œä¸æ”¹å˜åŸæ•°ç»„çš„åŒæ—¶è¿”å›æ–°çš„æ•°ç»„ã€‚</p><p>æˆ‘ä»¬è®¾æƒ³æ‰€æœ‰çš„ users æ•°ç»„è¢« Users å‡½æ•°å¼ç»„ä»¶æ¸²æŸ“ï¼š</p><pre><code>import User from &apos;./User&apos;const Users = ({users}) =&gt;  &lt;div&gt;    {      users.map(user =&gt; &lt;User {...user} /&gt;    }  &lt;/div&gt;</code></pre><p>é—®é¢˜çš„å…³é”®åœ¨äºï¼šusers æ•°ç»„ä½œä¸º props å‡ºç°ï¼Œå½“æ•°ç»„ä¸­çš„<strong>ç¬¬ K é¡¹</strong>æ”¹å˜æ—¶ï¼Œæ‰€æœ‰çš„ <user> ç»„ä»¶éƒ½ä¼šè¿›è¡Œ reconciliation çš„è¿‡ç¨‹ï¼Œå³ä½¿<strong>é K é¡¹</strong>å¹¶æ²¡æœ‰å‘ç”Ÿå˜åŒ–ã€‚</user></p><p>è¿™æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥å¼•å…¥ React.PureComponentï¼Œå®ƒé€šè¿‡æµ…å¯¹æ¯”è§„é¿äº†ä¸å¿…è¦çš„æ›´æ–°è¿‡ç¨‹ã€‚å³ä½¿æµ…å¯¹æ¯”è‡ªèº«ä¹Ÿæœ‰è®¡ç®—æˆæœ¬ï¼Œä½†æ˜¯ä¸€èˆ¬æƒ…å†µä¸‹è¿™éƒ½ä¸å€¼ä¸€æã€‚</p><p>ä»¥ä¸Šå†…å®¹å…¶å®å·²ç»â€œè€ç”Ÿå¸¸è°ˆâ€äº†ï¼Œä¸‹é¢ç›´æ¥è¿›å…¥ä»£ç å’Œæ€§èƒ½æµ‹è¯•ç¯èŠ‚ã€‚</p><p>æˆ‘ä»¬æ¸²æŸ“äº†ä¸€ä¸ªæœ‰ 200 é¡¹çš„æ•°ç»„ï¼š</p><pre><code>const arraySize = 200;const getUsers = () =&gt;  Array(arraySize)    .fill(1)    .map((_, index) =&gt; ({      name: &apos;John Doe&apos;,      hobby: &apos;Painting&apos;,      age: index === 0 ? Math.random() * 100 : 50    }));</code></pre><p>æ³¨æ„åœ¨ getUsers æ–¹æ³•ä¸­ï¼Œå…³äº age å±æ€§æˆ‘ä»¬åšäº†åˆ¤æ–­ï¼Œä¿è¯æ¯æ¬¡è°ƒç”¨æ—¶ï¼ŒgetUsers è¿”å›çš„æ•°ç»„åªæœ‰ç¬¬ä¸€é¡¹çš„ age å±æ€§ä¸åŒã€‚<br>è¿™ä¸ªæ•°ç»„å°†ä¼šè§¦å‘ 400 æ¬¡ re-renders è¿‡ç¨‹ï¼Œå¹¶ä¸”æ¯ä¸€æ¬¡åªæ”¹å˜æ•°ç»„ç¬¬ä¸€é¡¹çš„ä¸€ä¸ªå±æ€§(age):</p><pre><code>const repeats = 400;componentDidUpdate() {  ++this.renderCount;  this.dt += performance.now() - this.startTime;  if (this.renderCount % repeats === 0) {    if (this.componentUnderTestIndex &gt; -1) {      this.dts[componentsToTest[this.componentUnderTestIndex]] = this.dt;      console.log(        &apos;dt&apos;,        componentsToTest[this.componentUnderTestIndex],        this.dt      );    }    ++this.componentUnderTestIndex;    this.dt = 0;    this.componentUnderTest = componentsToTest[this.componentUnderTestIndex];  }  if (this.componentUnderTest) {    setTimeout(() =&gt; {      this.startTime = performance.now();      this.setState({ users: getUsers() });    }, 0);  } else {    alert(`      Render Performance ArraySize: ${arraySize} Repeats: ${repeats}      Functional: ${Math.round(this.dts.Functional)} ms      PureComponent: ${Math.round(this.dts.PureComponent)} ms      Component: ${Math.round(this.dts.Component)} ms    `);  }}</code></pre><p>ä¸ºæ­¤ï¼Œæˆ‘ä»¬é‡‡ç”¨ä¸‰ç§æ–¹å¼è®¾è®¡ <user> ç»„ä»¶ã€‚</user></p><h3 id="å‡½æ•°å¼æ–¹å¼"><a href="#å‡½æ•°å¼æ–¹å¼" class="headerlink" title="å‡½æ•°å¼æ–¹å¼"></a>å‡½æ•°å¼æ–¹å¼</h3><pre><code>export const Functional = ({ name, age, hobby }) =&gt; (  &lt;div&gt;    &lt;span&gt;{name}&lt;/span&gt;    &lt;span&gt;{age}&lt;/span&gt;    &lt;span&gt;{hobby}&lt;/span&gt;  &lt;/div&gt;);</code></pre><h3 id="PureComponent-æ–¹å¼"><a href="#PureComponent-æ–¹å¼" class="headerlink" title="PureComponent æ–¹å¼"></a>PureComponent æ–¹å¼</h3><pre><code>export class PureComponent extends React.PureComponent {  render() {    const { name, age, hobby } = this.props;    return (      &lt;div&gt;        &lt;span&gt;{name}&lt;/span&gt;        &lt;span&gt;{age}&lt;/span&gt;        &lt;span&gt;{hobby}&lt;/span&gt;      &lt;/div&gt;    );  }}</code></pre><h3 id="ç»å…¸-class-æ–¹å¼"><a href="#ç»å…¸-class-æ–¹å¼" class="headerlink" title="ç»å…¸ class æ–¹å¼"></a>ç»å…¸ class æ–¹å¼</h3><pre><code>export class Component extends React.Component {  render() {    const { name, age, hobby } = this.props;    return (      &lt;div&gt;        &lt;span&gt;{name}&lt;/span&gt;        &lt;span&gt;{age}&lt;/span&gt;        &lt;span&gt;{hobby}&lt;/span&gt;      &lt;/div&gt;    );  }}</code></pre><p>åŒæ—¶ï¼Œåœ¨ä¸åŒçš„æµè§ˆå™¨ç¯å¢ƒä¸‹ï¼Œæˆ‘å¾—å‡ºï¼š</p><ul><li>Firefox ä¸‹ï¼ŒPureComponent æ”¶ç›Š 30%ï¼›</li><li>Safari ä¸‹ï¼ŒPureComponent æ”¶ç›Š 6%ï¼›</li><li>Chrome ä¸‹ï¼ŒPureComponent æ”¶ç›Š 15%ï¼›</li></ul><p>æµ‹è¯•ç¡¬ä»¶ç¯å¢ƒï¼š</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-b4ad265d8e72d92c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æœºå™¨"></p><p>æœ€ç»ˆç»“æœï¼š</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-e5bf30012d678fa7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p><p>æœ€åï¼Œé€ç»™å¤§å®¶é²è¿…å…ˆç”Ÿçš„ä¸€å¥è¯ï¼š</p><blockquote><p>â€œEarly optimization is the root of all evilâ€â€Š- é²è¿…</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;ç°åœ¨å…³äº React æœ€æ–° v16 ç‰ˆæœ¬æ–°ç‰¹æ€§çš„å®£ä¼ ã€è®²è§£å·²ç»â€œé“ºå¤©ç›–åœ°â€äº†ã€‚ä½ æœ€å–œæ¬¢å“ªä¸€ä¸ª new featureï¼Ÿ&lt;br&gt;æˆªè‡³ç›®å‰ï¼Œç»„ä»¶æ„å»ºæ–¹å¼å·²ç»ç³ç…æ»¡ç›®ã€‚é‚£ä¹ˆï¼Œä½ è€ƒè™‘è¿‡ä»–ä»¬çš„æ€§èƒ½å¯¹æ¯”å—ï¼Ÿè¿™ç¯‡æ–‡ç« ï¼Œèšç„¦å…¶ä¸­ä¸€ä¸ªå°ç»†èŠ‚ï¼Œè¿›è¡Œå¯¹æ¯”ï¼Œæœ›è¯»è€…å‚è€ƒçš„åŒæ—¶ï¼ŒæœŸå¾…å¤§ç¥æ–§æ­£ã€‚&lt;/p&gt;
      
    
    </summary>
    
      <category term="js" scheme="https://exp-team.github.io/categories/js/"/>
    
    
      <category term="js" scheme="https://exp-team.github.io/tags/js/"/>
    
  </entry>
  
  <entry>
    <title>React ç»„ä»¶è®¾è®¡å’Œåˆ†è§£æ€è€ƒ</title>
    <link href="https://exp-team.github.io/blog/2017/11/04/js/react-component/"/>
    <id>https://exp-team.github.io/blog/2017/11/04/js/react-component/</id>
    <published>2017-11-03T16:00:00.000Z</published>
    <updated>2017-11-05T02:49:24.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://upload-images.jianshu.io/upload_images/4363003-7fd2c6c5f0f372a7.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="React"></p><p>ä¹‹å‰åˆ†äº«è¿‡å‡ ç¯‡å…³äºReactæŠ€æœ¯æ ˆçš„æ–‡ç« ï¼š</p><ul><li><a href="http://www.jianshu.com/p/49029b49f2b4" target="_blank" rel="external">åšå‡ºUberç§»åŠ¨ç½‘é¡µç‰ˆè¿˜ä¸å¤Ÿ æè‡´æ€§èƒ½æ‰“é€ æ‰è§çœŸç« </a></li><li><a href="http://www.jianshu.com/p/7a56ac1de2a8" target="_blank" rel="external">è§£æTwitterå‰ç«¯æ¶æ„ å­¦ä¹ å¤æ‚åœºæ™¯æ•°æ®è®¾è®¡</a></li><li><a href="http://www.jianshu.com/p/83c86dd0802d" target="_blank" rel="external">React Conf 2017 å¹²è´§æ€»ç»“1: React + ES next = â™¥</a></li><li><a href="http://www.jianshu.com/p/cde3cf7e2760" target="_blank" rel="external">React+Reduxæ‰“é€ â€œNEWS EARLYâ€å•é¡µåº”ç”¨ ä¸€ä¸ªé¡¹ç›®ç†è§£æœ€å‰æ²¿æŠ€æœ¯æ ˆçœŸè°›</a></li><li><a href="http://www.jianshu.com/p/8e28be0e7ab1" target="_blank" rel="external">ä¸€ä¸ªreact+reduxå·¥ç¨‹å®ä¾‹</a></li><li>â€¦â€¦</li></ul><p>ä»Šå¤©å†æ¥åŒå¤§å®¶è®¨è®º React ç»„ä»¶è®¾è®¡çš„ä¸€ä¸ªæœ‰è¶£è¯é¢˜ï¼š<strong>åˆ†è§£ React ç»„ä»¶çš„å‡ ç§è¿›é˜¶æ–¹æ³•ã€‚</strong></p><p>React ç»„ä»¶é­”åŠ›æ— ç©·ï¼ŒåŒæ—¶çµæ´»æ€§è¶…å¼ºã€‚æˆ‘ä»¬å¯ä»¥åœ¨ç»„ä»¶çš„è®¾è®¡ä¸Šï¼Œç©è½¬å‡ºå¾ˆå¤šèŠ±æ ·ã€‚ä½†æ˜¯ä¿è¯ç»„ä»¶çš„<a href="https://en.wikipedia.org/wiki/Single_responsibility_principle" target="_blank" rel="external">Single responsibility principle: å•ä¸€åŸåˆ™</a>éå¸¸é‡è¦ï¼Œå®ƒå¯ä»¥ä½¿å¾—æˆ‘ä»¬çš„ç»„ä»¶æ›´ç®€å•ã€æ›´æ–¹ä¾¿ç»´æŠ¤ï¼Œæ›´é‡è¦çš„æ˜¯ä½¿å¾—ç»„ä»¶æ›´åŠ å…·æœ‰å¤ç”¨æ€§ã€‚</p><p>ä½†æ˜¯ï¼Œå¦‚ä½•å¯¹ä¸€ä¸ªåŠŸèƒ½å¤æ‚ä¸”è‡ƒè‚¿çš„ React ç»„ä»¶è¿›è¡Œåˆ†è§£ï¼Œä¹Ÿè®¸å¹¶ä¸æ˜¯ä¸€ä»¶ç®€å•çš„äº‹æƒ…ã€‚æœ¬æ–‡ç”±æµ…å…¥æ·±ï¼Œä»‹ç»ä¸‰ä¸ªåˆ†è§£ React ç»„ä»¶çš„æ–¹æ³•ã€‚</p><h2 id="åˆ‡å‰²-render-æ–¹æ³•"><a href="#åˆ‡å‰²-render-æ–¹æ³•" class="headerlink" title="åˆ‡å‰² render() æ–¹æ³•"></a>åˆ‡å‰² render() æ–¹æ³•</h2><p>è¿™æ˜¯ä¸€ä¸ªæœ€å®¹æ˜“æƒ³åˆ°çš„æ–¹æ³•ï¼šå½“ä¸€ä¸ªç»„ä»¶æ¸²æŸ“äº†å¾ˆå¤šå…ƒç´ æ—¶ï¼Œå°±éœ€è¦å°è¯•åˆ†ç¦»è¿™äº›å…ƒç´ çš„æ¸²æŸ“é€»è¾‘ã€‚æœ€è¿…é€Ÿçš„æ–¹å¼å°±æ˜¯åˆ‡å‰² render() æ–¹æ³•ä¸ºå¤šä¸ª sub-render æ–¹æ³•ã€‚</p><p>çœ‹ä¸‹é¢çš„ä¾‹å­ä¼šæ›´åŠ ç›´è§‚ï¼š</p><pre><code>class Panel extends React.Component {  renderHeading() {    // ...  }  renderBody() {    // ...  }  render() {    return (      &lt;div&gt;        {this.renderHeading()}        {this.renderBody()}      &lt;/div&gt;    );  }</code></pre><p>ç»†å¿ƒçš„è¯»è€…å¾ˆå¿«å°±èƒ½å‘ç°ï¼Œ<strong>å…¶å®è¿™å¹¶æ²¡æœ‰åˆ†è§£ç»„ä»¶æœ¬èº«ï¼Œ</strong>è¯¥ Panel ç»„ä»¶ä»ç„¶ä¿æŒæœ‰åŸå…ˆçš„ state, props, ä»¥åŠ class methodsã€‚</p><p>å¦‚ä½•çœŸæ­£åœ°åšåˆ°å‡å°‘å¤æ‚åº¦å‘¢ï¼Ÿæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€äº›å­ç»„ä»¶ã€‚æ­¤æ—¶ï¼Œé‡‡ç”¨æœ€æ–°ç‰ˆ React æ”¯æŒå¹¶æ¨èçš„å‡½æ•°å¼ç»„ä»¶ï¼æ— çŠ¶æ€ç»„ä»¶ä¸€å®šä¼šæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å°è¯•ï¼š</p><pre><code>const PanelHeader = (props) =&gt; (  // ...);const PanelBody = (props) =&gt; (  // ...);class Panel extends React.Component {  render() {    return (      &lt;div&gt;        // Nice and explicit about which props are used        &lt;PanelHeader title={this.props.title}/&gt;        &lt;PanelBody content={this.props.content}/&gt;      &lt;/div&gt;    );   } }</code></pre><p>åŒä¹‹å‰çš„æ–¹å¼ç›¸æ¯”ï¼Œè¿™ä¸ªå¾®å¦™çš„æ”¹è¿›æ˜¯é©å‘½æ€§çš„ã€‚æˆ‘ä»¬æ–°å»ºäº†ä¸¤ä¸ªå•å…ƒç»„ä»¶ï¼šPanelHeader å’Œ PanelBodyã€‚è¿™æ ·å¸¦æ¥äº†æµ‹è¯•çš„ä¾¿åˆ©ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åˆ†ç¦»æµ‹è¯•ä¸åŒçš„ç»„ä»¶ã€‚åŒæ—¶ï¼Œå€ŸåŠ©äº React æ–°çš„ç®—æ³•å¼•æ“ <a href="https://github.com/acdlite/react-fiber-architecture" target="_blank" rel="external">React Fiberï¼Œ</a>ä¸¤ä¸ªå•å…ƒç»„ä»¶åœ¨æ¸²æŸ“çš„æ•ˆç‡ä¸Šï¼Œä¹è§‚åœ°é¢„è®¡ä¼šæœ‰è¾ƒå¤§å¹…åº¦çš„æå‡ã€‚</p><h2 id="æ¨¡ç‰ˆåŒ–ç»„ä»¶"><a href="#æ¨¡ç‰ˆåŒ–ç»„ä»¶" class="headerlink" title="æ¨¡ç‰ˆåŒ–ç»„ä»¶"></a>æ¨¡ç‰ˆåŒ–ç»„ä»¶</h2><p>å›åˆ°é—®é¢˜çš„èµ·ç‚¹ï¼Œä¸ºä»€ä¹ˆä¸€ä¸ªç»„ä»¶ä¼šå˜çš„è‡ƒè‚¿è€Œå¤æ‚å‘¢ï¼Ÿå…¶ä¸€æ˜¯æ¸²æŸ“å…ƒç´ è¾ƒå¤šä¸”åµŒå¥—ï¼Œå¦å¤–å°±æ˜¯ç»„ä»¶å†…éƒ¨å˜åŒ–è¾ƒå¤šï¼Œæˆ–è€…å­˜åœ¨å¤šç§ configurations çš„æƒ…å†µã€‚</p><p>æ­¤æ—¶ï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥å°†ç»„ä»¶æ”¹é€ ä¸ºæ¨¡ç‰ˆï¼šçˆ¶ç»„ä»¶ç±»ä¼¼ä¸€ä¸ªæ¨¡ç‰ˆï¼Œåªä¸“æ³¨äºå„ç§ configurationsã€‚</p><p>è¿˜æ˜¯è¦ä¸¾ä¾‹æ¥è¯´ï¼Œè¿™æ ·ç†è§£èµ·æ¥æ›´åŠ æ¸…æ™°ã€‚</p><p>æ¯”å¦‚æˆ‘ä»¬æœ‰ä¸€ä¸ª Comment ç»„ä»¶ï¼Œè¿™ä¸ªç»„ä»¶å­˜åœ¨å¤šç§è¡Œä¸ºæˆ–äº‹ä»¶ã€‚åŒæ—¶ç»„ä»¶æ‰€å±•ç°çš„ä¿¡æ¯æ ¹æ®ç”¨æˆ·çš„èº«ä»½ä¸åŒè€Œæœ‰æ‰€å˜åŒ–ï¼šç”¨æˆ·æ˜¯å¦æ˜¯æ­¤ comment çš„ä½œè€…ï¼Œæ­¤ comment æ˜¯å¦è¢«æ­£ç¡®ä¿å­˜ï¼Œå„ç§æƒé™ä¸åŒç­‰ç­‰éƒ½ä¼šå¼•èµ·è¿™ä¸ªç»„ä»¶çš„ä¸åŒå±•ç¤ºè¡Œä¸ºã€‚è¿™æ—¶å€™ï¼Œä¸å…¶æŠŠæ‰€æœ‰çš„é€»è¾‘æ··æ·†åœ¨ä¸€èµ·ï¼Œä¹Ÿè®¸æ›´å¥½çš„åšæ³•æ˜¯åˆ©ç”¨ React å¯ä»¥ä¼ é€’ React element çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬å°† React element è¿›è¡Œç»„ä»¶é—´ä¼ é€’ï¼Œè¿™æ ·å°±æ›´åŠ åƒä¸€ä¸ªæ¨¡ç‰ˆï¼š</p><pre><code>class CommentTemplate extends React.Component {  static propTypes = {    // Declare slots as type node    metadata: PropTypes.node,    actions: PropTypes.node,  };  render() {    return (      &lt;div&gt;        &lt;CommentHeading&gt;          &lt;Avatar user={...}/&gt;          // Slot for metadata          &lt;span&gt;{this.props.metadata}&lt;/span&gt;        &lt;/CommentHeading&gt;        &lt;CommentBody/&gt;        &lt;CommentFooter&gt;          &lt;Timestamp time={...}/&gt;          // Slot for actions          &lt;span&gt;{this.props.actions}&lt;/span&gt;        &lt;/CommentFooter&gt;      &lt;/div&gt;      ...</code></pre><p>æ­¤æ—¶ï¼Œæˆ‘ä»¬çœŸæ­£çš„ Comment ç»„ä»¶ç»„ç»‡ä¸ºï¼š</p><pre><code>class Comment extends React.Component {  render() {    const metadata = this.props.publishTime ?      &lt;PublishTime time={this.props.publishTime} /&gt; :      &lt;span&gt;Saving...&lt;/span&gt;;    const actions = [];    if (this.props.isSignedIn) {      actions.push(&lt;LikeAction /&gt;);      actions.push(&lt;ReplyAction /&gt;);    }    if (this.props.isAuthor) {      actions.push(&lt;DeleteAction /&gt;);    }    return &lt;CommentTemplate metadata={metadata} actions={actions} /&gt;;  }</code></pre><p>metadata å’Œ actions å…¶å®å°±æ˜¯åœ¨ç‰¹å®šæƒ…å†µä¸‹éœ€è¦æ¸²æŸ“çš„ React elementã€‚</p><p>æ¯”å¦‚ï¼Œå¦‚æœ this.props.publishTime å­˜åœ¨ï¼Œmetadata å°±æ˜¯ <publishtime time="{this.props.publishTime}">ï¼›åæ­£åˆ™ä¸º <span>Savingâ€¦</span>ã€‚</publishtime></p><p>å¦‚æœç”¨æˆ·å·²ç»ç™»é™†ï¼Œåˆ™éœ€è¦æ¸²æŸ“ï¼ˆå³actionså€¼ä¸ºï¼‰ <likeaction> å’Œ <replyaction>ï¼Œå¦‚æœæ˜¯ä½œè€…æœ¬èº«ï¼Œéœ€è¦æ¸²æŸ“çš„å†…å®¹å°±è¦åŠ å…¥ <deleteaction>ã€‚</deleteaction></replyaction></likeaction></p><h2 id="é«˜é˜¶ç»„ä»¶"><a href="#é«˜é˜¶ç»„ä»¶" class="headerlink" title="é«˜é˜¶ç»„ä»¶"></a>é«˜é˜¶ç»„ä»¶</h2><p>åœ¨å®é™…å¼€å‘å½“ä¸­ï¼Œç»„ä»¶ç»å¸¸ä¼šè¢«å…¶ä»–éœ€æ±‚æ‰€æ±¡æŸ“ã€‚</p><p>æ¯”å¦‚ï¼Œæˆ‘ä»¬æƒ³ç»Ÿè®¡é¡µé¢ä¸­æ‰€æœ‰é“¾æ¥çš„ç‚¹å‡»ä¿¡æ¯ã€‚åœ¨é“¾æ¥ç‚¹å‡»æ—¶ï¼Œå‘é€ç»Ÿè®¡è¯·æ±‚ï¼ŒåŒæ—¶åŒ…å«æ­¤é¡µé¢ document çš„ id å€¼ã€‚å¸¸è§çš„åšæ³•æ˜¯åœ¨ Document ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•° componentDidMount å’Œ componentWillUnmount å¢åŠ ä»£ç é€»è¾‘ï¼š</p><pre><code>class Document extends React.Component {  componentDidMount() {    ReactDOM.findDOMNode(this).addEventListener(&apos;click&apos;, this.onClick);  }  componentWillUnmount() {    ReactDOM.findDOMNode(this).removeEventListener(&apos;click&apos;, this.onClick);  }  onClick = (e) =&gt; {    if (e.target.tagName === &apos;A&apos;) { // Naive check for &lt;a&gt; elements      sendAnalytics(&apos;link clicked&apos;, {        documentId: this.props.documentId // Specific information to be sent      });    }  };  render() {    // ...</code></pre><p>è¿™ä¹ˆåšçš„å‡ ä¸ªé—®é¢˜åœ¨äºï¼š</p><ul><li>ç›¸å…³ç»„ä»¶ Document é™¤äº†è‡ªèº«çš„ä¸»è¦é€»è¾‘ï¼šæ˜¾ç¤ºä¸»é¡µé¢ä¹‹å¤–ï¼Œå¤šäº†å…¶ä»–ç»Ÿè®¡é€»è¾‘ï¼›</li><li>å¦‚æœ Document ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ä¸­ï¼Œè¿˜å­˜åœ¨å…¶ä»–é€»è¾‘ï¼Œé‚£ä¹ˆè¿™ä¸ªç»„ä»¶å°±ä¼šå˜çš„æ›´åŠ å«ç³Šä¸åˆç†ï¼›</li><li>ç»Ÿè®¡é€»è¾‘ä»£ç æ— æ³•å¤ç”¨ï¼›</li><li>ç»„ä»¶é‡æ„ã€ç»´æŠ¤éƒ½ä¼šå˜çš„æ›´åŠ å›°éš¾ã€‚</li></ul><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æå‡ºäº†é«˜é˜¶ç»„ä»¶è¿™ä¸ªæ¦‚å¿µï¼š<a href="https://facebook.github.io/react/docs/higher-order-components.html" target="_blank" rel="external"> higher-order components (HOCs)</a>ã€‚ä¸å»æ™¦æ¶©åœ°è§£é‡Šè¿™ä¸ªåè¯ï¼Œæˆ‘ä»¬æ¥ç›´æ¥çœ‹çœ‹ä½¿ç”¨é«˜é˜¶ç»„ä»¶å¦‚ä½•æ¥é‡æ„ä¸Šé¢çš„ä»£ç ï¼š</p><pre><code>function withLinkAnalytics(mapPropsToData, WrappedComponent) {  class LinkAnalyticsWrapper extends React.Component {    componentDidMount() {      ReactDOM.findDOMNode(this).addEventListener(&apos;click&apos;, this.onClick);    }    componentWillUnmount() {      ReactDOM.findDOMNode(this).removeEventListener(&apos;click&apos;, this.onClick);    }    onClick = (e) =&gt; {      if (e.target.tagName === &apos;A&apos;) { // Naive check for &lt;a&gt; elements        const data = mapPropsToData ? mapPropsToData(this.props) : {};        sendAnalytics(&apos;link clicked&apos;, data);      }    };    render() {      // Simply render the WrappedComponent with all props      return &lt;WrappedComponent {...this.props} /&gt;;    }  }</code></pre><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒwithLinkAnalytics å‡½æ•°å¹¶ä¸ä¼šå»æ”¹å˜ WrappedComponent ç»„ä»¶æœ¬èº«ï¼Œæ›´ä¸ä¼šå»æ”¹å˜ WrappedComponent ç»„ä»¶çš„è¡Œä¸ºã€‚è€Œæ˜¯è¿”å›äº†ä¸€ä¸ªè¢«åŒ…è£¹çš„æ–°ç»„ä»¶ã€‚å®é™…ç”¨æ³•ä¸ºï¼š</p><pre><code>class Document extends React.Component {  render() {    // ...  }}export default withLinkAnalytics((props) =&gt; ({  documentId: props.documentId}), Document);</code></pre><p>è¿™æ ·ä¸€æ¥ï¼ŒDocument ç»„ä»¶ä»ç„¶åªéœ€å…³å¿ƒè‡ªå·±è¯¥å…³å¿ƒçš„éƒ¨åˆ†ï¼Œè€Œ withLinkAnalytics èµ‹äºˆäº†å¤ç”¨ç»Ÿè®¡é€»è¾‘çš„èƒ½åŠ›ã€‚</p><p>é«˜é˜¶ç»„ä»¶çš„å­˜åœ¨ï¼Œå®Œç¾å±•ç¤ºäº† React å¤©ç”Ÿçš„å¤åˆï¼ˆcompositionalï¼‰èƒ½åŠ›ï¼Œåœ¨ React ç¤¾åŒºå½“ä¸­ï¼Œreact-reduxï¼Œstyled-componentsï¼Œreact-intl ç­‰éƒ½æ™®éé‡‡ç”¨äº†è¿™ä¸ªæ–¹å¼ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œ<a href="https://github.com/acdlite/recompose/" target="_blank" rel="external">recompose</a> ç±»åº“åˆåˆ©ç”¨é«˜é˜¶ç»„ä»¶ï¼Œå¹¶å‘æ‰¬å…‰å¤§ï¼Œåšåˆ°äº†â€œè„‘æ´å¤§å¼€â€çš„äº‹æƒ…ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>React åŠå…¶å‘¨è¾¹ç¤¾åŒºçš„å´›èµ·ï¼Œè®©å‡½æ•°å¼ç¼–ç¨‹é£é¡ä¸€æ—¶ï¼Œå—åˆ°è¿½æ§ã€‚å…¶ä¸­å…³äº decomposing å’Œ composing çš„æ€æƒ³ï¼Œæˆ‘è®¤ä¸ºéå¸¸å€¼å¾—å­¦ä¹ ã€‚åŒæ—¶ï¼Œå¯¹å¼€å‘è®¾è®¡çš„ä¸€ä¸ªå»ºè®®æ˜¯ï¼Œä¸è¦çŠ¹è±«å°†ä½ çš„ç»„ä»¶æ‹†åˆ†çš„æ›´å°ã€æ›´å•ä¸€ï¼Œå› ä¸ºè¿™æ ·èƒ½æ¢æ¥å¼ºå¥å’Œå¤ç”¨ã€‚</p><p>æœ¬æ–‡æ„è¯‘äº†<a href="https://medium.com/dailyjs/techniques-for-decomposing-react-components-e8a1081ef5da" target="_blank" rel="external">Chris Nwambaçš„ï¼šReact Universal with Next.js: Server-side React ä¸€æ–‡ï¼Œ</a>å¹¶å¯¹åŸæ–‡è¿›è¡Œäº†å‡çº§ï¼Œå…¼å®¹äº†æœ€æ–°çš„ Next è®¾è®¡ã€‚</p><p>Happy Coding!</p><p>PS: ä½œè€…<a href="https://github.com/HOUCe" target="_blank" rel="external">Githubä»“åº“</a>ï¼Œæ¬¢è¿é€šè¿‡ä»£ç å„ç§å½¢å¼äº¤æµã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/4363003-7fd2c6c5f0f372a7.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot;
      
    
    </summary>
    
      <category term="js" scheme="https://exp-team.github.io/categories/js/"/>
    
    
      <category term="js" scheme="https://exp-team.github.io/tags/js/"/>
    
  </entry>
  
  <entry>
    <title>React æ¨¡æ€æ¡†ç§˜å¯†å’Œâ€œè½®å­â€æ¸è¿›è®¾è®¡</title>
    <link href="https://exp-team.github.io/blog/2017/11/04/js/react-modal/"/>
    <id>https://exp-team.github.io/blog/2017/11/04/js/react-modal/</id>
    <published>2017-11-03T16:00:00.000Z</published>
    <updated>2017-11-05T02:42:04.000Z</updated>
    
    <content type="html"><![CDATA[<p>ä»Šå¤©ä¸Šåˆç»„å†…å°æœ‹å‹ä»¬è°ˆåˆ° React å®è·µï¼Œæåˆ° React æ¨¡æ€æ¡†ï¼ˆå¼¹çª—ï¼‰çš„ä½¿ç”¨ã€‚æˆ‘å‘ç°å¾ˆå¤šä¸€äº› React å¼€å‘è€…å¯¹äº React æ¨¡æ€æ¡†çš„å…·ä½“è®¾è®¡æ€è·¯å’Œå®ç°å­˜åœ¨ä¸€äº›ç–‘æƒ‘ã€‚å› è€Œç‰¹å†™æ­¤æ–‡ï¼Œåˆ†äº«æˆ‘å¯¹<strong>æ¨¡æ€æ¡†è¿™ä¸ªâ€œé‡è¦ä¸”å…¸å‹â€çš„å‰ç«¯äº¤äº’ï¼Œåœ¨ React æ¡†æ¶é‡Œå®ç°çš„ä¸€äº›æƒ³æ³•ã€‚</strong>å‡†å¤‡æ—¶é—´çŸ­ä¿ƒä¸”åŒ†å¿™ï¼Œéš¾å…æœ‰é—æ¼ä¹‹å¤„ï¼Œå¸Œæœ›å¤§ç¥ç»™äºˆæ–§æ­£ã€‚</p><p>è¿™ç¯‡æ–‡ç« â€œè¿›é˜¶å¼â€æ¸è¿›åœ°ï¼Œç”±æµ…å…¥æ·±åˆ†æä¸‰ç§å®ç°ã€‚ä»æœ€åˆçš„ç®€å•ç²—æš´åˆ°æ¥è¿‘ <a href="https://github.com/reactjs/react-modal" target="_blank" rel="external">react-modal</a> åº“è®¾è®¡æ€æƒ³ï¼Œä¸€æ­¥æ­¥æ‰“ç£¨åˆ†æï¼Œé€‚åˆåˆå­¦è€…é˜…è¯»æ€è€ƒã€‚</p><h2 id="åŸå§‹çº§å®ç°-â€”â€”-æš´åŠ›ç¾å­¦"><a href="#åŸå§‹çº§å®ç°-â€”â€”-æš´åŠ›ç¾å­¦" class="headerlink" title="åŸå§‹çº§å®ç° â€”â€” æš´åŠ›ç¾å­¦"></a>åŸå§‹çº§å®ç° â€”â€” æš´åŠ›ç¾å­¦</h2><p>ä¸–ç•Œä¸Šå¤§éƒ¨åˆ†ç½‘ç«™éƒ½ç¦»ä¸å¼€æ¨¡æ€æ¡†äº¤äº’ã€‚äº‹å®ä¸Šï¼Œæ¨¡æ€æ¡†å°±æ˜¯æˆ‘ä»¬ä¿—ç§°çš„â€œå¼¹çª—â€ï¼Œåªä¸è¿‡è¿™ä¸ªå¼¹çª—ç›¸æ¯”ç®€å•çš„ï¼š</p><pre><code>alert(&apos;æˆ‘æ˜¯ä¸€ä¸ªç®€å•ã€åŸç”Ÿçš„ alertï½&apos;);</code></pre><p>å¤šäº†æ›´å¤šçš„ä¿¡æ¯æ‰¿è½½å’Œäº¤äº’è¡Œä¸ºã€‚åŒæ—¶ä¸ºäº†æ›´ä½³ç¾åŒ–å’Œå¸å¼•çœ¼çƒï¼Œæ¨¡æ€æ¡†å¾€å¾€ä¼´éšç€æ·±è‰²é€æ˜çš„é®ç½©ã€‚æ¯”å¦‚ä¸‹å›¾ï¼š</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-bdbf145a382c6272.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æ¨¡æ€æ¡†ä¸¾ä¾‹"></p><p>æƒ³æƒ³å¸¸è§çš„ç”¨æˆ·ç™»å½•æ¡†ã€é”™è¯¯ä¿¡æ¯æç¤ºç­‰ç­‰ï¼Œéƒ½æ˜¯éå¸¸å…¸å‹çš„æ¨¡æ€æ¡†å®ç°ã€‚</p><p>åœ¨ä¼ ç»Ÿçš„ jQuery æ“ä½œ DOM ç±»åº“çš„æŠ€æœ¯æ ˆä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥â€œè‚†æ— å¿Œæƒ®â€åœ°é€‰æ‹© DOM èŠ‚ç‚¹ï¼Œå®Œæˆ append, remove ç­‰æ“ä½œï¼Œå®ç°æ¨¡æ€æ¡†å¹¶ä¸å¤æ‚ã€‚å¯æ˜¯åœ¨ React å’Œ Redux ä¸–ç•Œé‡Œï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•å®ç°ï¼Ÿ</p><p>æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹åœºæ™¯å’Œåˆç‰ˆè®¾è®¡æ€è·¯ï¼š</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-48669842b6993eef.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="åœºæ™¯å’Œåˆç‰ˆè®¾è®¡æ€è·¯"></p><p>å¦‚å›¾ï¼Œç®­å¤´æ ‡è®°çš„ç»„ä»¶éœ€è¦è§¦å‘æ¨¡æ€æ¡†çš„å‡ºç°ã€‚<br>å›¾ä¸­ç»„ä»¶æ ‘å¯¹åº”åŸºæœ¬é¡µé¢ä»£ç å¦‚ä¸‹ï¼š</p><pre><code>export default class App extends Component {    render() {        &lt;div className=&quot;app&quot;&gt;            &lt;div className=&quot;left&quot;&gt;                &lt;h1&gt;Hello left&lt;/h1&gt;                // ...            &lt;/div&gt;            &lt;div className=&quot;right&quot;&gt;                &lt;h1&gt;Hello right&lt;/h1&gt;                // ...                &lt;div&gt;                    &lt;BadModal&gt;                        // æ¨¡æ€æ¡†å†…å®¹                        &lt;h1&gt; Modal title &lt;/h1&gt;                        &lt;p&gt; Modal content&lt;/p&gt;                    &lt;/BadModal&gt;                &lt;/div&gt;            &lt;/div&gt;        &lt;/div&gt;    }}</code></pre><p>ç»†å¿ƒçš„è¯»è€…ä¼šå‘ç°ï¼Œä½œä¸º amazing çš„ç¨‹åºå‘˜ï¼Œå°½ç®¡è¿™æ˜¯æœ€åˆç‰ˆæœ¬çš„å®ç°ï¼Œä½†æ˜¯è¿˜æ˜¯æ€è€ƒä¸€äº›æœ€åŸºæœ¬çš„â€œå¤ç”¨â€é—®é¢˜ã€‚</p><p>æˆ‘ä»¬è®¾è®¡å®Œæˆçš„æ¨¡æ€æ¡†ç»„ä»¶ <badmodal>ï¼Œå› ä¸ºæ¯ä¸ªæ¨¡æ€æ¡†é‡Œå†…å®¹å’Œäº¤äº’ä¸å°½ç›¸åŒï¼Œæ‰€ä»¥åœ¨ <badmodal> ç»„ä»¶å†…ï¼Œæˆ‘ä»¬æ¸²æŸ“ child componentï¼Œè¿™ä¸ª child component å³ä¸šåŠ¡å¯¹åº”çš„æ¨¡æ€æ¡†å†…å®¹ï¼Œå®ƒå°†ä¼šç”±ä¸šåŠ¡é€»è¾‘å¼€å‘å®Œæˆï¼Œå®ç°æ¨¡æ€æ¡†å†…å®¹ã€äº¤äº’çš„å¤ç”¨ã€‚å¦‚ä¸‹ä»£ç ï¼š</badmodal></badmodal></p><pre><code>class BadModal extends Comment {    render() {        return (            &lt;div className=&quot;modal&quot;&gt;                { this.props.children }            &lt;/div&gt;        )    }}</code></pre><p>è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»å®ç°äº†æœ€åŸºæœ¬çš„æ¨¡æ€æ¡†ã€‚å¯æ˜¯ä¸ºä»€ä¹ˆè¯´è¿™æ˜¯æœ€åŸå§‹ã€ç®€é™‹çš„æ–¹æ³•å‘¢ï¼Ÿç»†æƒ³ä¸€ä¸‹ï¼Œä¼¼ä¹ä¸å®Œç¾çš„åœ°æ–¹è¿˜å¾ˆå¤šã€‚ç¿»å¼€æˆ‘ä»¬çš„æ ·å¼è¡¨ï¼š</p><pre><code>body .modal {    position: fixed;    // ...}.left {    z-index: 3}.right {    z-index: 1}</code></pre><p>ä½ ä¼šå‘ç°æ¼äººçš„ z-index é—®é¢˜ï¼Œæˆ‘ä»¬æ¨¡æ€æ¡†æ˜¯ .right èŠ‚ç‚¹çš„å­å­™èŠ‚ç‚¹ï¼Œè€Œ .right çš„ z-index å°äº .left çš„ z-indexï¼Œè¿™æ ·é€ æˆçš„ç›´æ¥é—®é¢˜å°±æ˜¯æ¨¡æ€æ¡†æœ€ç»ˆä¸èƒ½è„±ç¦»é¡µé¢æ•´ä½“è€Œâ€œçªå‡ºæ˜¾ç¤ºâ€ï¼</p><p><strong>ç»†æƒ³ä¸€ä¸‹ï¼Œè¿™ä¸ªé—®é¢˜çš„æ ¹æœ¬å°±å‡ºç°åœ¨æˆ‘ä»¬çš„ç»„ä»¶è®¾è®¡å›¾ä¸­ã€‚</strong><br>ä»”ç»†è§‚å¯Ÿä¸Šå›¾ï¼Œå› ä¸ºå¾ˆæ·±å±‚æ¬¡çš„å­å­™ç»„ä»¶è§¦å‘æ¨¡æ€æ¡†ï¼Œè€Œä½¿å¾—è¯¥ç»„ä»¶å†…çš„æ¨¡æ€æ¡†ç»„ä»¶å±‚çº§è¾ƒæ·±ã€‚å¦‚æœä½ å¯¹ z-index æ¯”è¾ƒè§„åˆ™æœ‰æ‰€äº†è§£çš„è¯ï¼Œè¿™æ ·çš„æƒ…å†µå¾ˆéš¾å®Œæˆæ¨¡æ€æ¡†å‡Œé©¾äºé¡µé¢æ•´ä½“è€Œå‡ºç°çš„ï¼Œé®ç½©ä¹Ÿæ— æ³•è¦†ç›–æ•´ä¸ªé¡µé¢ã€‚</p><p>æƒ³æƒ³æˆ‘ä»¬å¹³æ—¶ä½¿ç”¨çš„ jQuery æ˜¯æ€ä¹ˆåšçš„å§ï¼š</p><pre><code>$(&apos;body&apos;).append(&apos;&lt;div class=&quot;overlay&quot;&gt;&lt;/div&gt;&apos;);</code></pre><p>ä¸€èˆ¬æƒ…å†µï¼Œæ¨¡æ€æ¡†å’Œé®ç½©æ€»æ˜¯ä½œä¸ºåœ¨ body ä¸‹çš„ç¬¬ä¸€å±‚å­èŠ‚ç‚¹å‡ºç°ã€‚ç”±æ­¤ï¼Œå¼•å‡ºäº†æˆ‘ä»¬çš„ç¬¬äºŒç§è¿›é˜¶æ€è·¯ã€‚è¯·è¯»è€…ç»§ç»­é˜…è¯»ã€‚</p><h2 id="å®ç°æ–¹æ¡ˆäºŒ-â€”â€”-ä¹¾å¤å¤§æŒªç§»"><a href="#å®ç°æ–¹æ¡ˆäºŒ-â€”â€”-ä¹¾å¤å¤§æŒªç§»" class="headerlink" title="å®ç°æ–¹æ¡ˆäºŒ â€”â€” ä¹¾å¤å¤§æŒªç§»"></a>å®ç°æ–¹æ¡ˆäºŒ â€”â€” ä¹¾å¤å¤§æŒªç§»</h2><p>è§£å†³æ–¹æ³•å¾ˆç®€å•ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆè‡ªç„¶åœ°æƒ³åˆ°ï¼šåªéœ€è¦<strong>å¯¹ <modal> ç»„ä»¶å‡ºç°çš„ä½ç½®è¿›è¡Œç§»åŠ¨ã€‚å¯æ˜¯è¿™å°±éœ€è¦ <modal> ç»„ä»¶å’Œè§¦å‘æ¨¡æ€æ¡†å‡ºç°çš„æ·±å±‚æ¬¡ç»„ä»¶è¿›è¡ŒæŸç§æ„ä¹‰ä¸Šçš„é€šä¿¡ã€‚</modal></modal></strong></p><p>ä¼ ç»Ÿçš„ React ç»„ä»¶é—´é€šä¿¡æ— å¤–ä¹ props å’ŒåŸºäº props çš„å›è°ƒå®ç°ï¼ˆä¸è€ƒè™‘ context çš„é»‘é­”æ³•ï¼‰ã€‚å¯æ˜¯è¿™æ ·çš„åšæ³•å¤ªè¿‡å¤æ‚ï¼Œä¹Ÿéš¾ä»¥å®ç°å¤ç”¨ï¼Œæ›´ä¸åˆ©äºç»´æŠ¤ã€‚</p><p>è‡³äºæˆ‘è¿™é‡Œé‡‡ç”¨çš„åšæ³•ï¼Œè¿˜è¦ä»è°ƒæ•´åçš„é¡µé¢ç»„ä»¶æ ‘è®¾è®¡å‡ºå‘ï¼š</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-97c2399ecd828fb4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p><p>å¦‚å›¾ï¼Œæˆ‘ä»¬åœ¨ document.body ä¸‹åŠ å…¥äº† <modal> ç»„ä»¶ï¼Œå¹¶åˆ—äº Root Componentã€‚åŒæ—¶ï¼Œè‡³å…³é‡è¦çš„ä¸€æ­¥è®¾è®¡æ˜¯ï¼Œ<strong>æˆ‘ä»¬åœ¨è§¦å‘æ¨¡æ€æ¡†çš„ç»„ä»¶ä¸‹ï¼ŒåŠ å…¥äº†ä¸€ä¸ª Fake Modal ç»„ä»¶ã€‚</strong></modal></p><p>è¿™ä¸ªç¥ç§˜çš„ Fake Modal ç»„ä»¶åšäº†ä»€ä¹ˆå‘¢ï¼Ÿ<br><strong>äº‹å®ä¸Šï¼Œä»–å¹¶ä¸æ¸²æŸ“ä»»ä½•ç»“æœï¼Œè€Œæ˜¯å€ŸåŠ©å…¶ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œå®Œæˆåœ¨ document.body ä¸‹æ–°å»ºå¹¶æ’å…¥ <modal> ç»„ä»¶çš„ä½¿å‘½ã€‚</modal></strong></p><p>å€ŸåŠ©ä»£ç è¿›è¡Œç†è§£ï¼š</p><pre><code>class Modal extends Comment {    componentDidMount() {        this.modalTarget = document.createElement(&apos;div&apos;);        this.modalTarget.className = &apos;modal&apos;;        document.body.appendChild(this.modalTarget);        this.renderModal();    }    componentWillUpdate() {        this.renderModal();    }    componentWillUnmount() {        ReactDom.unmountComponentAtNode(this.modalTarget);        document.body.removeChild(this.modalTarget)l    }    renderModal() {        ReactDom.render(            &lt;div&gt;{ this.props.children }&lt;/div&gt;,            this.modalTarget        );    }    render() {        return &lt;noscript /&gt;    }}</code></pre><p>å…·ä½“è¿›è¡Œåˆ†æåœ¨çœŸæ­£çš„ render æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬ä¸æ¸²æŸ“ä»»ä½•å®è´¨çš„å†…å®¹ï¼Œè€Œæ˜¯ï¼š</p><pre><code>return &lt;noscript /&gt;;</code></pre><p>åŒæ—¶ï¼Œå€ŸåŠ©ç”Ÿå‘½å‘¨æœŸå‡½æ•° componentDidMountï¼Œæˆ‘ä»¬ä½¿ç”¨åŸç”Ÿ JavaScript å®ç°åœ¨ body ä¸‹çš„æ¨¡æ€æ¡†åˆ›å»ºï¼š</p><pre><code>this.modalTarget = document.createElement(&apos;div&apos;);this.modalTarget.className = &apos;modal&apos;;document.body.appendChild(this.modalTarget);this.renderModal();</code></pre><p>å¹¶æœ€ç»ˆè°ƒç”¨ renderModal æ–¹æ³•å®Œæˆæ’å…¥ï¼š</p><pre><code>ReactDom.render(    &lt;div&gt;{ this.props.children }&lt;/div&gt;,    this.modalTarget);</code></pre><h2 id="å®ç°æ–¹æ¡ˆä¸‰-â€”â€”-æ­é…-Redux"><a href="#å®ç°æ–¹æ¡ˆä¸‰-â€”â€”-æ­é…-Redux" class="headerlink" title="å®ç°æ–¹æ¡ˆä¸‰ â€”â€” æ­é… Redux"></a>å®ç°æ–¹æ¡ˆä¸‰ â€”â€” æ­é… Redux</h2><p>ç›¸ä¿¡å¾ˆå¤š React å¼€å‘è€…éƒ½ä¼šä½¿ç”¨ Redux æ¥åšæ•°æ®ç®¡ç†ã€‚ä»”ç»†çœ‹ä¸Šå›¾çš„ç»“æ„ä¸­ï¼Œæˆ‘ä»¬éš¾ä»¥å®ç°å¯¹ Redux çš„å‹å¥½å…¼å®¹ã€‚</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-8039ace2b5b26aaa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p><p>å›¾ç‰‡</p><p>æ¯”å¦‚è¯´ï¼Œå¦‚æœåœ¨ <modal> ç»„ä»¶çš„å­ç»„ä»¶ child component ä¸­ï¼Œéœ€è¦ä½¿ç”¨ Redux store é‡Œçš„æ•°æ®ï¼Œé‚£ä¹ˆå› ä¸º <provider> å®è´¨ä¸Šæ˜¯ä¸€ä¸ªâ€œé«˜é˜¶ç»„ä»¶â€ä¸”ä¸åœ¨ <modal> ç»„ä»¶çš„ç»„ä»¶é“¾ä¸­ï¼Œå› ä¸º child component æ— æ³•æ„ŸçŸ¥ Redux store çš„å­˜åœ¨ã€‚</modal></provider></modal></p><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ç»§ç»­æ”¹è¿›ç»„ä»¶æ ‘ç»“æ„ä¸ºï¼š</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-4643613c42286b86.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p><p>å›¾ç‰‡</p><p>ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¼•å…¥åº”ç”¨çš„ storeï¼Œä»¥åŠ react-redux åŒ…æä¾›çš„ <provider> ç»„ä»¶ï¼š</provider></p><pre><code>import { store } from &apos;../index&apos;;import { Provider } from &apos;react-redux&apos;;</code></pre><p>åŒæ—¶æ”¹åŠ¨å…ˆå‰çš„ renderModal æ–¹æ³•ï¼ŒåŠ å…¥å¯¹ <provider> çš„æ”¯æŒï¼š</provider></p><pre><code>renderModal() {    ReactDom.render(        &lt;Provider store={ store }&gt;            &lt;div&gt;{ this.props.children }&lt;/div&gt;        &lt;Provider&gt;,        this.modalTarget    );}</code></pre><h2 id="è‘—åçš„-react-modal-æ¢ç§˜å’Œ-React16-ç‰ˆæœ¬æƒŠå–œ"><a href="#è‘—åçš„-react-modal-æ¢ç§˜å’Œ-React16-ç‰ˆæœ¬æƒŠå–œ" class="headerlink" title="è‘—åçš„ react-modal æ¢ç§˜å’Œ React16 ç‰ˆæœ¬æƒŠå–œ"></a>è‘—åçš„ react-modal æ¢ç§˜å’Œ React16 ç‰ˆæœ¬æƒŠå–œ</h2><p>åœ¨ React å¼€å‘ä¸­ï¼Œæˆ‘æƒ³å¾ˆå¤šå·¥ç¨‹å¸ˆå¯¹ <a href="https://github.com/reactjs/react-modal" target="_blank" rel="external">react-modal</a> éå¸¸ç†Ÿæ‚‰ã€‚æˆ‘ä»¬å¾€å¾€ä¾èµ–å®ƒï¼Œå®Œæˆæ¨¡æ€æ¡†çš„ä½¿ç”¨ã€‚</p><p>è¿™ä¸ªåº“è®¾è®¡è‰¯å¥½ï¼Œè¯·å°è£…å®Œå–„ã€‚å¦‚æœä½ å¥½å¥‡å®ƒæ˜¯å¦‚ä½•å®ç°çš„ï¼Œæºç åˆæ˜¯å¦‚ä½•ç»„ç»‡ï¼Ÿé‚£ä¹ˆæˆ‘å¯ä»¥å‘Šè¯‰ä½ ï¼Œä½ å·²ç»äº†è§£äº†ä»–çš„è®¾è®¡å“²å­¦ã€‚äº‹å®ä¸Šï¼Œæ–‡ç« ä»‹ç»çš„æ€è·¯å°±æ˜¯å®ƒçš„å¥¥ç§˜ã€‚</p><p>äº†è§£äº†è¿™äº›ï¼Œä½ ä¹Ÿå¯ä»¥åŠ¨æ‰‹å®ç°â€œä¸€ä¸ªè½®å­â€ï¼Œæˆ–è€…æ‰©å……æœ¬æ–‡æºç ï¼Œå®ç°æ›´å¤šçš„åŠŸèƒ½ã€‚æ¯”å¦‚æ ·å¼çš„è‡ªå®šä¹‰ã€å¼¹å‡ºå‰åçš„å›è°ƒç­‰ç­‰ã€‚ç›¸ä¿¡ä¸€å®šä¼šæœ‰å¾ˆå¤šæ”¶è·ã€‚</p><p>åŒæ—¶ï¼ŒReact æœ€æ–°ç‰ˆæœ¬ 0.16 å·²ç»æ¨ªç©ºå‡ºä¸–ï¼Œå®ƒå¸¦æ¥çš„å¾ˆå¤šæ–°ç‰¹æ€§ä¹‹ä¸€å°±ä¸æœ¬æ–‡å¯†åˆ‡ç›¸å…³ã€‚é‚£å°±æ˜¯ â€”â€” Portalï¼ŒPortal æˆ‘ä»¬æŠŠå®ƒç¿»è¯‘ä¸ºâ€œä¼ é€é—¨ã€ä»»æ„é—¨â€ã€‚Portals å…è®¸å°†ç»„ä»¶æ¸²æŸ“åˆ°çˆ¶èŠ‚ç‚¹ä¹‹å¤–çš„ DOM èŠ‚ç‚¹ä¸­ã€‚å®ƒçš„åŸºæœ¬ä½¿ç”¨å¦‚ä¸‹ä»£ç ç¤ºä¾‹ï¼š</p><pre><code>render() {    return ReactDOM.createPortal(                this.props.children,                anyDomNode,            );}</code></pre><p>è¿™é‡Œ React å¹¶ä¸ä¼šåœ¨å½“å‰ç»“æ„ä¸­æ¸²æŸ“ç»„ä»¶ï¼Œè€Œæ˜¯å‘ anyDomNode ä¸­æ¸²æŸ“ this.props.childrenï¼Œè¿™é‡Œçš„ anyDomNode æ˜¯ä»»ä½•æœ‰æ•ˆçš„DOMèŠ‚ç‚¹ï¼Œæ— è®ºå®ƒå¤„äºå“ªä¸ªå±‚çº§ä½ç½®ã€‚</p><p>äº†è§£äº†è¿™äº›ï¼Œæˆ‘ä»¬å½“ç„¶èƒ½å¤Ÿä½¿ç”¨æ­¤ç‰¹æ€§ï¼Œç®€åŒ–ä¸Šæ–‡é€»è¾‘ã€‚ç¿»å¼€ react-modal æœ€æ–°æäº¤çš„æºç ï¼Œä¾¿èƒ½å¤Ÿå‘ç°å¯¹è¿™ä¸€æ–°ç‰¹æ€§çš„æ”¯æŒï¼Œreact-modal/src/components/Modal.js æ–‡ä»¶ä¸­ï¼š</p><pre><code>const isReact16 = ReactDOM.createPortal !== undefined;const createPortal = isReact16  ? ReactDOM.createPortal  : ReactDOM.unstable_renderSubtreeIntoContainer;</code></pre><p>è¿™é‡Œå¯¹ React ç‰ˆæœ¬è¿›è¡Œåˆ¤æ–­ï¼Œå¹¶è®¾ç½® isReact16 æ ‡è¯†ä½è¡¨ç¤ºæ˜¯å¦æ”¯æŒ createPortal çš„æ–¹æ³•ï¼ˆä¸ªäººè®¤ä¸ºè¿™ä¸ªæ ‡è¯†ä½çš„å‘½åéå¸¸ä¸åˆé€‚â€¦ï¼‰</p><p>æœ€ç»ˆåœ¨ render æ–¹æ³•å†…ï¼š</p><pre><code>render() {    if (!canUseDOM || !isReact16) {        return null;    }    if (!this.node &amp;&amp; isReact16) {        this.node = document.createElement(&quot;div&quot;);    }    return createPortal(        &lt;ModalPortal            ref={this.portalRef}            defaultStyles={Modal.defaultStyles}            {...this.props}        /&gt;,        this.node    );}</code></pre><p>éå¸¸æ˜æ˜¾åœ°çœ‹åˆ°ï¼Œå¯¹äºä¸æ”¯æŒ createPortal çš„æƒ…å†µé‡‡ç”¨ä¸æˆ‘ä»¬ç±»ä¼¼çš„ return null; å¦åˆ™æ„‰å¿«åœ°ä½¿ç”¨ createPortal æ–¹æ³•ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ¬æ–‡ä»‹ç»å†…å®¹è™½ç„¶åŸºç¡€ï¼Œä½†æ˜¯å¾ˆå¥½åœ°è´¯ç©¿äº† React æ€æƒ³ä»¥åŠå®ç°ä¸€ä¸ªâ€œæ¨¡æ€æ¡†è½®å­â€çš„æ¼”è¿›æ€è·¯ã€‚åŒæ—¶ä»‹ç»äº† React æ–°ç‰ˆæœ¬çš„ä¸€é¡¹ç‰¹æ€§ã€‚</p><p>æˆ‘çš„å…¶ä»–å‡ ç¯‡å…³äºReactæŠ€æœ¯æ ˆçš„æ–‡ç« ï¼š</p><ul><li><a href="https://zhuanlan.zhihu.com/p/28525821" target="_blank" rel="external">React Redux ä¸­é—´ä»¶æ€æƒ³é‡è§ Web Worker çš„çµæ„Ÿï¼ˆé™„demoï¼‰</a></li><li><a href="https://zhuanlan.zhihu.com/p/29732224" target="_blank" rel="external">äº†è§£ Twitter å‰ç«¯æ¶æ„ å­¦ä¹ å¤æ‚åœºæ™¯æ•°æ®è®¾è®¡</a></li><li><a href="https://zhuanlan.zhihu.com/p/29711902" target="_blank" rel="external">React æ¢ç§˜ - React Component å’Œ Elementï¼ˆæ–‡æœ«é™„å½©è›‹demoå’Œæºç ï¼‰</a></li><li><a href="https://zhuanlan.zhihu.com/p/28905707" target="_blank" rel="external">ä»setState promiseåŒ–çš„æ¢è®¨ ä½“ä¼šReactå›¢é˜Ÿè®¾è®¡æ€æƒ³</a></li><li><a href="https://zhuanlan.zhihu.com/p/27825741" target="_blank" rel="external">é€šè¿‡å®ä¾‹ï¼Œå­¦ä¹ ç¼–å†™ React ç»„ä»¶çš„â€œæœ€ä½³å®è·µâ€</a></li><li><a href="https://zhuanlan.zhihu.com/p/27727292" target="_blank" rel="external">React ç»„ä»¶è®¾è®¡å’Œåˆ†è§£æ€è€ƒ</a></li><li><a href="https://zhuanlan.zhihu.com/p/28905707/edit" target="_blank" rel="external">ä» React ç»‘å®š thisï¼Œçœ‹ JS è¯­è¨€å‘å±•å’Œæ¡†æ¶è®¾è®¡</a></li><li><a href="https://zhuanlan.zhihu.com/p/28004982" target="_blank" rel="external">React æœåŠ¡ç«¯æ¸²æŸ“å¦‚æ­¤è½»æ¾ ä»é›¶å¼€å§‹æ„å»ºå‰åç«¯åº”ç”¨</a></li><li><a href="http://link.zhihu.com/?target=http%3A//www.jianshu.com/p/49029b49f2b4" target="_blank" rel="external">åšå‡ºUberç§»åŠ¨ç½‘é¡µç‰ˆè¿˜ä¸å¤Ÿ æè‡´æ€§èƒ½æ‰“é€ æ‰è§çœŸç« **</a></li><li><a href="http://link.zhihu.com/?target=http%3A//www.jianshu.com/p/cde3cf7e2760" target="_blank" rel="external">React+Reduxæ‰“é€ â€œNEWS EARLYâ€å•é¡µåº”ç”¨ ä¸€ä¸ªé¡¹ç›®ç†è§£æœ€å‰æ²¿æŠ€æœ¯æ ˆçœŸè°›**</a></li></ul><p>Happy Coding!<br>PS: ä½œè€… <a href="http://link.zhihu.com/?target=https%3A//github.com/HOUCe" target="_blank" rel="external">Githubä»“åº“**</a> å’Œ <a href="https://www.zhihu.com/people/lucas-hc/answers" target="_blank" rel="external">çŸ¥ä¹é—®ç­”é“¾æ¥</a> æ¬¢è¿å„ç§å½¢å¼äº¤æµã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;ä»Šå¤©ä¸Šåˆç»„å†…å°æœ‹å‹ä»¬è°ˆåˆ° React å®è·µï¼Œæåˆ° React æ¨¡æ€æ¡†ï¼ˆå¼¹çª—ï¼‰çš„ä½¿ç”¨ã€‚æˆ‘å‘ç°å¾ˆå¤šä¸€äº› React å¼€å‘è€…å¯¹äº React æ¨¡æ€æ¡†çš„å…·ä½“è®¾è®¡æ€è·¯å’Œå®ç°å­˜åœ¨ä¸€äº›ç–‘æƒ‘ã€‚å› è€Œç‰¹å†™æ­¤æ–‡ï¼Œåˆ†äº«æˆ‘å¯¹&lt;strong&gt;æ¨¡æ€æ¡†è¿™ä¸ªâ€œé‡è¦ä¸”å…¸å‹â€çš„å‰ç«¯äº¤äº’ï¼Œåœ¨ React æ¡†æ¶é‡Œå®
      
    
    </summary>
    
      <category term="js" scheme="https://exp-team.github.io/categories/js/"/>
    
    
      <category term="js" scheme="https://exp-team.github.io/tags/js/"/>
    
  </entry>
  
  <entry>
    <title>React Redux ä¸­é—´ä»¶æ€æƒ³é‡è§ Web Worker çš„çµæ„Ÿï¼ˆé™„demoï¼‰</title>
    <link href="https://exp-team.github.io/blog/2017/11/04/js/react-worker/"/>
    <id>https://exp-team.github.io/blog/2017/11/04/js/react-worker/</id>
    <published>2017-11-03T16:00:00.000Z</published>
    <updated>2017-11-05T02:50:04.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å†™åœ¨æœ€å‰"><a href="#å†™åœ¨æœ€å‰" class="headerlink" title="å†™åœ¨æœ€å‰"></a>å†™åœ¨æœ€å‰</h2><p>åŸæ–‡é¦–å‘äºä½œè€…çš„çŸ¥ä¹ä¸“æ ï¼š<a href="https://zhuanlan.zhihu.com/p/28525821" target="_blank" rel="external">React Redux ä¸­é—´ä»¶æ€æƒ³é‡è§ Web Worker çš„çµæ„Ÿï¼ˆé™„demoï¼‰</a>ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥çŸ¥ä¹å…³æ³¨ï¼Œè¿›è¡Œäº¤æµã€‚</p><p>ç†Ÿæ‚‰ React æŠ€æœ¯æ ˆçš„åŒå­¦ï¼Œæƒ³å¿…å¯¹ Redux æ•°æ®æµæ¡†æ¶å¹¶ä¸é™Œç”Ÿã€‚å…¶å€¡å¯¼çš„å•å‘æ•°æ®æµç­‰æ€æƒ³ç‹¬æ ‘ä¸€å¸œï¼Œè™½ç„¶æ ·æ¿ä»£ç ä¼šæœ‰ä¸€å®šç¨‹åº¦ä¸Šçš„å¢å¤šï¼Œä½†æ˜¯å¯¹äºå¼€å‘æ•ˆç‡å’Œè°ƒè¯•æ•ˆç‡çš„æé«˜æ˜¯æ˜¾è‘—çš„ã€‚åŒæ—¶è¿˜å¸¦æ¥äº†å¾ˆå¤šè¯¸å¦‚ â€œæ—¶é—´æ—…è¡Œâ€ï¼Œâ€œ undo/redo â€ ç­‰é»‘é­”æ³•ã€‚</p><p>å…¶å®è¿™è¿˜åªæ˜¯è¡¨è±¡ã€‚å¦‚æœä½ æ·±å…¥å»äº†è§£ Redux çš„è®¾è®¡ç†å¿µï¼Œæ¢ç´¢ä¸­é—´ä»¶å¥¥ç§˜ï¼Œç©è½¬é«˜é˜¶ reducer ç­‰ç­‰ï¼Œè¿æ¥ä½ çš„å°±ä¼šæ˜¯å¦ä¸€æ‰‡é—¨ã€‚é€è¿‡å®ƒï¼Œå‡½æ•°å¼ç¼–ç¨‹æ€æƒ³ä¹‹å…‰å€¾æ–œå¦‚æ³¨ã€‚</p><h2 id="æ€æƒ³èƒŒæ™¯"><a href="#æ€æƒ³èƒŒæ™¯" class="headerlink" title="æ€æƒ³èƒŒæ™¯"></a>æ€æƒ³èƒŒæ™¯</h2><p>ä½†æ˜¯éšç€è¿™ä¸ª web app å¤æ‚åº¦çš„æå‡ï¼Œæ•°æ®è®¡ç®—é‡å‹åŠ›å¾’å¢ï¼Œä½ æ‰€è®¾è®¡çš„ Reducer å˜å¾—è‡ƒè‚¿ä¸å ªã€‚å¥½å§ï¼Œæˆ‘ä»¬å¯ä»¥æ‹†åˆ† Reducer ä½¿å¾—ä»£ç çœ‹ä¸Šå»æ›´åŠ èˆ’æœã€‚å¯æ˜¯è®¡ç®—é‡å‘¢ï¼Ÿä¹Ÿè®¸æœ‰ä¸€äº›â€œæ¢¦é­‡â€ï¼Œç“¶é¢ˆèˆ¬æ°¸è¿œæ— æ³•æ¶ˆé™¤ã€‚</p><p>å†¥å†¥ä¹‹ä¸­ï¼Œâ€œå„ç§å¤„ç†è®¡ç®—æ—¢ç„¶æ³¨å®šåœ¨åŒä¸€æ—¶ç©ºï¼Œé‚£ä¹ˆèƒ½å¦æ°¸è¿œå¹³è¡Œï¼Ÿâ€</p><p><strong>æ›¾å‡ ä½•æ—¶ï¼Œä½ æ˜¯å¦å¬è¯´è¿‡ JS å•çº¿ç¨‹å¼‚æ­¥ï¼Ÿå¬è¯´è¿‡æµè§ˆå™¨å¡é¡¿æˆ–å¡æ­»ï¼Ÿå¬è¯´è¿‡ 60 fpsï¼Ÿ</strong></p><p>å…¶å®ä¸€ä¸ªå¾ˆä¸¥å³»çš„äº‹å®æ˜¯ï¼šæ ¹æ® 60 fps è®¡ç®—ï¼Œæ¯ä¸€å¸§ç•™ç»™æˆ‘ä»¬ JS æ‰§è¡Œçš„æ—¶é—´ä¸º 16msï¼ˆç”šè‡³æ›´å°‘ï¼‰ã€‚é‚£ä¹ˆä¸€æ—¦å½“ Reducer è®¡ç®—æ—¶é—´è¿‡é•¿ï¼Œå¿…ç„¶ä¼šå½±å“æµè§ˆå™¨æ¸²æŸ“ã€‚</p><h2 id="å¤šçº¿ç¨‹æ€è·¯"><a href="#å¤šçº¿ç¨‹æ€è·¯" class="headerlink" title="å¤šçº¿ç¨‹æ€è·¯"></a>å¤šçº¿ç¨‹æ€è·¯</h2><p>å…³äºæµè§ˆå™¨ä¸»çº¿ç¨‹ã€render queueã€event loopã€call stack ç­‰å†…å®¹ï¼Œæœ¬æ–‡ä¸å†å¤è¿°ï¼Œå› ä¸ºé‡Œé¢çš„çŸ¥è¯†å®Œå…¨éƒ½å¤Ÿå†™ä¸€æœ¬ä¹¦äº†ã€‚å‡å®šè¯»è€…å¯¹å…¶æœ‰ä¸€äºŒè®¤çŸ¥ï¼Œé‚£ä¹ˆä½ ä¹Ÿä¸éš¾ç†è§£æˆ‘ä»¬å³å°†ç™»åœºçš„æ•‘æ˜Ÿâ€”â€” Web Worker!</p><p><strong>æˆ‘ä»¬å…ˆæ¥ç®€å•è®¤è¯†ä¸€ä¸‹ web workerï¼š</strong></p><p>2008 å¹´ W3C åˆ¶å®šå‡ºç¬¬ä¸€ä¸ª HTML5 è‰æ¡ˆå¼€å§‹ï¼ŒHTML5 æ‰¿è½½äº†è¶Šæ¥è¶Šå¤šå´­æ–°çš„ç‰¹æ€§å’ŒåŠŸèƒ½ã€‚å…¶ä¸­ï¼Œæœ€é‡è¦çš„ä¸€ä¸ªä¾¿æ˜¯å¯¹å¤šçº¿ç¨‹çš„æ”¯æŒã€‚åœ¨ HTML5 ä¸­æå‡ºäº†å·¥ä½œçº¿ç¨‹ï¼ˆWeb Workerï¼‰çš„æ¦‚å¿µï¼Œå¹¶ä¸”è§„èŒƒå‡º Web Worker çš„ä¸‰å¤§ä¸»è¦ç‰¹å¾ï¼š</p><ul><li>èƒ½å¤Ÿé•¿æ—¶é—´è¿è¡Œï¼ˆå“åº”ï¼‰ï¼›</li><li>ç†æƒ³çš„å¯åŠ¨æ€§èƒ½ï¼›</li><li>ä»¥åŠç†æƒ³çš„å†…å­˜æ¶ˆè€—ã€‚</li></ul><p>Work çº¿ç¨‹å¯ä»¥æ‰§è¡Œä»»åŠ¡è€Œä¸å¹²æ‰°ç”¨æˆ·ç•Œé¢ã€‚</p><p><strong>äºæ˜¯ï¼Œè„‘æ´å¤§å¼€ï¼Œèƒ½å¦å°†æˆ‘ä»¬çš„ Redux Reducer è®¡ç®—çŠ¶æ€éƒ¨åˆ†æ”¾è¿› Worker çº¿ç¨‹ä¸­å¤„ç†å‘¢ï¼Ÿ</strong></p><p><strong>ç­”æ¡ˆæ˜¯è‚¯å®šçš„ã€‚</strong><br><strong>é‚£ä¹ˆè¦å¦‚ä½•å®æ–½å‘¢ï¼Ÿ</strong></p><p>æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹ç»å…¸çš„ Redux workflowï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-32fe6806781bfedb?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="redux æµç¨‹å›¾"></p><p>å¦‚æœè¦æ¥å…¥ Web Workï¼Œé‚£ä¹ˆæˆ‘ä»¬æ”¹åŠ¨æµç¨‹å›¾å¦‚ä¸‹ï¼š</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-17b02c39b2127514?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="redux + worker æµç¨‹å›¾"></p><h2 id="å…·ä½“å®ç°å’Œä¸€ä¸ªdemo"><a href="#å…·ä½“å®ç°å’Œä¸€ä¸ªdemo" class="headerlink" title="å…·ä½“å®ç°å’Œä¸€ä¸ªdemo"></a>å…·ä½“å®ç°å’Œä¸€ä¸ªdemo</h2><p>å½“ç„¶ï¼Œæœ‰äº†æ€è·¯ï¼Œè¿˜éœ€è¦åœ¨å®æˆ˜ä¸­æ¼”ç»ƒã€‚</p><p>æˆ‘ä½¿ç”¨ <a href="http://blog.csdn.net/hackbuteer1/article/details/6657109" target="_blank" rel="external">â€œN-çš‡åé—®é¢˜â€</a> æ¨¡æ‹Ÿå¤§å‹è®¡ç®—ï¼Œå¹¶ä¸”å®ç°çš„ demo ä¸­å¯ä»¥ä»»æ„è®¾ç½® n å€¼ï¼Œå¢åŠ è®¡ç®—è€—æ—¶ã€‚<br>å¦‚æœä½ ä¸ç†è§£æ­¤ç®—æ³•ä¹Ÿæ²¡æœ‰å…³ç³»ï¼Œåªéœ€è¦çŸ¥é“N-çš‡åé—®é¢˜è¿™ä¸ªç®—æ³•çš„è®¡ç®—è€—æ—¶å¾ˆé•¿ï¼Œä¸”å’Œ n å€¼ç›¸å…³ï¼šn è¶Šå¤§ï¼Œè®¡ç®—æˆæœ¬è¶Šå¤§ã€‚</p><p>é™¤äº†ä¸€ä¸ªæå…¶è€—æ—¶çš„è®¡ç®—ï¼Œé¡µé¢ä¸­è¿˜è¿è¡Œè¿™ä¹ˆå‡ ä¸ªæ¨¡å—ï¼Œæ¥å®ç°å¤æ‚çš„æ¸²æŸ“é€»è¾‘æ“ä½œï¼š</p><ul><li>ä¸€ä¸ªå®æ—¶æ¯16æ¯«ç§’ï¼Œæ˜¾ç¤ºè®¡æ•°ï¼ˆæ¯ç§’å¢åŠ 1ï¼‰çš„ blinker æ¨¡å—ï¼›</li><li>ä¸€ä¸ªå®šæ—¶æ¯500æ¯«ç§’ï¼Œæ›´æ–°èƒŒæ™¯é¢œè‰²çš„ counter æ¨¡å—ï¼›</li><li>ä¸€ä¸ªæ°¸ä¹…å¾€å¤è¿åŠ¨çš„ slider æ¨¡å—ï¼›</li><li>ä¸€ä¸ªæ¯16æ¯«ç§’ç¿»è½¬5åº¦çš„ spinner æ¨¡å—</li></ul><p><img src="http://upload-images.jianshu.io/upload_images/4363003-2c1b80daa49e9530?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="é¡µé¢è¿‡ç¨‹"></p><p>è¿™äº›æ¨¡å—éƒ½å®šæ—¶é¢‘ç¹åœ°æ›´æ–° dom æ ·å¼ï¼Œè¿›è¡Œå¤§é‡å¤æ‚çš„æ¸²æŸ“è®¡ç®—ã€‚æ­£å¸¸æƒ…å†µä¸‹ï¼Œç”±äº JS ä¸»çº¿ç¨‹è¿›è¡ŒN-çš‡åè®¡ç®—ï¼Œè¿™äº›æ¸²æŸ“è¿‡ç¨‹éƒ½å°†è¢«å¡é¡¿ã€‚</p><p>åŒæ—¶ï¼Œæˆ‘è®¾ç½®â€œN-çš‡åé—®é¢˜â€çš„ n å€¼ï¼Œæ¥è§‚å¯Ÿåœ¨è®¡ç®—æ—¶è¿™äº›æ¨¡å—çš„è¡¨ç°ï¼ˆæ˜¯å¦å¡é¡¿ï¼‰ã€‚åœ¨ä¸å¼€å¯ Work çº¿ç¨‹çš„æƒ…å†µä¸‹ï¼Œn è®¾ç½®ä¸º13æ—¶ï¼Œæœ‰ gif å›¾ï¼Œå·¦åŠéƒ¨åˆ†ï¼š</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-13bd10000ade2648?imageMogr2/auto-orient/strip" alt="off.gif"></p><p>æˆ‘ä»¬éå¸¸æ¸…æ™°åœ°çœ‹åˆ°ï¼šç”±äºæµè§ˆå™¨ call stack è¿›è¡Œ n=13 çš„çš‡åé—®é¢˜è®¡ç®—ï¼Œè€Œæ— æ³•â€œæŒ‰æ—¶â€æ¸²æŸ“ï¼Œæ‰€ä»¥é€ æˆäº†è¿™å‡ ä¸ªæ¨¡å—çš„å¡é¡¿ï¼Œè¿™äº›æ¨¡å—éƒ½æ— æ³•æ›´æ–°çŠ¶æ€ã€‚<strong>åœ¨è¿™ä¸ªå¡é¡¿è¿‡ç¨‹ä¸­ï¼Œç”¨æˆ·çš„ä»»ä½•äº‹ä»¶ï¼ˆå¦‚ç‚¹å‡»ï¼Œæ•²é”®ç›˜ç­‰ï¼‰éƒ½æ— æ³•è¢«æµè§ˆå™¨å“åº”ã€‚</strong>è¿™å°±æ˜¯ç”¨æˆ·ä½“ä¼šåˆ°çš„â€œæ…¢â€ï¼</p><p>å¦‚æœæˆ‘æŠŠ n å€¼è®¾ç½®çš„å¤§ä¸13å‘¢ï¼Œæ¯”å¦‚24ï¼Ÿ<br>åƒä¸‡ä¸è¦è¿™ä¹ˆåšï¼å› ä¸ºä½ çš„æµè§ˆå™¨ä¼šè¢«å¡æ­»ï¼æˆ‘ä½¿ç”¨ Mac Pro 8G å†…å­˜æƒ…å†µä¸‹ï¼Œè®¾ç½®åˆ°14ï¼Œæµè§ˆå™¨å°±æ— æ³•å“åº”äº†ã€‚</p><p>åœ¨å¼€å¯ Work çº¿ç¨‹æ—¶ï¼Œè¯·å‚è€ƒä¸Š gif å›¾å³åŠéƒ¨åˆ†ï¼Œå‡ ä¸ªæ¨¡å—çš„æ¸²æŸ“ä¸æ¯«ä¸å—å½±å“ã€‚å®Œç¾è¾¾åˆ°äº†æˆ‘ä»¬çš„ç›®çš„ã€‚</p><p>å› ä¸º Reducer çš„è¶…çº§è€—æ—¶è®¡ç®—è¢«æ”¾å…¥ Worker çº¿ç¨‹å½“ä¸­ï¼Œæ‰€ä»¥ä¸æ¯«æ²¡æœ‰å½±å“æµè§ˆå™¨çš„æ¸²æŸ“å’Œå“åº”ã€‚å®Œå…¨è§£å†³äº†ç”¨æˆ·è§‰å¾—â€œç”µè„‘æ…¢â€çš„é—®é¢˜ã€‚</p><p>çœ‹åˆ°äº†å¦‚æ­¤å®Œç¾çš„å¯¹æ¯”ï¼Œä¹Ÿè®¸ä½ æƒ³é—® Web Worker çš„å…¼å®¹æ€§å¦‚ä½•å‘¢ï¼Ÿ</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-b5c95e172045d809?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å…¼å®¹æ€§"></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å…¶å®ï¼Œè¿™ç¯‡æ–‡ç« çš„æ„ä¹‰å¹¶ä¸åœ¨äºè¿™ä¸ª demo å’Œåº”ç”¨ã€‚è€Œæ˜¯åœ¨å¯å‘ä¸€ç§æ–°çš„æƒ³æ³•çš„åŒæ—¶ï¼Œreview äº†å¾ˆå¤š JS å½“ä¸­å…³é”®æ¦‚å¿µå’ŒåŸºæœ¬çŸ¥è¯†ã€‚æ¯”å¦‚ï¼šå•çº¿ç¨‹å¼‚æ­¥ã€å®¿ä¸»ç¯å¢ƒã€60 fpsã€ä¸€ä¸ªç®—æ³•ç­‰ç­‰ã€‚</p><p>æ›´å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå¦‚æœä½ å»æ·±å…¥ demo ä»£ç ï¼Œä½ æ›´ä¼šå‘ç° Redux è®¾è®¡ç²¾å¦™çš„æ€æƒ³ï¼Œæ¯”å¦‚æˆ‘ä»¬å°† Web Worker çš„åº”ç”¨æŠ½è±¡å‡ºä¸€ä¸ªå…¬å…±åº“ï¼š<strong>Redux-Workerï¼Œå¹¶åŒ…è£…ä¸º Redux çš„ä¸­é—´ä»¶ï¼ˆmiddlewareï¼‰ï¼Œæ‰€æœ‰ React Redux éƒ½å¯ä»¥æ— ä¾µå…¥ï¼Œé‡‡ç”¨ä¸­é—´ä»¶çš„æ€æƒ³ä½¿ç”¨ï¼š</strong></p><pre><code>import { applyWorker } from &apos;redux-worker&apos;;const enhancerWithWorker = compose(    applyMiddleware(thunk, logger),    applyWorker(worker));const store = createStore(rootReducer, {}, enhancerWithWorker);</code></pre><p>å½“ç„¶ï¼ŒRedux-Worker è¿™ä¸ªä¸­é—´ä»¶çš„å®ç°åŸç†æ›´æ˜¯å·§å¦™ï¼Œè¿™é‡Œä¸å†å±•å¼€ã€‚æ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥å‚è€ƒæˆ‘çš„<a href="https://github.com/HOUCe/redux-worker-demo" target="_blank" rel="external">æ­¤é¡¹ç›® Github ä»“åº“ã€‚</a>æˆ‘ fork äº†æ­¤<a href="https://github.com/chikeichan/redux-worker" target="_blank" rel="external">åº“æºç </a>ï¼Œå¹¶åœ¨æ ¸å¿ƒé€»è¾‘åŠ å…¥äº†ä¸­æ–‡æ³¨é‡Šï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥å…³æ³¨ã€‚</p><p> <strong>æˆ‘çš„å…¶ä»–å…³äº React æ–‡ç« ï¼š</strong></p><ul><li><a href="https://zhuanlan.zhihu.com/p/27825741" target="_blank" rel="external">é€šè¿‡å®ä¾‹ï¼Œå­¦ä¹ ç¼–å†™ React ç»„ä»¶çš„â€œæœ€ä½³å®è·µâ€</a><ul><li><a href="https://zhuanlan.zhihu.com/p/27727292" target="_blank" rel="external">React ç»„ä»¶è®¾è®¡å’Œåˆ†è§£æ€è€ƒ</a></li><li><a href="">ä» React ç»‘å®š thisï¼Œçœ‹ JS è¯­è¨€å‘å±•å’Œæ¡†æ¶è®¾è®¡</a></li></ul></li><li><a href="https://zhuanlan.zhihu.com/p/28004982" target="_blank" rel="external">React æœåŠ¡ç«¯æ¸²æŸ“å¦‚æ­¤è½»æ¾ ä»é›¶å¼€å§‹æ„å»ºå‰åç«¯åº”ç”¨</a></li><li><a href="http://www.jianshu.com/p/49029b49f2b4" target="_blank" rel="external">åšå‡ºUberç§»åŠ¨ç½‘é¡µç‰ˆè¿˜ä¸å¤Ÿ æè‡´æ€§èƒ½æ‰“é€ æ‰è§çœŸç« </a></li><li><a href="http://www.jianshu.com/p/7a56ac1de2a8" target="_blank" rel="external">è§£æTwitterå‰ç«¯æ¶æ„ å­¦ä¹ å¤æ‚åœºæ™¯æ•°æ®è®¾è®¡</a></li><li><a href="http://www.jianshu.com/p/83c86dd0802d" target="_blank" rel="external">React Conf 2017 å¹²è´§æ€»ç»“1: React + ES next = â™¥</a></li><li><a href="http://www.jianshu.com/p/cde3cf7e2760" target="_blank" rel="external">React+Reduxæ‰“é€ â€œNEWS EARLYâ€å•é¡µåº”ç”¨ ä¸€ä¸ªé¡¹ç›®ç†è§£æœ€å‰æ²¿æŠ€æœ¯æ ˆçœŸè°›</a></li><li><a href="http://www.jianshu.com/p/8e28be0e7ab1" target="_blank" rel="external">ä¸€ä¸ªreact+reduxå·¥ç¨‹å®ä¾‹</a></li></ul><p>Happy Coding!</p><p>PS:<br>ä½œè€…<a href="https://github.com/HOUCe" target="_blank" rel="external">Githubä»“åº“</a> å’Œ <a href="https://www.zhihu.com/people/lucas-hc/answers" target="_blank" rel="external">çŸ¥ä¹é—®ç­”é“¾æ¥</a><br>æ¬¢è¿å„ç§å½¢å¼äº¤æµã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;å†™åœ¨æœ€å‰&quot;&gt;&lt;a href=&quot;#å†™åœ¨æœ€å‰&quot; class=&quot;headerlink&quot; title=&quot;å†™åœ¨æœ€å‰&quot;&gt;&lt;/a&gt;å†™åœ¨æœ€å‰&lt;/h2&gt;&lt;p&gt;åŸæ–‡é¦–å‘äºä½œè€…çš„çŸ¥ä¹ä¸“æ ï¼š&lt;a href=&quot;https://zhuanlan.zhihu.com/p/28525821&quot; t
      
    
    </summary>
    
      <category term="js" scheme="https://exp-team.github.io/categories/js/"/>
    
    
      <category term="js" scheme="https://exp-team.github.io/tags/js/"/>
    
  </entry>
  
  <entry>
    <title>JSå†»ç»“å¯¹è±¡çš„ã€Šäººé—´è¯è¯ã€‹ å®Œç¾å®ç°ç©¶ç«Ÿæœ‰å‡ å±‚å¢ƒç•Œï¼Ÿ</title>
    <link href="https://exp-team.github.io/blog/2017/11/04/js/freeze/"/>
    <id>https://exp-team.github.io/blog/2017/11/04/js/freeze/</id>
    <published>2017-11-03T16:00:00.000Z</published>
    <updated>2017-11-05T02:47:30.000Z</updated>
    
    <content type="html"><![CDATA[<p>ç‹å›½ç»´åœ¨ã€Šäººé—´è¯è¯ã€‹é‡Œè°ˆåˆ°äº†æ²»å­¦ç»éªŒï¼Œä»–è¯´ï¼šâ€œå¤ä»Šä¹‹æˆå¤§äº‹ä¸šã€å¤§å­¦é—®è€…ï¼Œå¿…ç»è¿‡ä¸‰ç§ä¹‹å¢ƒç•Œã€‚â€</p><p>å·§åˆçš„æ˜¯ï¼Œæœ€è¿‘å— <a href="http://gitbook.cn/" target="_blank" rel="external">git chat ï¼ git book</a> é‚€è¯·ï¼Œåšäº†ä¸€ä¸ªåˆ†äº«ã€‚<br>å…¶ä¸­è°ˆåˆ°JSä¸­å†»ç»“ä¸€ä¸ªå¯¹è±¡å‡ ç§ç”±æµ…å…¥æ·±çš„å®è·µã€‚æƒ³æƒ³ä¹Ÿæš—åˆå›½å­¦å¤§å¸ˆæ‰€è°“çš„ä¸‰é‡å¢ƒç•Œã€‚ å…·ä½“åˆ†äº«å†…å®¹ï¼Œè¿˜æ²¡æœ‰ä¸Šè½¦çš„åŒå­¦ä»¬å¯ä»¥<a href="http://gitbook.cn/m/mazi/article/59115363b55ad30f704c0252?isLogArticle=yes&amp;readArticle=yes" target="_blank" rel="external">ç‚¹å‡»è¿™é‡Œï¼Œå‚çœ‹å®å½•ã€‚æ¬¢è¿ä¸€èµ·è®¨è®ºã€‚</a>ç›¸å…³æ–‡ç« ï¼Œ<a href="http://gitbook.cn/books/5919ab35c370474b2fa23006/index.html" target="_blank" rel="external">ç‚¹å‡»è¿™é‡Œä¹Ÿå¯ä»¥æŸ¥çœ‹ã€‚</a></p><p>è¿™ç¯‡æ–‡ç« ç”±æµ…å…¥æ·±è®¨è®ºJSä¸­å¯¹è±¡çš„ä¸€äº›é”å®šç‰¹æ€§ã€‚ä½†éƒ½æ˜¯ä¸€äº›åŸºç¡€è¯­æ³•çš„å®ç°ï¼Œç›¸ä¿¡å³ä¾¿æ˜¯å‰ç«¯å°ç™½ä¹Ÿå¯ä»¥å¤§ä½“é¢†ä¼šã€‚ä¸è¿‡éœ€è¦è¯»è€…é¢„å…ˆäº†è§£JSä¸­å¯¹è±¡çš„ç‰¹æ€§ï¼Œå°¤å…¶æ˜¯å¯¹è±¡è‡ªèº«å±æ€§çš„æè¿°ç¬¦ï¼šconfigurableã€writableâ€¦</p><p>å¦å¤–ï¼Œå¦‚æœæ‚¨å¯¹JSä¸­å¯¹è±¡æ“ä½œã€ä¸å¯å˜æ•°æ®ã€å‡½æ•°å¼ç¼–ç¨‹æ„Ÿå…´è¶£ï¼ŒåŒæ ·æ¨èæˆ‘çš„å…¶ä»–ä¸€äº›ç›¸å…³æ–‡ç« ï¼š</p><ul><li><a href="http://www.jianshu.com/p/11fc75f28302" target="_blank" rel="external">å¦‚ä½•ä¼˜é›…å®‰å…¨åœ°åœ¨æ·±å±‚æ•°æ®ç»“æ„ä¸­å–å€¼</a></li><li><a href="http://www.jianshu.com/p/89f1d4245b20" target="_blank" rel="external">ä»JSå¯¹è±¡å¼€å§‹ï¼Œè°ˆä¸€è°ˆâ€œä¸å¯å˜æ•°æ®â€å’Œå‡½æ•°å¼ç¼–ç¨‹</a></li><li><a href="http://www.jianshu.com/p/7a56ac1de2a8" target="_blank" rel="external">è§£æTwitterå‰ç«¯æ¶æ„ å­¦ä¹ å¤æ‚åœºæ™¯æ•°æ®è®¾è®¡</a></li></ul><p>ç­‰ç­‰ã€‚</p><h2 id="æ˜¨å¤œè¥¿é£å‡‹ç¢§æ ‘-ç‹¬ä¸Šé«˜æ¥¼-æœ›å°½å¤©æ¶¯è·¯"><a href="#æ˜¨å¤œè¥¿é£å‡‹ç¢§æ ‘-ç‹¬ä¸Šé«˜æ¥¼-æœ›å°½å¤©æ¶¯è·¯" class="headerlink" title="æ˜¨å¤œè¥¿é£å‡‹ç¢§æ ‘ ç‹¬ä¸Šé«˜æ¥¼ æœ›å°½å¤©æ¶¯è·¯"></a>æ˜¨å¤œè¥¿é£å‡‹ç¢§æ ‘ ç‹¬ä¸Šé«˜æ¥¼ æœ›å°½å¤©æ¶¯è·¯</h2><p>ç¬¬ä¸€ç§å¢ƒç•Œï¼šâ€œæ˜¨å¤œè¥¿é£å‡‹ç¢§æ ‘ï¼Œç‹¬ä¸Šé«˜æ¥¼ï¼Œæœ›å°½å¤©æ¶¯è·¯ã€‚â€<br>è¯¥è¯å¥å‡ºè‡ªæ™æ®Šçš„ã€Šè¶æ‹èŠ±ã€‹ï¼ŒåŸæ„æ˜¯è¯´ï¼Œâ€œæˆ‘â€ä¸Šé«˜æ¥¼çœºæœ›æ‰€è§çš„æ›´ä¸ºè§é£’çš„ç§‹æ™¯ï¼Œè¥¿é£é»„å¶ï¼Œå±±é˜”æ°´é•¿ï¼Œæ¡ˆä¹¦ä½•è¾¾ï¼Ÿ</p><p>ç‹å›½ç»´æ­¤å¥ä¸­è§£æˆï¼šåšå­¦é—®æˆå¤§äº‹ä¸šè€…ï¼Œé¦–å…ˆè¦æœ‰æ‰§ç€çš„è¿½æ±‚ï¼Œç™»é«˜æœ›è¿œï¼Œç°å¯Ÿè·¯å¾„ï¼Œæ˜ç¡®ç›®æ ‡ä¸æ–¹å‘ï¼Œäº†è§£äº‹ç‰©çš„æ¦‚è²Œã€‚</p><p> <strong>æˆ‘ä»¬å°±ä»æœ€åŸºæœ¬çš„åœºæ™¯è¯´èµ·ï¼Œç©¶ç«Ÿä¸ºä»€ä¹ˆè¦å†»ç»“ä¸€ä¸ªå¯¹è±¡ï¼Ÿ</strong></p><ul><li><p>åœºæ™¯ä¸€ï¼š<br>æˆ‘ä»¬é€ äº†ä¸€ä¸ªè½®å­ï¼Œå¯¹å¤–æš´éœ²ä¸€ä¸ªå¯¹è±¡ï¼Œå¼€æ”¾å‡ºæ¥ç»™ç¬¬ä¸‰æ–¹ä½¿ç”¨ã€‚åŒæ—¶éœ€è¦ä¿è¯è¿™ä¸ªå¯¹å¤–æš´éœ²çš„å¯¹è±¡å®Œå…¨å®‰å…¨ï¼Œä¸èƒ½è¢«ä¸šåŠ¡ä»£ç æ‰€æ”¹å†™è¦†ç›–æˆ–ä¸‹é’©å­ï¼ˆhookï¼‰å‡½æ•°ã€‚</p></li><li><p>åœºæ™¯äºŒï¼š<br>å¦‚æœä½ çœ‹è¿‡Vue 2.* ç‰ˆæœ¬æºç ï¼Œä½ ä¼šå‘ç°å†»ç»“ä¸€ä¸ªå¯¹è±¡çš„æ“ä½œé¢‘ç¹å‡ºç°ã€‚</p></li></ul><p><strong>æˆ‘ä»¬å…ˆæ¥çœ‹å†»ç»“å¯¹è±¡çš„ç¬¬ä¸€å±‚å®ç° â€”â€” æ‰©å±•ç‰¹æ€§é”ï¼š</strong></p><p>ä»–åŒ…å«äº†ä¸¤ä¸ªåŸºæœ¬æ–¹æ³•ï¼š</p><ul><li>Object.isExtensible</li><li>Object.preventExtensions</li></ul><p>å¦‚æœä¸€ä¸ªå¯¹è±¡å¯ä»¥æ·»åŠ æ–°çš„å±æ€§ï¼Œåˆ™è¿™ä¸ªå¯¹è±¡æ˜¯å¯æ‰©å±•çš„ã€‚æ‰©å±•ç‰¹æ€§é”å°±æ˜¯è®©è¿™ä¸ªå¯¹è±¡å˜çš„ä¸å¯æ‰©å±•ï¼Œä¹Ÿå°±æ˜¯ä¸èƒ½å†æœ‰æ–°çš„å±æ€§ã€‚</p><h3 id="Object-isExtensible"><a href="#Object-isExtensible" class="headerlink" title="Object.isExtensible"></a>Object.isExtensible</h3><p>MDNä¸Šå†…å®¹æ¦‚è¿°ï¼š</p><pre><code>æ¦‚è¿°    Object.isExtensible() æ–¹æ³•åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯å¯æ‰©å±•çš„ï¼ˆæ˜¯å¦å¯ä»¥åœ¨å®ƒä¸Šé¢æ·»åŠ æ–°çš„å±æ€§ï¼‰ã€‚è¯­æ³•    Object.isExtensible(obj)å‚æ•°    obj éœ€è¦æ£€æµ‹çš„å¯¹è±¡</code></pre><p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬æ­£å¸¸ä½¿ç”¨å¯¹è±¡å­—é¢é‡å£°æ˜çš„å¯¹è±¡éƒ½æ˜¯å¯æ‰©å±•çš„ï¼š</p><pre><code>var person1 = {};person1.name = &quot;Lucas&quot;;console.log(person1);// {name: &quot;Lucas&quot;}</code></pre><p>åŒæ—¶ï¼š</p><pre><code>Object.isExtensible(person1) === true; // true</code></pre><p>ä½ å¯èƒ½è¦é—®äº†ï¼Œé‚£ä¹ˆä½¿ç”¨Object.createæ–¹æ³•å£°æ˜çš„å¯¹è±¡ï¼Œå¹¶å¯¹è¯¥å¯¹è±¡å±æ€§è¿›è¡Œé…ç½®æ˜¯ä»€ä¹ˆæƒ…å†µå‘¢ï¼Ÿ<br>æˆ‘ä»¬çŸ¥é“ï¼Œç”¨ä¸Šé¢å¯¹è±¡å­—é¢é‡å£°æ˜çš„å¯¹è±¡ç›¸å½“äºï¼š</p><pre><code>var person1 = Object.create({},{    &quot;name&quot;:{        value : &quot;Lucas&quot;,        configurable : true, //å¯é…ç½®        enumerable : true , //å¯æšä¸¾        writable : true //å¯å†™    }});</code></pre><p>å³ä¾¿å°è¯•å°†configurableè®¾ç½®ä¸ºfalse:</p><pre><code>var person1 = Object.create({},{    &quot;name&quot;:{        value : &quot;Lucas&quot;,        configurable : false, //ä¸å¯é…ç½®        enumerable : true, //å¯æšä¸¾        writable : true //å¯å†™    }});</code></pre><p>ä»ç„¶å¾—åˆ°ï¼š</p><pre><code>Object.isExtensible(person1) === true; // true</code></pre><h2 id="Object-preventExtensions"><a href="#Object-preventExtensions" class="headerlink" title="Object.preventExtensions"></a>Object.preventExtensions</h2><p>å½“ç„¶ï¼Œæˆ‘ä»¬è¿˜æ˜¯æœ‰æ–¹æ³•å¯ä»¥ä½¿å¾—ä¸€ä¸ªå¯¹è±¡å˜çš„ä¸å¯æ‰©å±•ã€‚</p><p>MDNä¸Šå†…å®¹æ¦‚è¿°ï¼š</p><pre><code>æ¦‚è¿°    Object.preventExtensions() æ–¹æ³•è®©ä¸€ä¸ªå¯¹è±¡å˜çš„ä¸å¯æ‰©å±•ï¼Œä¹Ÿå°±æ˜¯æ°¸è¿œä¸èƒ½å†æ·»åŠ æ–°çš„å±æ€§ã€‚è¯­æ³•    Object.preventExtensions(obj)å‚æ•°    obj å°†è¦å˜å¾—ä¸å¯æ‰©å±•çš„å¯¹è±¡</code></pre><p>å‡ ä¸ªæ³¨æ„ç‚¹åŒ…æ‹¬ä½†ä¸é™äºï¼š</p><ul><li>ä¸å¯æ‰©å±•çš„å¯¹è±¡çš„å±æ€§é€šå¸¸<strong>ä»ç„¶å¯ä»¥è¢«åˆ é™¤ã€‚</strong></li><li>å°è¯•ç»™ä¸€ä¸ªä¸å¯æ‰©å±•å¯¹è±¡æ·»åŠ æ–°å±æ€§çš„æ“ä½œå°†ä¼šå¤±è´¥ï¼Œä¸è¿‡<strong>å¯èƒ½æ˜¯é™é»˜å¤±è´¥ï¼Œä¹Ÿå¯èƒ½ä¼šæŠ›å‡º TypeError å¼‚å¸¸</strong>ï¼ˆä¸¥æ ¼æ¨¡å¼ä¸‹ï¼‰ã€‚</li><li>Object.preventExtensions åªèƒ½é˜»æ­¢ä¸€ä¸ªå¯¹è±¡ä¸èƒ½å†æ·»åŠ æ–°çš„è‡ªèº«å±æ€§ï¼Œ<strong>ä»ç„¶å¯ä»¥ä¸ºè¯¥å¯¹è±¡çš„åŸå‹æ·»åŠ å±æ€§ã€‚</strong></li></ul><p>æ¯”å¦‚ï¼š</p><pre><code>var person1 = {    name: &quot;Lucas&quot;}Object.preventExtensions(person1);person1.age = 18;// éä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œè¿™é‡Œä¸ä¼šæœ‰æŠ¥é”™ï¼Œå±äºé™é»˜å¤±è´¥person1.age // undefined// æ‰©å±•æ–°å±æ€§å¤±è´¥äº†</code></pre><p>ä»ç„¶å¯ä»¥å‘åŸå‹é“¾æ·»åŠ å±æ€§ï¼š</p><pre><code>person1.__proto__.age = 18;person1.age // 18// å¯ä»¥ä»åŸå‹é“¾ä¸Šå–åˆ°</code></pre><p>åŒæ ·ä¹Ÿå¯ä»¥å¤å†™ä¸€äº›å±æ€§ï¼š</p><pre><code>person1.name = &quot;Eros&quot;;person1.name // &quot;Eros&quot;</code></pre><p>ä¹Ÿå¯ä»¥åˆ é™¤å·²æœ‰å±æ€§ï¼š</p><pre><code>person1.name; //  &quot;Eros&quot;,delete person1.name;person1.name; // undefined</code></pre><p>é€šè¿‡ä»¥ä¸Šæ–¹æ³•ï¼Œæˆ‘ä»¬å®ç°äº†å¯¹ä¸€ä¸ªå¯¹è±¡å±æ€§æ‰©å±•çš„å†»ç»“ã€‚ä½†æ˜¯åŒæ ·ä¹Ÿè®¤è¯†åˆ°ï¼Œè¿™å¹¶ä¸æ˜¯å…¨é¢çš„ä¿æŠ¤ï¼šä¾‹å¦‚å¯ä»¥éšæ„æ”¹åŠ¨å»è¦†ç›–å·²æœ‰å±æ€§ï¼Œåœ¨å¯¹è±¡åŸå‹é“¾ä¸Šå¢åŠ å±æ€§ä¹Ÿè¿˜æ˜¯éš¾ä»¥å±è”½ã€‚</p><h2 id="è¡£å¸¦æ¸å®½ç»ˆä¸æ‚”-ä¸ºä¼Šæ¶ˆå¾—äººæ†”æ‚´"><a href="#è¡£å¸¦æ¸å®½ç»ˆä¸æ‚”-ä¸ºä¼Šæ¶ˆå¾—äººæ†”æ‚´" class="headerlink" title="è¡£å¸¦æ¸å®½ç»ˆä¸æ‚” ä¸ºä¼Šæ¶ˆå¾—äººæ†”æ‚´"></a>è¡£å¸¦æ¸å®½ç»ˆä¸æ‚” ä¸ºä¼Šæ¶ˆå¾—äººæ†”æ‚´</h2><p>ç¬¬äºŒç§å¢ƒç•Œï¼šâ€œè¡£å¸¦æ¸å®½ç»ˆä¸æ‚”ï¼Œä¸ºä¼Šæ¶ˆå¾—äººæ†”æ‚´ã€‚â€<br>è¿™å¼•ç”¨çš„æ˜¯åŒ—å®‹æŸ³æ°¸ã€Šè¶æ‹èŠ±ã€‹æœ€åä¸¤å¥è¯ï¼ŒåŸè¯æ˜¯è¡¨ç°ä½œè€…å¯¹çˆ±çš„è‰°è¾›å’Œçˆ±çš„æ— æ‚”ã€‚è‹¥æŠŠâ€œä¼Šâ€å­—ç†è§£ä¸ºè¯äººæ‰€è¿½æ±‚çš„ç†æƒ³å’Œæ¯•ç”Ÿä»äº‹çš„äº‹ä¸šï¼Œäº¦æ— ä¸å¯ã€‚ç‹å›½ç»´åˆ™åˆ«æœ‰ç”¨å¿ƒï¼Œä»¥æ­¤ä¸¤å¥æ¥æ¯”å–»æˆå¤§äº‹ä¸šã€å¤§å­¦é—®è€…ï¼Œä¸æ˜¯è½»è€Œæ˜“ä¸¾ï¼Œéšä¾¿å¯å¾—çš„ï¼Œå¿…é¡»åšå®šä¸ç§»ï¼Œç»è¿‡ä¸€ç•ªè¾›å‹¤åŠ³åŠ¨ï¼ŒåºŸå¯å¿˜é£Ÿï¼Œå­œå­œä»¥æ±‚ï¼Œç›´è‡³äººç˜¦å¸¦å®½ä¹Ÿä¸åæ‚”ã€‚</p><p><strong>ä¸‹é¢ä»‹ç»ä¸€ä¸ªæ›´æ·±ä¸€å±‚çš„åšæ³•ï¼šå¯†å°ç‰¹æ€§ã€‚</strong></p><p>å¯†å°å¯¹è±¡æ˜¯æŒ‡é‚£äº›ä¸èƒ½æ·»åŠ æ–°çš„å±æ€§ï¼Œä¸èƒ½åˆ é™¤å·²æœ‰å±æ€§ï¼Œä»¥åŠä¸èƒ½ä¿®æ”¹å·²æœ‰å±æ€§çš„å¯æšä¸¾æ€§ï¼ˆenumerableï¼‰ã€å¯é…ç½®æ€§ï¼ˆconfigurableï¼‰ã€å¯å†™æ€§ï¼ˆwritableï¼‰ï¼Œä½†<strong>å¯èƒ½å¯ä»¥ä¿®æ”¹å·²æœ‰å±æ€§çš„å€¼çš„å¯¹è±¡ã€‚</strong></p><p>ä»–åŒæ ·åŒ…å«äº†ä¸¤ä¸ªåŸºæœ¬æ–¹æ³•ï¼š</p><ul><li>Object.isSealed</li><li>Object.seal</li></ul><h3 id="Object-isSealed"><a href="#Object-isSealed" class="headerlink" title="Object.isSealed"></a>Object.isSealed</h3><p>MDNä¸Šå†…å®¹æ¦‚è¿°ï¼š</p><pre><code>æ¦‚è¿°     Object.isSealed() æ–¹æ³•åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯å¯†å°çš„ï¼ˆsealedï¼‰ã€‚è¯­æ³•     Object.isSealed(obj)å‚æ•°    obj å°†è¦æ£€æµ‹çš„å¯¹è±¡</code></pre><p>æ­£å¸¸å¯¹è±¡å­—é¢é‡å£°æ˜çš„å¯¹è±¡æ˜¯ä¸è¢«å¯†å°çš„ï¼š</p><pre><code>var person1 = {    name: &quot;Lucas&quot;}Object.isSealed(person1); // false</code></pre><p>å½“å°†è¿™ä¸ªå¯¹è±¡ç¦æ­¢æ‰©å±•æ—¶ï¼Œå®ƒä¹Ÿä¸ä¼šå˜æˆå¯†å°çš„ï¼š</p><pre><code>var person1 = {    name: &quot;Lucas&quot;}Object.preventExtensions(person1);Object.isSealed(person1); // false</code></pre><p>ä½†æ˜¯åœ¨æ­¤åŸºç¡€ä¸Šï¼Œä½¿ç”¨Object.definePropertyæ–¹æ³•ï¼ŒæŠŠå±æ€§å˜å¾—ä¸å¯é…ç½®ï¼ˆconfigurableï¼‰ï¼Œåˆ™è¿™ä¸ªå¯¹è±¡ä¹Ÿå°±æˆäº†å¯†å°å¯¹è±¡ï¼š</p><pre><code>var person1 = {    name: &quot;Lucas&quot;}Object.defineProperty(person1, &quot;name&quot;, {configurable : false});Object.isSealed(person1); // true</code></pre><p>æ­¤æ—¶ï¼Œæˆ‘ä»¬æœ‰ï¼š</p><pre><code>Object.getOwnPropertyDescriptor(person1, &apos;name&apos;);// å¾—åˆ°ï¼šObject {    value: &quot;Lucas&quot;,     writable: true,     enumerable: true,     configurable: false}</code></pre><p>æ ¹æ®è¿™ä¸ªgetOwnPropertyDescriptorï¼Œæˆ‘ä»¬å¯ä»¥æ›´åŠ æ·±å…¥çš„ç†è§£å¯†å°ç‰¹æ€§ï¼šè¢«å¯†å°çš„å¯¹è±¡ï¼Œå°±æ˜¯åœ¨ä¸å¯æ‰©å±•åŸºç¡€ä¸Šè®²å±æ€§æè¿°ç¬¦configurableè®¾ç½®ä¸ºfalse; åŒæ—¶ï¼Œ<strong>è¢«å¯†å°çš„å¯¹è±¡ï¼Œä»ç„¶æœ‰æœºä¼šæ”¹å˜å±æ€§çš„å€¼ã€‚</strong>åªä¸è¿‡å¯¹äºæ­¤å¯¹è±¡æœ¬èº«è€Œè¨€ï¼Œ<strong>ä¸å¯ä»¥å†æ‰©å±•æ–°çš„å±æ€§ï¼Œä¸å¯ä»¥æ›´æ”¹å·²æœ‰å±æ€§çš„é…ç½®ä¿¡æ¯ã€‚</strong></p><h3 id="Object-seal"><a href="#Object-seal" class="headerlink" title="Object.seal"></a>Object.seal</h3><p>ç›¸å¯¹åº”æˆ‘ä»¬ä¹Ÿæœ‰ä¸€ä¸ªæ–¹æ³•å°†ä¸€ä¸ªå¯¹è±¡å¯†å°ã€‚</p><p>MDNä¸Šå†…å®¹æ¦‚è¿°ï¼š</p><pre><code>æ¦‚è¿°    Object.seal() æ–¹æ³•å¯ä»¥è®©ä¸€ä¸ªå¯¹è±¡å¯†å°ï¼Œå¹¶è¿”å›è¢«å¯†å°åçš„å¯¹è±¡ã€‚è¯­æ³•    Object.seal(obj)å‚æ•°    obj å°†è¦è¢«å¯†å°çš„å¯¹è±¡</code></pre><p>æ¯”å¦‚ï¼š</p><pre><code>var person1 = {    name: &quot;Lucas&quot;}Object.getOwnPropertyDescriptor(person1, &apos;name&apos;);// å¾—åˆ°ï¼šObject {    value: &quot;Lucas&quot;,     writable: true,     enumerable: true,     configurable: true}</code></pre><p>å°†æ­¤å¯¹è±¡å¯†å°åï¼š</p><pre><code>Object.seal(person1);Object.getOwnPropertyDescriptor(person1, &apos;name&apos;);// å¾—åˆ°ï¼šObject {    value: &quot;Lucas&quot;,     writable: true,     enumerable: true,     configurable: false}</code></pre><p>ä¹Ÿå°±æ˜¯è¯´ï¼š</p><pre><code>person1.age = 18;person1.age; // undefined// æ‰©å±•æ–°å±æ€§å¤±è´¥// åŒæ—¶è°ƒç”¨definePropertyå¤±è´¥Object.defineProperty(person1,&quot;name&quot;,{get : function(){return &quot;g&quot;;}});// æŠ›å‡ºå¼‚å¸¸</code></pre><p>ä»»ä½•é™¤æ›´æ”¹å±æ€§å€¼ä»¥å¤–çš„æ“ä½œï¼Œéä¸¥æ ¼æ¨¡å¼ä¸‹éƒ½ä¼šé™é»˜å¤±è´¥ï¼Œå¦‚ä¸Šå¹¶å¦‚ä¸‹ï¼š</p><pre><code>delete person1.name;person1.name; // &quot;Lucas&quot;</code></pre><p>è€Œæ›´æ”¹å±æ€§å€¼å¯ä»¥æˆåŠŸï¼š</p><pre><code>person1.name = &quot;Eros&quot;;person1.name; // &quot;Eros&quot;</code></pre><p>æ€ä¹ˆç†è§£è¿™æ ·çš„ç°è±¡å‘¢ï¼Ÿç‰¢è®°ï¼Œè¢«å¯†å°çš„å¯¹è±¡æ‹¥æœ‰å¦‚ä¸‹çš„å±æ€§æè¿°ç¬¦ï¼š</p><pre><code>Object {    value: &quot;Lucas&quot;,     writable: true,     enumerable: true,     configurable: false}</code></pre><p><strong>è€Œåˆ é™¤å±æ€§å±äºconfigurableï¼Œæ›´æ”¹å±æ€§æ‰å±äºwritableï¼›</strong></p><h3 id="ä¸€ç‚¹å»¶ä¼¸"><a href="#ä¸€ç‚¹å»¶ä¼¸" class="headerlink" title="ä¸€ç‚¹å»¶ä¼¸"></a>ä¸€ç‚¹å»¶ä¼¸</h3><p>å€ŸåŠ©äºæ­¤ï¼Œæˆ‘ä»¬å…¶å®å·²ç»å¯ä»¥å®Œæˆå†»ç»“å¯¹è±¡çš„ç¬¬ä¸‰é‡å¢ƒç•Œï¼šè¾¾åˆ°å³å¯†å°åˆä¸å¯ä¿®æ”¹åŸå±æ€§å€¼ã€‚å› ä¸ºå¯ä»¥è¿™æ ·åšï¼š</p><pre><code>var person1 = {name: &quot;Lucas&quot;};Object.defineProperty(person1, &quot;name&quot;, {configurable: false, writable: false});Object.preventExtensions(person1);</code></pre><p>æ€»ç»“ä¸‹å°±æ˜¯è®¾ç½®ï¼š</p><blockquote><p>configurable: false ï¼‹ writable: false ï¼‹ preventExtensions</p></blockquote><p>æˆ–è€…å› ä¸º</p><blockquote><p>configurable: falseï¼‹ preventExtensions ï¼ seal</p></blockquote><p>æ‰€ä»¥ä¹Ÿå¯ä»¥è®¾ç½®ï¼š</p><blockquote><p>seal + writable: false</p></blockquote><h2 id="ä¼—é‡Œå¯»ä»–åƒç™¾åº¦ï¼Œè“¦ç„¶å›é¦–ï¼Œé‚£äººå´åœ¨ï¼Œç¯ç«é˜‘çŠå¤„"><a href="#ä¼—é‡Œå¯»ä»–åƒç™¾åº¦ï¼Œè“¦ç„¶å›é¦–ï¼Œé‚£äººå´åœ¨ï¼Œç¯ç«é˜‘çŠå¤„" class="headerlink" title="ä¼—é‡Œå¯»ä»–åƒç™¾åº¦ï¼Œè“¦ç„¶å›é¦–ï¼Œé‚£äººå´åœ¨ï¼Œç¯ç«é˜‘çŠå¤„"></a>ä¼—é‡Œå¯»ä»–åƒç™¾åº¦ï¼Œè“¦ç„¶å›é¦–ï¼Œé‚£äººå´åœ¨ï¼Œç¯ç«é˜‘çŠå¤„</h2><p>ç¬¬ä¸‰ç§å¢ƒç•Œï¼šâ€œä¼—é‡Œå¯»ä»–åƒç™¾åº¦ï¼Œè“¦ç„¶å›é¦–ï¼Œé‚£äººå´åœ¨ï¼Œç¯ç«é˜‘çŠå¤„ã€‚â€<br>è¿™æ˜¯å¼•ç”¨å—å®‹è¾›å¼ƒç–¾ã€Šé’ç‰æ¡ˆã€‹è¯ä¸­çš„æœ€åå››å¥ã€‚æ¢å¯è¶…ç§°æ­¤è¯â€œè‡ªæ€œå¹½ç‹¬ï¼Œä¼¤å¿ƒäººåˆ«æœ‰æ€€æŠ±â€ã€‚è¿™æ˜¯å€Ÿè¯å–»äº‹ï¼Œä¸æ–‡å­¦èµæå·²æ— äº¤æ¶‰ã€‚ç‹å›½ç»´å·²å…ˆè‡ªè¡¨æ˜ï¼Œâ€œå¾äººå¯ä»¥æ— åŠ³çº è‘›â€ã€‚ä»–ä»¥æ­¤è¯æœ€åçš„å››å¥ä¸ºâ€œå¢ƒç•Œâ€ä¹‹ç¬¬ä¸‰ï¼Œå³æœ€ç»ˆæœ€é«˜å¢ƒç•Œã€‚</p><p>è¿™è™½ä¸æ˜¯è¾›å¼ƒç–¾çš„åŸæ„ï¼Œä½†ä¹Ÿå¯ä»¥å¼•å‡ºæ‚ æ‚ çš„è¿œæ„ï¼šåšå­¦é—®ã€æˆå¤§äº‹ä¸šè€…ï¼Œè¦è¾¾åˆ°ç¬¬ä¸‰å¢ƒç•Œï¼Œå¿…é¡»æœ‰ä¸“æ³¨çš„ç²¾ç¥ã€‚åå¤è¿½å¯»ã€ç ”ç©¶ï¼Œä¸‹è¶³åŠŸå¤«ï¼Œè‡ªç„¶ä¼šè±ç„¶è´¯é€šï¼Œæœ‰æ‰€å‘ç°ï¼Œæœ‰æ‰€å‘æ˜ï¼Œå°±èƒ½å¤Ÿä»å¿…ç„¶ç‹å›½è¿›å…¥è‡ªç”±ç‹å›½ã€‚</p><p>ä¸Šè¾¹é‚£ç§å†»ç»“å¯¹è±¡çš„æ–¹æ³•ï¼Œå…¶å®ä¹Ÿæœ‰åŸç”Ÿå®ç°ï¼Œå¯è°“ï¼šâ€œä¼—é‡Œå¯»ä»–åƒç™¾åº¦ï¼Œè“¦ç„¶å›é¦–ï¼Œé‚£äººå´åœ¨ï¼Œç¯ç«é˜‘çŠå¤„â€</p><p>æˆ‘ä»¬è¿™é‡Œæ‰€è¯´çš„ä¸€ä¸ªå¯¹è±¡çš„å†»ç»“ï¼ˆfrozenï¼‰æ˜¯æŒ‡å®ƒä¸å¯æ‰©å±•ï¼Œæ‰€æœ‰å±æ€§éƒ½æ˜¯ä¸å¯é…ç½®çš„ï¼ˆnon-configurableï¼‰ï¼Œä¸”æ‰€æœ‰æ•°æ®å±æ€§ï¼ˆdata propertiesï¼‰éƒ½æ˜¯ä¸å¯å†™çš„ï¼ˆnon-writableï¼‰ã€‚</p><p>æˆ–è€…è¯´ï¼Œå†»ç»“å¯¹è±¡æ˜¯æŒ‡é‚£äº›ä¸èƒ½æ·»åŠ æ–°çš„å±æ€§ï¼Œä¸èƒ½ä¿®æ”¹å·²æœ‰å±æ€§çš„å€¼ï¼Œä¸èƒ½åˆ é™¤å·²æœ‰å±æ€§ï¼Œä»¥åŠä¸èƒ½ä¿®æ”¹å·²æœ‰å±æ€§çš„å¯æšä¸¾æ€§ã€å¯é…ç½®æ€§ã€å¯å†™æ€§çš„å¯¹è±¡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªå¯¹è±¡æ°¸è¿œæ˜¯ä¸å¯å˜çš„ã€‚</p><p>åŒæ ·ï¼ŒåŒ…å«äº†ä¸¤ä¸ªåŸºæœ¬æ–¹æ³•ï¼š</p><ul><li>Object.isFrozen</li><li>Object.freeze</li></ul><h3 id="Object-isFrozen"><a href="#Object-isFrozen" class="headerlink" title="Object.isFrozen"></a>Object.isFrozen</h3><p>MDNä¸Šå†…å®¹æ¦‚è¿°ï¼š</p><pre><code>æ¦‚è¿°    Object.isFrozen() æ–¹æ³•åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦è¢«å†»ç»“ï¼ˆfrozenï¼‰ã€‚è¯­æ³•    Object.isFrozen(obj)å‚æ•°    obj è¢«æ£€æµ‹çš„å¯¹è±¡</code></pre><h3 id="Object-freeze-æ–¹æ³•"><a href="#Object-freeze-æ–¹æ³•" class="headerlink" title="Object.freeze æ–¹æ³•"></a>Object.freeze æ–¹æ³•</h3><p>MDNä¸Šå†…å®¹æ¦‚è¿°ï¼š</p><pre><code>æ¦‚è¿°    Object.freeze() æ–¹æ³•å¯ä»¥å†»ç»“ä¸€ä¸ªå¯¹è±¡ã€‚è¯­æ³•    Object.freeze(obj)å‚æ•°    obj å°†è¦è¢«å†»ç»“çš„å¯¹è±¡</code></pre><p>å¯ä»¥å…ˆç†è§£ä¸ºï¼Œè¿™æ˜¯æœ€é«˜ä¸€å±‚çš„å†»ç»“å¯¹è±¡ï¼š</p><pre><code>var person1 = {    name: &quot;Lucas&quot;}Object.freeze(person1);</code></pre><p>æ­¤æ—¶ï¼Œæˆ‘ä»¬æœ‰ï¼š</p><pre><code>Object.getOwnPropertyDescriptor(person1, &apos;name&apos;)Object {    value: &quot;Lucas&quot;,     writable: false,     enumerable: true,     configurable: false}// å¯¹å†»ç»“å¯¹è±¡çš„ä»»ä½•æ“ä½œéƒ½ä¼šå¤±è´¥person1.name = &quot;Eros&quot;; // æ”¹å†™å±æ€§å€¼ï¼Œéä¸¥æ ¼æ¨¡å¼ä¸‹é™é»˜å¤±è´¥;person1.age = 18; // æ‰©å±•å±æ€§å€¼ï¼Œéä¸¥æ ¼æ¨¡å¼ä¸‹é™é»˜å¤±è´¥;Object.defineProperty(person1,&quot;name&quot;,{value: &quot;Eros&quot;}); // ä½¿ç”¨definePropertyä¼šç›´æ¥æŠ¥é”™</code></pre><p>æ”¹å†™å±æ€§å€¼ï¼Œæ‰©å±•æ–°å±æ€§ï¼Œè°ƒç”¨definePropertyï¼Œå…¨éƒ¨éƒ½ä¼šå¤±è´¥ã€‚</p><p>ä½†æ˜¯ï¼Œ<strong>è¿™ç§å±‚é¢çš„å†»ç»“ï¼Œåªæ˜¯æµ…å†»ç»“ã€‚</strong>å¦‚æœå¯¹è±¡é‡Œé¢è¿˜åµŒå¥—æœ‰å¯¹è±¡ï¼Œé‚£ä¹ˆè¿™ä¸ªå†…éƒ¨å¯¹è±¡ä¸æ¯«ä¸å—å½±å“ã€‚</p><pre><code>var person1 = {    name: &quot;Lucas&quot;,    family: {        brother: &quot;Eros&quot;    }}Object.freeze(person1);person1.family.brother = &quot;Tim&quot;;person1.family.brother // &quot;Tim&quot;</code></pre><h3 id="ç»ˆæå®ç°"><a href="#ç»ˆæå®ç°" class="headerlink" title="ç»ˆæå®ç°"></a>ç»ˆæå®ç°</h3><p>é‚£ä¹ˆï¼Œå¦‚æœæˆ‘ä»¬æƒ³æ·±å±‚æ¬¡å†»ç»“ä¸€ä¸ªå¯¹è±¡å‘¢ï¼Ÿæ€è·¯å’Œæ·±æ‹·è´æš—åˆï¼Œä½¿ç”¨é€’å½’ï¼š</p><pre><code>Object.prototype.deepFreeze = Object.prototype.deepFreeze || function (o){    var prop, propKey;    Object.freeze(o); // é¦–å…ˆå†»ç»“ç¬¬ä¸€å±‚å¯¹è±¡    for (propKey in o){        prop = o[propKey];        if(!o.hasOwnProperty(propKey) || !(typeof prop === &quot;object&quot;) || Object.isFrozen(prop)){            continue;        }        deepFreeze(prop); // é€’å½’    }}</code></pre><p>è¿™æ ·å­ï¼Œæˆ‘ä»¬å†å›è¿‡å¤´æ¥çœ‹ï¼š</p><pre><code>var person1 = {    name: &quot;Lucas&quot;,    family: {        brother: &quot;Eros&quot;    }}Object.deepFreeze(person1);person1.family.brother = &quot;Tim&quot;;person1.family.brother // &quot;Eros&quot;</code></pre><p>å·²ç»è¾¾åˆ°äº†æ·±å±‚æ¬¡å¯¹è±¡å±æ€§çš„å†»ç»“ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ¬æ–‡å…ˆåä»‹ç»äº†å…³äºå†»ç»“ä¸€ä¸ªå¯¹è±¡çš„ä¸‰ç§è¿›é˜¶æ–¹æ³•ã€‚ä»–ä»¬å±‚å±‚é€’è¿›ï¼Œå´åˆç›¸äº’å…³è”ã€‚å…³ç³»å¦‚å›¾ï¼š</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-55750ea1c4e62989.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å…³ç³»å›¾"></p><p>æ–‡ç« éƒ¨åˆ†æ¦‚å¿µç²˜å–äº†MDNè¯­æ³•ä»‹ç»å’Œ<a href="https://segmentfault.com/a/1190000003894119" target="_blank" rel="external">Tomsonçš„æ–‡ç« ã€‚</a></p><p>åœ¨ã€Šæ–‡å­¦å°è¨€ã€‹ä¸€æ–‡ä¸­ï¼Œç‹å›½ç»´æŠŠä¸Šè¿°ä¸‰å¢ƒç•Œè¯´æˆâ€œä¸‰ç§ä¹‹é˜¶çº§â€ã€‚å¹¶è¯´ï¼šâ€œæœªæœ‰ä¸é˜…ç¬¬ä¸€ç¬¬äºŒé˜¶çº§è€Œèƒ½é½è·»ç¬¬ä¸‰é˜¶çº§è€…ï¼Œæ–‡å­¦äº¦ç„¶ã€‚æ­¤æœ‰æ–‡å­¦ä¸Šä¹‹å¤©æ‰è€…ï¼Œæ‰€ä»¥åˆéœ€è«å¤§ä¹‹ä¿®å…»ä¹Ÿã€‚â€</p><p>ä¸å¤§å®¶å…±å‹‰ã€‚</p><p>Happy coding!</p><p>PS: ä½œè€…<a href="https://github.com/HOUCe" target="_blank" rel="external">Githubä»“åº“</a>ï¼Œæ¬¢è¿é€šè¿‡ä»£ç å„ç§å½¢å¼äº¤æµã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;ç‹å›½ç»´åœ¨ã€Šäººé—´è¯è¯ã€‹é‡Œè°ˆåˆ°äº†æ²»å­¦ç»éªŒï¼Œä»–è¯´ï¼šâ€œå¤ä»Šä¹‹æˆå¤§äº‹ä¸šã€å¤§å­¦é—®è€…ï¼Œå¿…ç»è¿‡ä¸‰ç§ä¹‹å¢ƒç•Œã€‚â€&lt;/p&gt;
&lt;p&gt;å·§åˆçš„æ˜¯ï¼Œæœ€è¿‘å— &lt;a href=&quot;http://gitbook.cn/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;git chat ï¼ git
      
    
    </summary>
    
      <category term="js" scheme="https://exp-team.github.io/categories/js/"/>
    
    
      <category term="js" scheme="https://exp-team.github.io/tags/js/"/>
    
  </entry>
  
  <entry>
    <title>æ¥è‡ªç™¾åº¦ç»éªŒå‰ç«¯ â€”â€” è¶…çº§ sexy çš„æ‰‹åŠ¿åº“</title>
    <link href="https://exp-team.github.io/blog/2017/11/04/js/exp-touch/"/>
    <id>https://exp-team.github.io/blog/2017/11/04/js/exp-touch/</id>
    <published>2017-11-03T16:00:00.000Z</published>
    <updated>2017-11-05T03:42:29.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ä¸€ä¸ªé¡µé¢ï¼Œæ—¥å‡äº¿äººå›´è§‚ï¼Œæ•°ä»¥ç™¾è®¡çš„ç»ˆç«¯æ‰¿è½½ï¼›<br>è·³è·ƒæŒ‡å°–ï¼Œç‚¹æŒ‰è§¦ç¢°æ‹–æ‹½ï¼Œä¸èˆ¬é¡ºæ»‘è¿½æ±‚æè‡´ä½“éªŒï¼›</p><p>ä½ è¿˜åœ¨ä¸º<strong>æ‰‹åŠ¿äº¤äº’å¼€å‘</strong>å›°æ‰°å—ï¼Œä½ è¿˜åœ¨ä¸º<strong>ç¢ç‰‡åŒ–å…¼å®¹æ€§</strong>å¿ƒå¡å—ï¼Ÿ<br>å» <a href="">exp touch</a> çœ‹çœ‹ï¼Œ</p><p>ä¸°å¯Œæ‰‹åŠ¿äº¤äº’å°è£…ï¼Œå®Œç¾ demo å°½ç°ã€‚<br>æˆ‘ä»¬å…±åŒè§è¯ï¼Œç”¨æˆ·è§¦ç¢°æ»‘åŠ¨çš„ç¬é—´ã€‚</p></blockquote><p><img src="http://upload-images.jianshu.io/upload_images/4363003-013d341c9151767c.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="cover.jpg"></p><p>è¿™æ˜¯ä¸€ç¯‡æŠ€æœ¯æ¨å¹¿ï¼Œè½¯æ–‡è¥é”€ï¼Œä½†æ˜¯å¹¶ä¸ä¼šæ‰¯æŠ€æœ¯ï¼ˆäº§å“ã€è¿è¥å®å®ä»¬ä¸è¦èµ°ï¼Œåº•éƒ¨è¶…å¤šå¯çˆ±çš„ gif å›¾ demos)ã€‚å®ƒå…³äºä¸€ä¸ªè¶…çº§ sexy çš„å‰ç«¯æ‰‹åŠ¿åº“ï¼š<strong><a href="">exp touch</a> è¦å¼€æºå•¦</strong>ï¼è¿™æ˜¯ç™¾åº¦ç»éªŒå‰ç«¯è‡ªç ”çš„æ‰‹åŠ¿åº“ã€‚</p><p><strong>åŒ…å«ï¼š</strong>å•ç‚¹ã€åŒå‡»ã€é•¿æ‘ã€æ‹–æ‹½ã€æ»‘åŠ¨ã€æ—‹è½¬ç­‰äº¤äº’ï¼›<br><strong>è¦†ç›–ï¼š</strong>è½®æ’­å›¾ã€æŠ½å¥–è½¬ç›˜ã€3D æ—‹è½¬ã€æåˆç¼©æ”¾ã€ä¸Šæï¼ˆä¸‹æ‹‰ï¼‰åˆ·æ–°ç­‰ demosï¼›<br><strong>é‡‡ç”¨:</strong> ES Next è¯­æ³•ä»¥åŠé¢å‘å¯¹è±¡æ€æƒ³å¼€å‘ï¼Œè¾…ä»¥å¤§é‡æ•°å­¦è®¡ç®—ï¼›<br><strong>æœ€ç»ˆï¼š</strong>ä»¥<strong>æè‡´ç”¨æˆ·ä½“éªŒ</strong>å’Œ<strong>é«˜æ•ˆæ€§èƒ½</strong>ä¸ºäº®ç‚¹ï¼Œæ¨ªç©ºå‡ºä¸–ï¼</p><p>æœ¬æ–‡æ˜¯ä¸€ç¯‡çº¯è½¯æ–‡ï¼Œ<strong>PMã€è¿è¥ã€åç«¯ã€è€æ¿ã€æ°´æœå¤§å“¥ã€é…¸å¥¶å°å¦¹ã€ä¿æ´é˜¿å§¨ï¼Œé˜…è¯»ç»Ÿç»Ÿç»æ— éšœç¢</strong>ï¼ˆæŠ€æœ¯ç»†èŠ‚æ–‡ç« ä¼šä»¤å†™ï¼‰ã€‚å¦‚æœä½ å·²ç»åŒå€¦è¥é”€æ–‡ç« çš„è‡ªå¹è‡ªæ“‚ï¼Œé‚£ä¹ˆä½œä¸ºå‰ç«¯ç¨‹åºå‘˜ï¼Œæˆ‘æƒ³å…ˆå’Œä½ è°ˆè°ˆäº§å“å’Œäº¤äº’ä½“éªŒã€‚</p><h2 id="Wap-VS-Native-å¤©ç©ºæ˜¯å¦æœ‰è¾¹é™…"><a href="#Wap-VS-Native-å¤©ç©ºæ˜¯å¦æœ‰è¾¹é™…" class="headerlink" title="Wap VS Native: å¤©ç©ºæ˜¯å¦æœ‰è¾¹é™…"></a>Wap VS Native: å¤©ç©ºæ˜¯å¦æœ‰è¾¹é™…</h2><p>å‰ç«¯ Wap å¼€å‘ï¼Œä¸åŒäºæˆ‘ä»¬è®¤çŸ¥çš„ Native Appã€‚å¤©ç”Ÿå†³å®šï¼Œæˆ‘ä»¬å¼€å‘çš„å®¿ä¸»æ˜¯æµè§ˆå™¨ã€‚è¿™ä¸ªç»å¥½èˆå°çš„å¦ä¸€é¢ï¼Œéšè—ç€æˆ‘ä»¬å¸¦é•£é“èµ·èˆçš„å°´å°¬ã€‚æ²¡é”™ï¼Œ<strong>æˆ‘æœ‰å¤šçˆ±æµè§ˆå™¨ï¼Œå°±æœ‰å¤šæ¨æµè§ˆå™¨</strong>ã€‚</p><p>å°¤å…¶æ˜¯ç§»åŠ¨ç«¯ï¼Œä¸»æµæµè§ˆå™¨å†…æ ¸å¤¹æ‚å›½äº§å„ç§å±±å¯¨ï¼ŒåŒæ—¶å®‰å“å’Œè‹¹æœä¸¤å¤§æ‰‹æœºç³»ç»Ÿå¤©ç„¶é¸¿æ²Ÿï¼Œç§ç§ç¢ç‰‡åŒ–å¯¼è‡´äº‹ä»¶è§„èŒƒä¸ä¸€è‡´ï¼Œæœ€ç»ˆæˆä¸ºäº§å“ä½“éªŒçš„ç»Šè„šçŸ³ã€‚</p><p><strong>å°¤å…¶å…³äºè§¦æ‘¸äº‹ä»¶</strong>ï¼Œæ›´æ˜¯ä¸€éƒ¨è¡€æ³ªå²ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä¼šå¦èµ·æŠ€æœ¯æ–‡ç« åˆ†æï¼Œè¿™é‡Œä¸åœ¨å±•å¼€ã€‚è¯´å›äº§å“ï¼Œç›´é¢æˆ‘ä»¬çš„ç—›æ¥šï¼šå¯çˆ±çš„ PM ç«¥é‹ï¼Œåœ¨è®¾è®¡äº¤äº’å¤§å¼€è„‘æ´ï¼ˆè¤’ä¹‰ï¼‰çš„åŒæ—¶ï¼Œå¯¹é½æ ‡å‡†å®Œå…¨æ˜¯ Native Appï¼æƒ³æƒ³åœ¨è¯„å®¡æ—¶ï¼Œwuli æˆ‘ PM æ€»ä¼šè¯´ï¼š <strong>â€œå°±æ˜¯è¿™æ ·ï¼ŒXX App ä½ ç”¨è¿‡çš„å§ï¼Œä½ ä»¬åƒ XX App ä¸€æ ·åšå°±å¯ä»¥äº†ï¼â€</strong></p><p>çœŸçš„å°±å¯ä»¥å—ï¼Ÿæ¯æ¬¡éƒ½æƒ³ä»¥ï¼šâ€œä½ äº†è§£ App å’Œ Wap çš„æŠ€æœ¯å®ç°å·®åˆ«å—ï¼Ÿâ€è¿™ç§æ­£å½“çš„çº¯æŠ€æœ¯ç†ç”±æ€¼å›å»ï¼Œå¯æ˜¯è½¬å¿µå°±å‹åœ¨å¿ƒé‡Œï¼Œä¾›äº”è„å…­è…‘ä¹‹é—´äº¤æµã€‚åŒæ—¶ç†æ™ºå æ®ä¸Šé£ï¼Œä¿¡å¿µæ§åˆ¶ä½<strong>é©¬ä¸Šè¦æŠ½èµ·è—åœ¨æŠ½å±‰ä¸­ç åˆ€</strong>çš„éº’éºŸè‡‚ï¼Œè€è€å®å®æ”¾å›åˆ°é”®ç›˜ä¸Šã€‚</p><p>å¤œæ·±äººé™æ—¶ï¼Œæˆ‘ä¹Ÿæƒ³ï¼šâ€œWap ç«¯çœŸçš„å°±ä¸å¯ä»¥å®ç° Native é‚£æ ·çš„è§¦æ§æ“ä½œå—ï¼Ÿâ€ä¸ºæ­¤ï¼Œæˆ‘éè®¿äº†ä¼—å¤š Wap é¡µé¢ï¼Œæ— å¥ˆéƒ½æ˜¯é¥®æ¨è€Œå½’ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»æ¥æ²¡æœ‰çœ‹åˆ°è¿‡ï¼š <strong>Wap ç«¯æ‰‹æŒ‡æå’Œç¼©æ”¾å›¾ç‰‡æ—¶ï¼Œä»¥æ‰‹æŒ‡ä¸­å¿ƒä¸ºç„¦ç‚¹ï¼Œå›¾ç‰‡æ”¾å¤§çš„åŒæ—¶å›¾ç‰‡è‡ªèº«ä¹Ÿè¿›è¡Œä½ç§»ï¼Œä¿æŒé¢„æœŸä¸­çš„æ”¾å¤§ç„¦ç‚¹å§‹ç»ˆåœ¨åŒæŒ‡ä¸­å¿ƒã€‚</strong>å¦‚åŒåœ¨å¾®ä¿¡æœ‹å‹åœˆä¸­çš„å›¾ç‰‡ç¼©æ”¾æ•ˆæœé‚£èˆ¬è‡ªç„¶ã€‚å¯æ˜¯åœ¨ Wap é¡µä¸Šï¼ŒçœŸçš„å¾ˆå°‘æœ‰å®ç°ï¼</p><p>æˆ‘ä¸€ç›´ä¸ç”˜å¿ƒï¼Œç›´åˆ°è¿™æ¬¡çš„<strong>ç™¾åº¦ç»éªŒæ­¥éª¤é¡µæ”¹ç‰ˆ</strong>ï¼Œè®©æˆ‘å‘ä¸å¯èƒ½å‘èµ·æŒ‘æˆ˜ã€‚æ¥ï¼Œæ…¢æ…¢è·Ÿä½ è¯´ã€‚</p><h2 id="æ–°ç‰ˆæ­¥éª¤é¡µï¼šæ‹¥æŠ±è§†é¢‘åŒ–-å¥¢åä½“éªŒå‡å"><a href="#æ–°ç‰ˆæ­¥éª¤é¡µï¼šæ‹¥æŠ±è§†é¢‘åŒ–-å¥¢åä½“éªŒå‡å" class="headerlink" title="æ–°ç‰ˆæ­¥éª¤é¡µï¼šæ‹¥æŠ±è§†é¢‘åŒ– + å¥¢åä½“éªŒå‡å"></a>æ–°ç‰ˆæ­¥éª¤é¡µï¼šæ‹¥æŠ±è§†é¢‘åŒ– + å¥¢åä½“éªŒå‡å</h2><p>ç™¾åº¦ç»éªŒæ­¥éª¤é¡µæ˜¯ç™¾åº¦ç»éªŒæœ€é‡è¦çš„é¡µé¢ã€‚æ— è®ºä» PVã€UV è¿˜æ˜¯å˜ç°èƒ½åŠ›æ¥çœ‹ï¼Œéƒ½å¤„åœ¨æ¯«æ— äº‰è®®çš„æ ¸å¿ƒåœ°ä½ã€‚è¿™æ¬¡ç™¾åº¦ç»éªŒæ­¥éª¤é¡µæ”¹ç‰ˆï¼Œæœ€é‡è¦çš„ç›®çš„é™¤äº†æ‹¥æŠ±è§†é¢‘åŒ–ä»¥å¤–ï¼Œå°±æ˜¯æ‰“é€ æ›´åŠ å®Œç¾ã€æµç•…çš„ä½¿ç”¨ä½“éªŒã€‚</p><p>å‰ç«¯å¼€å‘ï¼Œåœ¨è§†é¢‘åŒ–æ–¹é¢ä¹Ÿé¢ä¸´ä¸¥é‡çš„æœºé‡å’ŒæŒ‘æˆ˜ï¼Œç”±äºæ­¤æ–‡æ¨é”€ä¸»é¢˜åŸå› ï¼Œæš‚ä¸”ä¸è¡¨ï¼ŒåŒæ ·ä¹Ÿä¼šæœ‰æŠ€æœ¯æ–‡ç« ç¨åå¥‰ä¸Šã€‚è¿™é‡Œä¸»è¦è°ˆè°ˆæ‰‹åŠ¿ä¸Šçš„äº¤äº’ä½“éªŒã€‚</p><p>è´Ÿè´£ä»»åœ°è¯´ï¼Œæˆ‘ä»æ¥æ²¡è§åˆ°è¿‡åƒç™¾åº¦ç»éªŒæ­¥éª¤é¡µä¸€æ ·ï¼Œæå°½æ‰‹åŠ¿æŒæ§ä¹‹èƒ½äº‹ï¼Œå°¤å…¶æ˜¯åœ¨å¤©ç”Ÿç•¸å½¢çš„æµè§ˆå™¨ä¸Šï¼Œæˆ‘ä»¬çœ‹çœ‹å®ƒéƒ½å®ç°äº†ä»€ä¹ˆï¼š</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-ab94bcae4206c75d.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.jpg"></p><p>ä¸Šå›¾ä¸­çš„æ–‡å­—ä»…ä»…æ¶µç›–äº†å›¾ç‰‡ç”»å»Šæ‰‹åŠ¿äº¤äº’ä¸€éƒ¨åˆ†ï¼Œå„ç§è‡ªé€‚åº”ä»¥åŠå„ç§ç‰©ç†æƒ°æ€§å›å¼¹ã€ç¼©æ”¾æ‘©æ“¦ç³»æ•°ã€ç¼©æ”¾é˜ˆå€¼ã€ç¼“å†²åŒºåŸŸã€å›å¼¹ç³»æ•°ç­‰ç­‰ä¹Ÿå°±ä¸ä¸€ä¸€åˆ—ä¸¾äº†ã€‚</p><p>åŒæ—¶ï¼Œå›¾ç‰‡ç”»å»Šå¹¶ä¸æ˜¯ä¸€ä¸ªæ–°çš„é¡µé¢ï¼Œå…¨éƒ¨ä»¥åŸé¡µé¢åŠ é®ç½©å½¢å¼å‡ºç°ã€‚ä½ å¯ä»¥ç†è§£ä¸º SPAï¼ˆå•é¡µé¢åº”ç”¨ï¼‰ï¼Œå„ç§æ¶ˆæ¯äº¤äº’ï¼Œæ‰‹åŠ¿è§¦æ§çŸ›ç›¾å¤„ç†è€¦åˆï¼Œç»§ç»­å¦‚å›¾ï¼š</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-1e8692c29fe81ee1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="mind.png"></p><p>å•çº¯çš„åŒæŒ‡ç¼©æ”¾å…¶å®å¹¶ä¸éš¾ï¼Œä½ å¯èƒ½ä¹Ÿä¼šæƒ³åˆ°å°±æ˜¯äºŒç»´åæ ‡è½´çš„å„ç§è®¡ç®—ç½¢äº†ã€‚</p><p><strong>å¯æ˜¯ï¼š</strong>å•å‡»åŒå‡»æ—¶é—´å·®å¦‚ä½•åŒºåˆ†ï¼›æœ‰è§’åº¦çš„æ»‘åŠ¨ç®—å·¦æ»‘è¿˜æ˜¯å³æ»‘ï¼›æŒ‡å®šå…ƒç´ ä¸Š touch move æœŸé—´æ»‘åŠ¨å‡ºäº†æ‰‹æœºå±è¦ä¸è¦è§¦å‘ touch end äº‹ä»¶ï¼›ä¸€æ ¹æ‰‹æŒ‡å’Œä¸¤æ ¹æ‰‹æŒ‡å’Œå¤šæ ¹æ‰‹æŒ‡æ”¾åœ¨ä¸åŒçš„å…ƒç´ ä¸Šè¦æ€ä¹ˆåˆ’åˆ†ï¼Ÿ</p><p>è¯¸å¦‚æ­¤ç±»å¤ªå¤šé€»è¾‘å’Œç»†èŠ‚äº¤ç»‡ï¼Œè¿™é…¸çˆ½è¶³ä»¥é†‰äººã€‚å†åŠ ä¸Šéš”ç€æµè§ˆå™¨å…¼å®¹æ€§çš„å£å’ï¼Œè¿™éƒ½æ„æˆ Wap é¡µé¢å¾ˆå°‘æœ‰å¤§è§„æ¨¡æ‰‹åŠ¿æ“æ§å®ç°çš„åŸå› ã€‚ä¸ä¿¡ä½ å»æ‰¾æ‰¾ï¼ŒWap ä¸Šå›¾ç‰‡ç”»å»Šæ”¯æŒåˆ‡æ¢å›¾ç‰‡ä¸”æ”¯æŒæ‰‹æŒ‡ä¸­å¿ƒå›¾ç‰‡ç¼©æ”¾çš„ caseâ€¦â€¦é¢ï¼Œæ‰¾åˆ°æœ‰å¥–ï¼Œæ‰¾åˆ°æºä»£ç ï¼Ÿæœ‰å¤§å¥–ï¼</p><p>å¯æ˜¯è¿™æ¬¡çš„æ­¥éª¤é¡µæ”¹ç‰ˆï¼Œæˆ‘ä»¬ååè¦æŠŠè¿™äº›å®ç°ã€‚</p><h2 id="æ–°ç‰ˆæ­¥éª¤é¡µå’Œæ–°æ–°ç‰ˆæ­¥éª¤é¡µå’Œæ–°æ–°æ–°æ–°æ–°ç‰ˆæ­¥éª¤é¡µ"><a href="#æ–°ç‰ˆæ­¥éª¤é¡µå’Œæ–°æ–°ç‰ˆæ­¥éª¤é¡µå’Œæ–°æ–°æ–°æ–°æ–°ç‰ˆæ­¥éª¤é¡µ" class="headerlink" title="æ–°ç‰ˆæ­¥éª¤é¡µå’Œæ–°æ–°ç‰ˆæ­¥éª¤é¡µå’Œæ–°æ–°æ–°æ–°æ–°ç‰ˆæ­¥éª¤é¡µ"></a>æ–°ç‰ˆæ­¥éª¤é¡µå’Œæ–°æ–°ç‰ˆæ­¥éª¤é¡µå’Œæ–°æ–°æ–°æ–°æ–°ç‰ˆæ­¥éª¤é¡µ</h2><p>ç»è¿‡å‘•å¿ƒåè¡€çš„éªšæ“ä½œï¼Œåœ¨å»å¹´æ­¥éª¤é¡µæ”¹ç‰ˆå…¨é‡ä¸Šçº¿ä¹‹åï¼Œä¸ç®¡æ˜¯ PVã€UVã€è¿˜æ˜¯å¹¿å‘Šæ”¶ç›Šéƒ½æœ‰å¤§å¹…åº¦ä¸Šæ¶¨ã€‚å¯æ˜¯æ”¹ç‰ˆå¸¸å¹´æœ‰ï¼Œéš¾é“ä»¥åå¹´å¹´æŠ˜è…¾ä¸€éï¼Ÿ</p><p>æˆ‘é€‰æ‹©æ‹’ç»ï¼Œä¹‹å‰çš„å¼€å‘å¿ƒå¾—å¹¶æ²¡æœ‰ç™½ç§¯ç´¯ã€‚æˆ‘åˆ©ç”¨å‘¨æœ«æ—¶é—´ï¼ŒåŸºäº AlloyTouch ç­‰è‰¯å¿ƒä½œå“ï¼Œ<strong>å¼€å‘äº† exp touch è¿™ä¸ªç™¾åº¦ç»éªŒæ‰‹åŠ¿åº“</strong>ã€‚</p><p>å®ƒé‡‡ç”¨ ES Next å®Œå…¨é¢å‘å¯¹è±¡ï¼Œå°è£…äº†å¤§é‡å¿…è¦çš„è®¡ç®—è¿‡ç¨‹ï¼ŒåŒæ—¶å¯¹å¤–æš´éœ²å‡ºå„ç§è´´å¿ƒçš„å›è°ƒã€‚æˆ‘ä¸ªäººå¾ˆåŒæ¶åŠŸèƒ½å¤§è€Œå…¨çš„ UI åº“ï¼Œé™å®šæ­»äº†å¤ªå¤šå†…å®¹è€Œæ— æ³•æ‹“å±•ã€‚å› æ­¤ exp touch åªè¿›è¡Œå…¼å®¹æ€§å¤„ç†ä»¥åŠæ•°å­¦è®¡ç®—ã€‚åŒæ—¶ä¸ºäº†å¢å¼ºå¯ç”¨æ€§å’Œå­¦ä¹ æˆæœ¬ï¼ŒåŸºäº exp touch æ‰‹åŠ¿åº“ï¼Œæˆ‘å®ç°äº†æµ·é‡ demosï¼Œç¬¬ä¸‰æ–¹å¼€å‘è€…å®Œå…¨å¯ä»¥å¤åˆ¶ç²˜è´´ï¼Œåˆ†åˆ†é’Ÿè§£é”å„ç§å§¿åŠ¿ã€‚</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-7037997de4248d4e.gif?imageMogr2/auto-orient/strip" alt="intro.gif"></p><h2 id="æµ·é‡-demo-å³æ’å³ç”¨"><a href="#æµ·é‡-demo-å³æ’å³ç”¨" class="headerlink" title="æµ·é‡ demo å³æ’å³ç”¨"></a>æµ·é‡ demo å³æ’å³ç”¨</h2><p>é‚£æˆ‘ä»¬ç›´æ¥çœ‹çœ‹ Gif å›¾å¥½å’¯ï¼š</p><p>demo: è¿™æ˜¯ä¸€ä¸ªç®€å•çš„æ»šåŠ¨ã€‚ä½†æ˜¯ä¸å‡ºç°æ»šåŠ¨æ¡ï¼Œå› ä¸ºå®Œå…¨ä¸ä¾é æµè§ˆå™¨ scrollï¼Œè€Œæ˜¯æ ¹æ® touchmove å®æ—¶è®¡ç®— transformYï¼ŒåŒæ—¶åŒ…å«äº†ç¼“å†²åŒºåŸŸè®¾ç½®ï¼š</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-e581965b3dcdc7c1.gif?imageMogr2/auto-orient/strip" alt="srcoll.gif"></p><p>demo: è¿™æ˜¯ä¸€ä¸ªå¸¸è§çš„ç§»åŠ¨ç«¯è½®æ’­å›¾</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-1a322e443bcb7cad.gif?imageMogr2/auto-orient/strip" alt="broad.gif"></p><p>demo: è¿™æ˜¯ä¸€ä¸ªå¸¸è§çš„æ•´å±å¹•ç¿»åŠ¨ H5:<br><img src="http://upload-images.jianshu.io/upload_images/4363003-7037997de4248d4e.gif?imageMogr2/auto-orient/strip" alt="intro.gif"></p><p>demo: è¿™æ˜¯ä¸€ä¸ªä¿¡æ¯æµå±•ç°ï¼ŒåŒ…å«ä¸‹æ‹‰åˆ·æ–°ï¼Œå’Œå¤´éƒ¨åŠ¨ç”»ï¼š</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-49101851198effe4.gif?imageMogr2/auto-orient/strip" alt="feeds.gif"></p><p>demo: è¿™æ˜¯ä¸€ä¸ª 2D æŠ½å¥–è½¬ç›˜ï¼Œæ‰‹åŠ¿è½¬åŠ¨å¼€å¯ï¼›</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-271c8382ab827c83.gif?imageMogr2/auto-orient/strip" alt="prize.gif"></p><p>demo: è¿™æ˜¯ä¸€ä¸ªæ‹–æ‹½ï¼š</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-55a0fa5998dceb84.gif?imageMogr2/auto-orient/strip" alt="drag.gif"></p><p>ï¼ˆè¿™äº› demo çµæ„Ÿæ¥è‡ª AlloyTeam å›¢é˜Ÿï¼Œæˆ‘åªæ˜¯ç…§ç€è‡ªå·±å®ç°äº†ä¸€ä¸‹ï¼‰</p><h2 id="æœ€åå‡ å¥è¯"><a href="#æœ€åå‡ å¥è¯" class="headerlink" title="æœ€åå‡ å¥è¯"></a>æœ€åå‡ å¥è¯</h2><ol><li>è¿™ä¸ªåº“å½“ç„¶è¿˜å­˜åœ¨ä¸€äº›ä¸å®Œå–„çš„åœ°æ–¹ï¼Œå¤§å®¶åç»­å°½å¯ä»¥æ PRï¼Œæˆ–è€…å½“é¢äº¤æµï¼›</li><li>æåº¦æ”¯æŒé‡‡ç”¨ exp touchï¼Œç©å‡ºæ›´å¤šèŠ±æ ·ï¼Œåšå‡ºçš„æœ€ç»ˆé¡µé¢æ¬¢è¿åé¦ˆç»™æˆ‘ï¼›</li><li>å®ƒå°†ä¼šåœ¨æ–°ç‰ˆæ­¥éª¤é¡µä¸Šçº¿åæ­£å¼å¼€æºã€‚åœ¨æ­¤ä¹‹å‰ï¼Œä»»ä½•æœ‰å…´è¶£çš„ï¼Œå¯ä»¥ä¸æˆ‘ä¸€èµ·å¼€å‘ã€‚è™½ç„¶æˆ‘å·²ç»å®ç°äº† 99%ï¼Œå‰©ä¸‹ 1% ç»™ä½ ä¸€ä¸ª contributorï¼›</li><li><strong>å¤šå¤šå…³æ³¨ç™¾åº¦ç»éªŒï¼Œæˆ‘ä»¬æ˜¯ä¸€ä¸ªå°è€Œç¾çš„å›¢é˜Ÿ</strong>ï¼›</li><li>å†™è¿™ä¸ªå…¶å®æŒºæ²¡æ„æ€çš„ï¼Œæˆ‘æ›´å–œæ¬¢ Reactï¼›</li><li>å‰äº›æ—¶é—´æœ‰å‡ å®¶å‡ºç‰ˆç¤¾æ‰¾åˆ°æˆ‘çº¦ä¹¦ï¼Œæœ€ç»ˆæˆ‘é€‰æ‹©å’Œç”µå­å·¥ä¸šå‡ºç‰ˆç¤¾ç­¾è®¢çº¦ç¨¿åˆåŒï¼Œåœ¨å†™ä¸€æœ¬å…³äº React æŠ€æœ¯æ ˆçš„ä¹¦ï¼›</li><li>å¦‚æœä½ å¯¹ React ä»¥åŠå‡ºä¹¦æ„Ÿå…´è¶£ï¼Œæˆ‘å·²ç»æ‹‰ä¸Šäº†å‚å†…å¤–ä¸¤ä¸ªå¤§ä½¬ï¼Œä¹Ÿå¼ºçƒˆæ¬¢è¿ä½ æ¥è·Ÿæˆ‘ä¸€èµ·å†™ï¼Œå‡ºè°‹åˆ’ç­–æˆ–è€…åšåšæ ¡å®¡ç©ç©ï¼›</li><li>å¦‚æœä½ å•çº¯å¯¹ React æŠ€æœ¯æ ˆæ„Ÿå…´è¶£ï¼Œå¯ä»¥å…³æ³¨<a href="https://www.zhihu.com/people/lucas-hc/activities" target="_blank" rel="external">æˆ‘çš„çŸ¥ä¹</a>ï¼Œæœ€è¿‘åŠå¹´ä¸å®šæœŸåœ¨å‘è¡¨ä¸€äº›æŠ€æœ¯å¿ƒå¾—ï¼ˆæˆ‘æ˜¯æ¥éª—ç²‰çš„ï¼‰ã€‚</li><li><strong>åŒ 4ï¼›</strong></li><li><strong>åŒä¸Šã€‚</strong></li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;ä¸€ä¸ªé¡µé¢ï¼Œæ—¥å‡äº¿äººå›´è§‚ï¼Œæ•°ä»¥ç™¾è®¡çš„ç»ˆç«¯æ‰¿è½½ï¼›&lt;br&gt;è·³è·ƒæŒ‡å°–ï¼Œç‚¹æŒ‰è§¦ç¢°æ‹–æ‹½ï¼Œä¸èˆ¬é¡ºæ»‘è¿½æ±‚æè‡´ä½“éªŒï¼›&lt;/p&gt;
&lt;p&gt;ä½ è¿˜åœ¨ä¸º&lt;strong&gt;æ‰‹åŠ¿äº¤äº’å¼€å‘&lt;/strong&gt;å›°æ‰°å—ï¼Œä½ è¿˜åœ¨ä¸º&lt;strong&gt;ç¢ç‰‡åŒ–å…¼å®¹æ€§&lt;/strong&gt;å¿ƒå¡å—ï¼Ÿ&lt;br&gt;å»
      
    
    </summary>
    
      <category term="js" scheme="https://exp-team.github.io/categories/js/"/>
    
    
      <category term="js" scheme="https://exp-team.github.io/tags/js/"/>
    
  </entry>
  
  <entry>
    <title></title>
    <link href="https://exp-team.github.io/blog/2017/06/27/js/decomposing_React_components/"/>
    <id>https://exp-team.github.io/blog/2017/06/27/js/decomposing_React_components/</id>
    <published>2017-06-27T07:12:25.000Z</published>
    <updated>2017-06-27T07:14:03.000Z</updated>
    
    <content type="html"><![CDATA[<p>ä¹‹å‰åˆ†äº«è¿‡å‡ ç¯‡å…³äºReactæŠ€æœ¯æ ˆçš„åŸåˆ›æ–‡ç« ï¼š</p><ul><li><a href="http://www.jianshu.com/p/7a56ac1de2a8" target="_blank" rel="external">è§£æTwitterå‰ç«¯æ¶æ„ å­¦ä¹ å¤æ‚åœºæ™¯æ•°æ®è®¾è®¡</a></li><li><a href="http://www.jianshu.com/p/83c86dd0802d" target="_blank" rel="external">React Conf 2017 å¹²è´§æ€»ç»“1: React + ES next = â™¥</a></li><li><a href="http://www.jianshu.com/p/cde3cf7e2760" target="_blank" rel="external">React+Reduxæ‰“é€ â€œNEWS EARLYâ€å•é¡µåº”ç”¨ ä¸€ä¸ªé¡¹ç›®ç†è§£æœ€å‰æ²¿æŠ€æœ¯æ ˆçœŸè°›</a></li><li><a href="http://www.jianshu.com/p/8e28be0e7ab1" target="_blank" rel="external">ä¸€ä¸ªreact+reduxå·¥ç¨‹å®ä¾‹</a></li><li>â€¦â€¦</li></ul><p>ä»Šå¤©è¿›ä¸€æ­¥å‰–æä¸€ä¸ªå®é™…æ¡ˆä¾‹ï¼š<strong>Uber APP ç§»åŠ¨ç½‘é¡µç‰ˆã€‚</strong></p><p>å¦‚æœä½ å¯¹ReactæŠ€æœ¯æ ˆæ²¡æœ‰å¤šå¤§å…´è¶£ï¼Œæˆ–è€…ä¸æ˜¯å¾ˆäº†è§£ï¼Œä¹Ÿæ²¡æœ‰å…³ç³»ã€‚å› ä¸ºè¯»ä¸‹æ¥ï¼Œä½ ä¼šå‘ç°ï¼Œè¿™ç¯‡æ–‡ç« çš„çœŸè°›å…¶å®åœ¨äº<strong>æ€§èƒ½ä¼˜åŒ–</strong>ä¸Šã€‚</p><p>æœ¬æ–‡çµæ„Ÿå’Œä¸»ä½“å†…å®¹ç¿»è¯‘è‡ªNarendra N Shettyçš„<a href="https://hackernoon.com/how-i-built-a-super-fast-uber-clone-for-mobile-web-863680d2100f" target="_blank" rel="external">æ–‡ç« ï¼šHow I built a super fast Uber clone for mobile web</a>ï¼ŒåŒæ—¶è¿›è¡Œäº†å¤§é‡æ‰©å……ä»¥åŠæ·±æŒ–ã€‚</p><h2 id="å‡ºå‘ç‚¹å’Œäº§å“é›å½¢"><a href="#å‡ºå‘ç‚¹å’Œäº§å“é›å½¢" class="headerlink" title="å‡ºå‘ç‚¹å’Œäº§å“é›å½¢"></a>å‡ºå‘ç‚¹å’Œäº§å“é›å½¢</h2><p>å¾ˆæ—©ä»¥æ¥ï¼Œç›¸ä¿¡å¤§å®¶éƒ½ä¼šè®¤åŒä¸€ä¸ªè§‚ç‚¹ï¼š<strong>ç§»åŠ¨ç«¯æµé‡è¶…è¶ŠPCç«¯æ˜¯ä¸äº‰çš„äº‹å®ã€‚</strong>å¯¹äºå‰ç«¯å¼€å‘è€…æ¥è¯´ï¼Œç§»åŠ¨ç«¯webçš„å¼€å‘åŒæ ·éå¸¸æœ‰è¶£ï¼Œä¹Ÿå……æ»¡æŒ‘æˆ˜ã€‚</p><p>è¿™ä¸ï¼ŒUberæœ€è¿‘å‘å¸ƒäº†æœ€æ–°ç‰ˆæœ¬APPï¼Œå…¨æ–°æ ·å¼ï¼Œä½“éªŒè¶…æ£’ã€‚äºæ˜¯ï¼Œç¬”è€…å†³å®šä½¿ç”¨Reactæ¥ä»é›¶å¼€å§‹æ„å»ºä¸€ä¸ªæ–°çš„å±äºè‡ªå·±çš„Uberã€‚</p><p>å¼€å‘æœŸé—´ï¼Œç¬”è€…èŠ±è´¹äº†å¾ˆå¤šæ—¶é—´åœ¨åŸºç¡€ç»„ä»¶å’Œæ ·å¼æ­å»ºä¸Šã€‚è¿™ç¯èŠ‚ä¸­ï¼Œä¸»è¦åº”ç”¨äº†<a href="https://github.com/uber/react-map-gl" target="_blank" rel="external">Uberå®˜æ–¹å¼€æ”¾çš„Reactåœ°å›¾åº“</a>ï¼Œå¹¶åœ¨åœ°å›¾ä¸Šâ€œç›®çš„åœ°â€å’Œâ€œèµ·å§‹ç‚¹â€ä¹‹é—´é‡‡ç”¨svg-overlayå’Œhtml-overlayå»ç»˜åˆ¶è·¯çº¿ã€‚</p><p>æœ€ç»ˆçš„åŸºæœ¬äº¤äº’å¯ä»¥å‚è€ƒä¸‹é¢Gifå›¾ï¼š</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-59027620881f3e91.gif?imageMogr2/auto-orient/strip" alt="uber.gif"></p><h2 id="èµ°ä¸Šä¼˜åŒ–ä¹‹è·¯"><a href="#èµ°ä¸Šä¼˜åŒ–ä¹‹è·¯" class="headerlink" title="èµ°ä¸Šä¼˜åŒ–ä¹‹è·¯"></a>èµ°ä¸Šä¼˜åŒ–ä¹‹è·¯</h2><p>ç°åœ¨ï¼Œæˆ‘ä»¬æœ‰åŸºæœ¬çš„äº§å“å½¢æ€äº†ã€‚ç›®å‰é¢ä¸´çš„é—®é¢˜åœ¨äºæé«˜äº§å“çš„å„æ–¹é¢æ€§èƒ½ä½“éªŒã€‚æˆ‘ä½¿ç”¨äº†Chrome Lighthouseå»æ£€éªŒäº§å“çš„æ€§èƒ½è¡¨ç°ã€‚æœ€ç»ˆå¾—åˆ°çš„ç»“æœä¸ºï¼š</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-ea0f448ffd3ae4f1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ç»“æœ1.png"></p><p>wowâ€¦<br>ç¬¬ä¸€æ¬¡ç»˜åˆ¶æ—¶é—´å°±å·²ç»<strong>æ¥è¿‘2ç§’</strong>ï¼Œåé¢çš„æ—¶é—´æƒ¨ä¸å¿ç¹å°±ä¸è¦çœ‹äº†å§ã€‚<br>æƒ³è±¡ä¸€ä¸‹ï¼Œä¸€ä¸ªç”¨æˆ·æ‹¿å‡ºæ‰‹æœºï¼Œä¼å›¾å«è½¦ã€‚ä¸»å±æ—¶é—´çš„ç»˜åˆ¶å°±è¶…è¿‡äº†19189.9msï¼Œè¿™æ˜¯æå…¶ä¸èƒ½å¿å—çš„ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œä»€ä¹ˆä¹Ÿä¸è¯´äº†ï¼Œæ’¸èµ·è¢–å­ï¼Œæƒ³åŠæ³•å»ä¼˜åŒ–å§ã€‚</p><h2 id="ä¼˜åŒ–æ–¹æ³•1ï¼ä»£ç åˆ†ç¦»ï¼ˆCode-Splittingï¼‰"><a href="#ä¼˜åŒ–æ–¹æ³•1ï¼ä»£ç åˆ†ç¦»ï¼ˆCode-Splittingï¼‰" class="headerlink" title="ä¼˜åŒ–æ–¹æ³•1ï¼ä»£ç åˆ†ç¦»ï¼ˆCode Splittingï¼‰"></a>ä¼˜åŒ–æ–¹æ³•1ï¼ä»£ç åˆ†ç¦»ï¼ˆCode Splittingï¼‰</h2><p>æˆ‘æœ€å¼€å§‹æƒ³åˆ°å¹¶ä½¿ç”¨çš„æ–¹æ³•å°±æ˜¯ï¼šCode Splittingï¼ˆä»£ç åˆ†ç¦»ï¼‰ï¼Œæ­£å¥½æˆ‘ä»¬å¯ä»¥å€ŸåŠ©webpackæ¥å®ç°è¿™é¡¹æŠ€æœ¯ã€‚<br>ä»€ä¹ˆæ˜¯webpack code splittingå‘¢? æ‚¨å¯ä»¥å‚è€ƒ<a href="https://webpack.github.io/docs/code-splitting.html" target="_blank" rel="external">è¿™é‡Œ</a>ï¼Œå¦‚æœè‹±è¯­é˜…è¯»åƒåŠ›ï¼Œå¯ä»¥å‚è€ƒä¸‹é¢å¼•æ–‡ï¼š</p><blockquote><p>code splittingå°±æ˜¯æŒ‡å°†æ–‡ä»¶åˆ†å‰²ä¸ºå—(chunk)ï¼Œwebpackä½¿æˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€äº›åˆ†å‰²ç‚¹(split point)ï¼Œæ ¹æ®è¿™äº›åˆ†å‰²ç‚¹å¯¹æ–‡ä»¶è¿›è¡Œåˆ†å—ï¼Œå¹¶å®ç°æŒ‰éœ€åŠ è½½ã€‚</p></blockquote><p>å› ä¸ºç¬”è€…ä½¿ç”¨äº†ReactæŠ€æœ¯æ ˆï¼Œå¹¶é‡‡ç”¨äº†react-routerï¼Œæ‰€ä»¥ä»£ç çš„åˆ’åˆ†ï¼ˆsplitï¼‰å°±å¯ä»¥æŒ‰ç…§è·¯ç”±å’ŒåŠ è½½æ—¶æœºè¿›è¡Œã€‚å…·ä½“æ“ä½œå¯ä»¥ä½¿ç”¨react-routerçš„getComponent apiæ¥å®ç°ï¼š</p><pre><code>&lt;Route path=&quot;home&quot; name=&quot;home&quot; getComponent={(nextState, cb) =&gt; {    require.ensure([], (require) =&gt; {        cb(null, require(&apos;../components/Home&apos;).default);    }, &apos;HomeView&apos;);}}&gt; </code></pre><p>åªæœ‰å½“å¯¹åº”è·¯ç”±è¢«è¯·æ±‚æ—¶ï¼Œç›¸åº”çš„ç»„ä»¶æ‰ä¼šè¢«åŠ è½½å‘ˆç°ã€‚</p><p>åŒæ—¶ï¼Œç¬”è€…ä½¿ç”¨äº†webpackçš„CommonChunkPluginæ’ä»¶æå–ç¬¬ä¸‰æ–¹ä»£ç ã€‚è¿™æ˜¯å‡ºäºä»€ä¹ˆè€ƒè™‘å‘¢ï¼Ÿ</p><p>ç»†å¿ƒçš„è¯»è€…å¯èƒ½ä¼šå‘ç°ä¸Šé¢çš„code splittingä¹Ÿè®¸ä¼šå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼š<br><strong>æŒ‰éœ€ï¼ˆæŒ‰è·¯ç”±ï¼‰å¼•å…¥èµ„æºåï¼Œè¿™äº›èµ„æºå¯èƒ½å­˜åœ¨å¤§é‡é‡å¤ä»£ç ã€‚å°¤å…¶æ˜¯æˆ‘ä»¬ä½¿ç”¨çš„ç¬¬ä¸‰æ–¹èµ„æºã€‚</strong><br>æƒ³æ˜ç™½è¿™ä¸ªé—®é¢˜ï¼Œè¿™æ—¶å€™ï¼Œä½ åº”è¯¥å°±ä¼šæ˜ç™½CommonChunkPluginè¿™ä¸ªæ’ä»¶çš„æ„ä¹‰äº†ã€‚å…³äºè¿™ä¸ªæ’ä»¶é…ç½®æ–¹æ³•æœ‰å¤šç§ï¼Œè¿™é‡Œæˆ‘ä»¬é‡‡ç”¨äº†ï¼šæœ‰é€‰æ‹©æ€§çš„æå–ï¼ˆå¯¹è±¡æ–¹å¼ä¼ å‚ï¼‰ï¼š</p><pre><code>{    &apos;entry&apos;: {        &apos;app&apos;: &apos;./src/index.js&apos;,        &apos;vendor&apos;: [            &apos;react&apos;,            &apos;react-redux&apos;,            &apos;redux&apos;,            &apos;react-router&apos;,            &apos;redux-thunk&apos;        ]    },    &apos;output&apos;: {        &apos;path&apos;: path.resolve(__dirname, &apos;./dist&apos;),        &apos;publicPath&apos;: &apos;/&apos;,        &apos;filename&apos;: &apos;static/js/[name].[hash].js&apos;,        &apos;chunkFilename&apos;: &apos;static/js/[name].[hash].js&apos;    },    &apos;plugins&apos;: [        new webpack.optimize.CommonsChunkPlugin({            name: [&apos;vendor&apos;], // å…¬å…±å—çš„å—åç§°            minChunks: Infinity, // æœ€å°è¢«å¼•ç”¨æ¬¡æ•°ï¼Œæœ€å°æ˜¯2ã€‚ä¼ é€’Infinityåªæ˜¯åˆ›å»ºå…¬å…±å—ï¼Œä½†ä¸ç§»åŠ¨æ¨¡å—ã€‚             filename: &apos;static/js/[name].[hash].js&apos;, // å…¬å…±å—çš„æ–‡ä»¶å        }),    ]}</code></pre><p>è¿™æ ·å­ï¼Œæˆ‘ä»¬æŠŠå…¬å…±ä»£ç ï¼ˆreactã€react-reduxã€reduxã€react-routerã€redux-thunkï¼‰ä¸“é—¨æŠ½å–åˆ°vendoræ¨¡å—ä¸­ã€‚</p><p>é€šè¿‡ä¸Šè¿°æ–¹æ³•ï¼Œç¬”è€…æ¬£å–œåœ°å‘ç°ï¼š<br>First meaningful paintæ—¶é—´ç”±19189.9msç¼©çŸ­åˆ°4584.3msï¼š</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-b7384bf2a9c9bb5a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ç»“æœ2"></p><p>è¿™æ— ç–‘æ˜¯æ¿€åŠ¨äººå¿ƒçš„ã€‚</p><h2 id="ä¼˜åŒ–æ–¹æ³•2ï¼Server-side-renderingï¼ˆæœåŠ¡ç«¯ç›´å‡ºï¼‰"><a href="#ä¼˜åŒ–æ–¹æ³•2ï¼Server-side-renderingï¼ˆæœåŠ¡ç«¯ç›´å‡ºï¼‰" class="headerlink" title="ä¼˜åŒ–æ–¹æ³•2ï¼Server side renderingï¼ˆæœåŠ¡ç«¯ç›´å‡ºï¼‰"></a>ä¼˜åŒ–æ–¹æ³•2ï¼Server side renderingï¼ˆæœåŠ¡ç«¯ç›´å‡ºï¼‰</h2><p>ä¹Ÿè®¸ä½ ä¸€ç›´åœ¨å¬è¯´è¿‡â€œæœåŠ¡ç«¯æ¸²æŸ“â€æˆ–è€…â€œæœåŠ¡ç«¯ç›´å‡ºâ€è¿™æ ·çš„åè¯ã€‚ä½†æ˜¯ä»æœªå®è·µè¿‡ï¼Œä¹Ÿä»æ¥æ²¡æœ‰äº†è§£è¿‡ä»–çš„æ„ä¹‰ã€‚å¥½å§ï¼Œè¿™é‡Œæˆ‘å…ˆæè¿°ä¸€ä¸‹ï¼Œåˆ°åº•ä»€ä¹ˆæ˜¯æœåŠ¡ç«¯ç›´å‡ºã€‚</p><p>æœåŠ¡ç«¯ç›´å‡ºï¼Œå…¶å®ç®€å•æ€»ç»“ä¸ºæœåŠ¡å™¨åœ¨æ¥åˆ°æ¥è‡ªæµè§ˆå™¨ç¬¬ä¸€æ¬¡è¯·æ±‚æ—¶ï¼Œä¾¿è¿”å›ä¸€ä¸ªâ€œåˆæ­¥æœ€ç»ˆâ€HTMLæ–‡æ¡£ã€‚è¿™ä¸ªHTMLæ–‡æ¡£å·²ç»è¿›è¡Œäº†æ•°æ®æ‹¼æ¥ã€‚è¿™æ ·ç”¨æˆ·èƒ½ä»¥æœ€å¿«çš„æ—¶é—´çœ‹åˆ°é¦–å±çš„æ•ˆæœï¼Œå½“ç„¶è¿™ä¸ªæ•ˆæœæ˜¯â€œé˜‰å‰²ç‰ˆâ€çš„ï¼Œéæœ€ç»ˆç‰ˆæœ¬ã€‚</p><p>è¿™ç§æ–¹å¼ä¸»è¦æ˜¯é’ˆå¯¹â€œå‰ååˆ†ç¦»â€çš„ä¼ ç»Ÿæ¨¡å¼ã€‚ä¼ ç»Ÿæ¨¡å¼ä¸­ï¼ŒæœåŠ¡å™¨è¿”å›HTMLæ–‡æ¡£ï¼Œä¹‹åæµè§ˆå™¨è§£ææ–‡æ¡£æ ‡ç­¾ï¼Œæ‹‰å–CSSï¼Œä¹‹åæ‹‰å–JSæ–‡ä»¶ã€‚JSæ–‡ä»¶åŠ è½½å®Œæˆä¹‹åï¼Œæ‰§è¡ŒJSå†…å®¹ï¼Œå¹¶å‘é€è¯·æ±‚è·å–æ•°æ®ã€‚æœ€ç»ˆï¼Œå°†æ•°æ®æ¸²æŸ“åœ¨é¡µé¢ä¸Šã€‚</p><p>ç”±æ­¤ï¼ŒServer side renderingæ–¹å¼å°†JSè¯·æ±‚æ•°æ®çš„è¿‡ç¨‹æ”¾åœ¨äº†æœåŠ¡å™¨ä¸Šï¼Œç”šè‡³å¯¹äºæ•°æ®ä¸HTMLç»“åˆå¤„ç†ä¹Ÿå¯ä»¥åœ¨æœåŠ¡å™¨ä¸Šåšã€‚</p><p>è¿™æ ·ä¸€æ¥ï¼Œ<strong>ä¸»è¦å°±æ˜¯åŠ å¿«äº†é¦–å±æ¸²æŸ“æ—¶é—´ã€‚</strong>å½“ç„¶ï¼Œä½¿ç”¨æœåŠ¡ç«¯æ¸²æŸ“ï¼Œè¿˜èƒ½å¤Ÿä¼˜åŒ–å‰ç«¯æ¸²æŸ“éš¾ä»¥å…‹æœçš„SEOé—®é¢˜ã€‚</p><p>ç†è®ºç†è§£èµ·æ¥å¾ˆç®€å•ï¼Œéš¾å¤„å°±åœ¨äºæœåŠ¡å™¨ç«¯ç¯å¢ƒçš„å‰ç«¯è„šæœ¬å¦‚ä½•å¤„ç†ï¼Œå¦‚ä½•ä¸å®¢æˆ·ç«¯ä¿æŒä¸€è‡´ã€‚</p><p>åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œæˆ‘ä½¿ç”¨äº†Expressä½œä¸ºnodeJSæ¡†æ¶ï¼Œç»“åˆreactï¼routerå®Œæˆï¼š</p><pre><code>server.use((req, res)=&gt; {    match({    &apos;routes&apos;: routes,    &apos;location&apos;: req.url    }, (error, redirectLocation, renderProps) =&gt; {        if (error) {            res.status(500).send(error.message);        }         else if (redirectLocation) {            res.redirect(302, redirectLocation.pathname + redirectLocation.search);        }         else if (renderProps) {            // Create a new Redux store instance            const store = configureStore();            // Render the component to a string            const html = renderToString(&lt;Provider store={store}&gt;&lt;RouterContext {...renderProps} /&gt;&lt;/Provider&gt;);            const preloadedState = store.getState();            fs.readFile(&apos;./dist/index.html&apos;, &apos;utf8&apos;, function (err, file) {                if (err) {                    return console.log(err);                }                let document = file.replace(/&lt;div id=&quot;app&quot;&gt;&lt;\/div&gt;/, `&lt;div id=&quot;app&quot;&gt;${html}&lt;/div&gt;`);                document = document.replace(/&apos;preloadedState&apos;/, `&apos;${JSON.stringify(preloadedState)}&apos;`);                res.setHeader(&apos;Cache-Control&apos;, &apos;public, max-age=31536000&apos;);                res.setHeader(&quot;Expires&quot;, new Date(Date.now() + 2592000000).toUTCString());                res.send(document);            });        }         else {            res.status(404).send(&apos;Not found&apos;)        }    });});</code></pre><p>é€šè¿‡ä¸Šè¿°æ–¹æ³•ï¼Œæˆ‘ä»¬æ¬£å–œåœ°å‘ç°ï¼š<br>First meaningful paintæ—¶é—´å·²ç»ç¼©çŸ­åˆ°921.5msï¼š</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-b4c9aa1eff18344c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ç»“æœ3"></p><p>è¿™æ— ç–‘æ˜¯ä»¤äººæŒ¯å¥‹çš„ã€‚</p><h2 id="ä¼˜åŒ–æ–¹æ³•3ï¼Compressed-static-assetsï¼ˆå‹ç¼©é™æ€æ–‡ä»¶ï¼‰"><a href="#ä¼˜åŒ–æ–¹æ³•3ï¼Compressed-static-assetsï¼ˆå‹ç¼©é™æ€æ–‡ä»¶ï¼‰" class="headerlink" title="ä¼˜åŒ–æ–¹æ³•3ï¼Compressed static assetsï¼ˆå‹ç¼©é™æ€æ–‡ä»¶ï¼‰"></a>ä¼˜åŒ–æ–¹æ³•3ï¼Compressed static assetsï¼ˆå‹ç¼©é™æ€æ–‡ä»¶ï¼‰</h2><p>å‹ç¼©æ–‡ä»¶ï¼Œå½“ç„¶æ˜¯ä¸€ä¸ªå®¹æ˜“æƒ³åˆ°è€Œä¸”è¡Œä¹‹æœ‰æ•ˆçš„æªæ–½ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä½¿ç”¨äº†webpackçš„CompressionPluginæ’ä»¶ï¼š</p><pre><code>{    &apos;plugins&apos;: [        new CompressionPlugin({            test: /\.js$|\.css$|\.html$/        })    ]}</code></pre><p>åŒæ—¶ï¼Œä½¿ç”¨express-static-gzipæ¥å¯¹æœåŠ¡ç«¯è¿›è¡Œé…ç½®ï¼š</p><pre><code>server.use(&apos;/static&apos;, expressStaticGzip(&apos;./dist/static&apos;, {    &apos;maxAge&apos;: 31536000,    setHeaders: function(res, path, stat) {    res.setHeader(&quot;Expires&quot;, new Date(Date.now() + 2592000000).toUTCString());        return res;    }}));</code></pre><p>express-static-gzipæ˜¯ä¸€ä¸ªå¤„äºexpress.staticä¹‹ä¸Šçš„ä¸­é—´ä»¶ã€‚å¦‚æœå¯¹äºæŒ‡å®šè·¯å¾„çš„æ–‡ä»¶æ²¡æœ‰æ‰¾åˆ°å‹ç¼©ç‰ˆæœ¬ï¼Œå°±ä½¿ç”¨ä¸ºå‹ç¼©ç‰ˆæœ¬è¿›è¡Œè¿”å›ã€‚</p><p>ç»è¿‡æ­¤å¤„ç†ï¼Œæˆ‘ä»¬ç¼©çŸ­äº†400msæ—¶é—´ï¼ŒOKï¼Œç°åœ¨First meaningful paintæ—¶é—´ä¸º546.6ms.</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-29234133ac7f9edd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ç»“æœ4"></p><h2 id="ä¼˜åŒ–æ–¹æ³•4ï¼Cachingï¼ˆç¼“å­˜ï¼‰"><a href="#ä¼˜åŒ–æ–¹æ³•4ï¼Cachingï¼ˆç¼“å­˜ï¼‰" class="headerlink" title="ä¼˜åŒ–æ–¹æ³•4ï¼Cachingï¼ˆç¼“å­˜ï¼‰"></a>ä¼˜åŒ–æ–¹æ³•4ï¼Cachingï¼ˆç¼“å­˜ï¼‰</h2><p>æˆªæ­¢åˆ°æ­¤ï¼Œæˆ‘ä»¬å·²ç»ä»æœ€åˆçš„19189.9mså·²ç»ä¼˜åŒ–åˆ°546msï¼Œæˆ‘ä»¬å½“ç„¶ç»§ç»­å¯ä»¥åœ¨å®¢æˆ·ç«¯è¿›è¡Œ<strong>é™æ€æ–‡ä»¶ç¼“å­˜</strong>æ¥ä½¿å¾—åŠ è½½æ—¶é—´å˜å¾—æ›´çŸ­ã€‚</p><p>ç¬”è€…ä½¿ç”¨äº†<a href="https://github.com/GoogleChrome/sw-toolbox" target="_blank" rel="external">sw-toolbox</a>æ­é…service workersè¿›è¡Œã€‚</p><blockquote><p>sw-toolboxï¼šA collection of service worker tools for offlining runtime requests.<br>Service Worker Toolbox provides some simple helpers for use in creating your own service workers. Specifically, it provides common caching strategies for dynamic content, such as API calls, third-party resources, and large or infrequently used local resources that you donâ€™t want precached.</p></blockquote><p>ç®€å•ç¿»è¯‘ä¸‹ï¼š<br>Service Workerå®ç°å¸¸è§è¿è¡Œæ—¶ç¼“å­˜æ¨¡å¼ï¼Œä¾‹å¦‚åŠ¨æ€å†…å®¹ã€APIè°ƒç”¨ä»¥åŠç¬¬ä¸‰æ–¹èµ„æºï¼Œå®ç°æ–¹æ³•å°±åƒç¼–å†™READMEä¸€æ ·ç®€å•ã€‚</p><p>ä¹Ÿè®¸åˆ°è¿™é‡Œä½ ä¸€å¤´é›¾æ°´ï¼Œæ²¡å…³ç³»ï¼Œæˆ‘ä»¬ä»æœ€åˆå¼€å§‹ï¼Œäº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯service worker:</p><blockquote><p>åœ¨2014å¹´ï¼ŒW3Cå…¬å¸ƒäº†service workerçš„è‰æ¡ˆï¼Œservice workeræä¾›äº†å¾ˆå¤šæ–°çš„èƒ½åŠ›ï¼Œä½¿å¾—web appæ‹¥æœ‰ä¸native appç›¸åŒçš„ç¦»çº¿ä½“éªŒã€æ¶ˆæ¯æ¨é€ä½“éªŒã€‚<br>service workeræ˜¯ä¸€æ®µè„šæœ¬ï¼Œä¸web workerä¸€æ ·ï¼Œä¹Ÿæ˜¯åœ¨åå°è¿è¡Œã€‚<br>ä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„çº¿ç¨‹ï¼Œè¿è¡Œç¯å¢ƒä¸æ™®é€šè„šæœ¬ä¸åŒï¼Œæ‰€ä»¥ä¸èƒ½ç›´æ¥å‚ä¸webäº¤äº’è¡Œä¸ºã€‚native appå¯ä»¥åšåˆ°ç¦»çº¿ä½¿ç”¨ã€æ¶ˆæ¯æ¨é€ã€åå°è‡ªåŠ¨æ›´æ–°ï¼Œservice workerçš„å‡ºç°æ˜¯æ­£æ˜¯ä¸ºäº†ä½¿å¾—web appä¹Ÿå¯ä»¥å…·æœ‰ç±»ä¼¼çš„èƒ½åŠ›ã€‚</p></blockquote><p>è€Œsw-toolboxï¼Œé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯service workerä¸€ä¸ªtoolboxï¼Œå…·ä½“æˆ‘ä»¬çœ‹ä»£ç ï¼š</p><pre><code>toolbox.router.get(&apos;(.*).js&apos;, toolbox.fastest, {    &apos;origin&apos;:/.herokuapp.com|localhost|maps.googleapis.com/,    &apos;mode&apos;:&apos;cors&apos;,    &apos;cache&apos;: {        &apos;name&apos;: `js-assets-${VERSION}`,        &apos;maxEntries&apos;: 50,        &apos;maxAgeSeconds&apos;: 2592e3    }});</code></pre><p>ä¸Šé¢ä»£ç çš„æ„æ€æ˜¯ï¼Œæˆ‘ä»¬å¯¹äºgetç±»å‹çš„è¯·æ±‚ï¼Œå½“è¯·æ±‚å†…å®¹ä¸ºjsè„šæœ¬æ—¶ï¼Œåº”ç”¨toolbox.fastest handlerå¤„ç†ã€‚<br>toolbox.fastestæŒ‡ç¤ºï¼šå¯¹äºè¿™ä¸ªè¯·æ±‚ï¼Œæˆ‘ä»¬æ—¢ä»ç¼“å­˜ä¸­è·å–ï¼Œä¹ŸåŒæ—¶é€šè¿‡æ­£å¸¸çš„è¯·æ±‚networkè·å–ã€‚<strong>è¿™ä¸¤ç§æ–¹å¼å“ªä¸ªè¿”å›å¿«ï¼Œå°±åº”ç”¨å“ªä¸€ä¸ªã€‚</strong><br>å¦å¤–ï¼Œtoolbox.router.getçš„ç¬¬ä¸‰ä¸ªå‚æ•°è¡¨ç¤ºé…ç½®é¡¹ã€‚</p><p>è€ƒè™‘å‘¨åˆ°çš„è¯»è€…å¯èƒ½ä¼šæƒ³ï¼Œä¸Šé¢æ˜¯å¯¹äºæ”¯æŒService workerçš„æµè§ˆå™¨ï¼Œé‚£ä¹ˆå¯¹äºä¸æ”¯æŒçš„æµè§ˆå™¨å‘¢ï¼Ÿæˆ‘ä»¬å¹²è„†è®¾ç½®ï¼š</p><pre><code>res.setHeader(&quot;Expires&quot;, new Date(Date.now() + 2592000000).toUTCString());</code></pre><p>é€šè¿‡è¿™æ ·å¤„ç†ï¼Œæˆ‘ä»¬æ¥ç›´è§‚æ„Ÿå—ä¸€ä¸‹é¡µé¢åŠ è½½ç€‘å¸ƒæµï¼š</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-1a5ca5dd910efece.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ä½¿ç”¨Service worker"></p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-456cb5a07f1acd0b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ä¸ä½¿ç”¨Service worker"></p><h2 id="ä¼˜åŒ–æ–¹æ³•5ï¼Preload-and-then-loadï¼ˆé¢„åŠ è½½ï¼å»¶ååŠ è½½ï¼‰"><a href="#ä¼˜åŒ–æ–¹æ³•5ï¼Preload-and-then-loadï¼ˆé¢„åŠ è½½ï¼å»¶ååŠ è½½ï¼‰" class="headerlink" title="ä¼˜åŒ–æ–¹æ³•5ï¼Preload and then loadï¼ˆé¢„åŠ è½½ï¼å»¶ååŠ è½½ï¼‰"></a>ä¼˜åŒ–æ–¹æ³•5ï¼Preload and then loadï¼ˆé¢„åŠ è½½ï¼å»¶ååŠ è½½ï¼‰</h2><p>å¦‚æœä½ è¿˜æ²¡å¬è¯´è¿‡â€œPreloadâ€ï¼Œä¸è¦ç´§ã€‚æˆ‘ä»¬è¿™å°±æ¥äº†è§£ä¸€ä¸‹ï¼š</p><blockquote><p>Preloadä½œä¸ºä¸€ä¸ªæ–°çš„webæ ‡å‡†ï¼Œæ—¨åœ¨æé«˜æ€§èƒ½å’Œä¸ºwebå¼€å‘äººå‘˜æä¾›æ›´ç»†ç²’åº¦çš„åŠ è½½æ§åˆ¶ã€‚Preloadä½¿å¼€å‘è€…èƒ½å¤Ÿè‡ªå®šä¹‰èµ„æºçš„åŠ è½½é€»è¾‘ï¼Œä¸”æ— éœ€å¿å—åŸºäºè„šæœ¬çš„èµ„æºåŠ è½½å™¨å¸¦æ¥çš„æ€§èƒ½æŸå¤±ã€‚</p></blockquote><p>æ¢æˆä½ èƒ½å¬æ˜ç™½çš„è¯æ¥è¯´ï¼š<br><strong>preloadå»ºè®®å…è®¸å§‹ç»ˆé¢„åŠ è½½æŸäº›èµ„æºï¼Œæµè§ˆå™¨å¿…é¡»è¯·æ±‚preloadæ ‡è®°çš„èµ„æºã€‚</strong></p><p>è¿™æ ·å­ï¼Œç©¶ç«Ÿæœ‰ä»€ä¹ˆæ„ä¹‰å‘¢ï¼Ÿ<br>ä¸¾ä¸ªä¾‹å­ï¼šæ¯”å¦‚ä¸€äº›éšè—åœ¨CSSå’ŒJavascriptä¸­çš„èµ„æºã€‚<br>å½“æµè§ˆå™¨å‘ç°è‡ªå·±éœ€è¦è¿™äº›èµ„æºæ—¶å·²ç»ä¸ºæ—¶å·²æ™šï¼Œæ‰€ä»¥å¤§å¤šæ•°æƒ…å†µï¼Œè¿™äº›èµ„æºçš„åŠ è½½éƒ½ä¼šå¯¹é¡µé¢æ¸²æŸ“é€ æˆå»¶è¿Ÿã€‚</p><p>preloadçš„å‡ºç°å°±æ˜¯ä¸ºäº†ä¼˜åŒ–è¿™ä¸ªè¿‡ç¨‹ã€‚<br>å¯¹äºpreloadçš„å…¼å®¹æ€§ï¼Œå¯ä»¥å‚è€ƒ<a href="http://caniuse.com/#search=preload" target="_blank" rel="external">è¿™é‡Œã€‚</a></p><p>å¯¹äºä¸æ”¯æŒpreloadçš„æµè§ˆå™¨ï¼Œç¬”è€…ä½¿ç”¨äº†prefetchæ¥å¤„ç†ã€‚<br>ä½†äºpreloadä¸åŒï¼Œprefetchçš„ä½œç”¨æ˜¯å‘Šè¯‰æµè§ˆå™¨åŠ è½½ä¸‹ä¸€é¡µé¢å¯èƒ½ä¼šç”¨åˆ°çš„èµ„æºï¼Œæ³¨æ„ï¼Œæ˜¯ä¸‹ä¸€é¡µé¢ï¼Œè€Œä¸æ˜¯å½“å‰é¡µé¢ã€‚å› æ­¤è¯¥æ–¹æ³•çš„åŠ è½½ä¼˜å…ˆçº§éå¸¸ä½ã€‚</p><p>è¿™äº›æ–°æ ‡å‡†å…¶å®å¾ˆæœ‰æ„æ€ï¼Œé‡Œé¢çš„å†…å®¹è¿œä¸æ­¢è¿™äº›ã€‚æœ‰å…´è¶£çš„åŒå­¦å¯ä»¥è‡ªè¡Œäº†è§£ï¼Œä¹Ÿæ¬¢è¿ä¸æˆ‘è®¨è®ºã€‚</p><p>å›åˆ°æ­£é¢˜ï¼Œæˆ‘åœ¨headæ ‡ç­¾ä¸­ä½¿ç”¨ï¼š</p><pre><code>&lt;link rel=&quot;preload&quot; ... as=&quot;script&quot;&gt;</code></pre><p>æœ€ç»ˆä¼˜åŒ–çš„ç»“æœå¦‚å›¾ï¼š</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-8823ee4b69444430.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æœ€ç»ˆç»“æœ"></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å…¶å®ï¼Œä½¿ç”¨Reactï¼‹Webpackåšå‡ºä¸€ä¸ªUberå·²ç»ä¸æ˜¯é‡ç‚¹äº†ã€‚çœŸæ­£æ¿€åŠ¨äººå¿ƒçš„æ˜¯æ•´å¥—æµç¨‹çš„ä¼˜åŒ–ä¹‹è·¯ã€‚æˆ‘ä»¬ä½¿ç”¨äº†å¤§é‡æˆç†Ÿçš„ã€æœªæˆç†Ÿï¼ˆæ–°æŠ€æœ¯ï¼‰ï¼Œå¸Œæœ›å¯¹è¯»è€…æœ‰æ‰€å¯å‘ï¼</p><p>Happy Coding!</p><p>PS: ä½œè€…<a href="https://github.com/HOUCe" target="_blank" rel="external">Githubä»“åº“</a>ï¼Œæ¬¢è¿é€šè¿‡ä»£ç å„ç§å½¢å¼äº¤æµã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;ä¹‹å‰åˆ†äº«è¿‡å‡ ç¯‡å…³äºReactæŠ€æœ¯æ ˆçš„åŸåˆ›æ–‡ç« ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://www.jianshu.com/p/7a56ac1de2a8&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;è§£æTwitterå‰ç«¯æ¶æ„ å­¦ä¹ å¤æ‚åœºæ™¯æ•°
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="https://exp-team.github.io/blog/2017/06/18/js/react_bind_this/"/>
    <id>https://exp-team.github.io/blog/2017/06/18/js/react_bind_this/</id>
    <published>2017-06-18T07:13:22.000Z</published>
    <updated>2017-06-18T07:13:22.000Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨ Javascript è¯­è¨€ä¸­ï¼Œå…³äº this è¿™ä¸ªå…³é”®å­—çš„è¡Œä¸ºä¸€ç›´ä»¥æ¥å›°æ‰°ç€ä¸€ä»£åˆä¸€ä»£åˆçº§å¼€å‘è€…ã€‚ä½†æ˜¯è¯·åˆ«è¯¯ä¼šï¼Œè¿™ç¯‡æ–‡ç« å¹¶ä¸ä¼šå¯¹ this çš„åŸºæœ¬ç‰¹å¾è¿›è¡Œå…¨æ–¹ä½è®²è§£ï¼Œå› ä¸ºè¿™äº›å†…å®¹éƒ½å¯ä»¥åœ¨å„ç§å‰ç«¯ä¹¦ç±ä¸­æ‰¾åˆ°ç­”æ¡ˆã€‚æˆ‘è¯•å›¾ç»“åˆ React äº‹ä»¶å¤„ç†å‡½æ•°å¯¹ this çš„ç»‘å®šæ¼”åŒ–å²ï¼Œè°ˆä¸€è°ˆè¿™ä¸ªæ¡†æ¶ä»¥åŠ javascript è¯­è¨€åœ¨è¿™ä¸€ç»†èŠ‚ä¸Šçš„ä¸æ–­è¿›æ­¥å’Œå®Œå–„ã€‚åŒæ—¶å¯¹æ¯” this ç»‘å®šçš„ä¸åŒæ–¹æ¡ˆï¼Œè®©å¤§å®¶å¯¹ React ã€ES next æœ‰ä¸€ä¸ªæ›´æ¸…æ™°çš„è®¤è¯†ã€‚</p><p>React å¤„ç† this ä¸Šä¸‹æ–‡ç¯å¢ƒå·²ç»æœ‰è‡³å°‘äº”å¹´å†å²äº†ã€‚æœŸé—´æ–¹æ¡ˆè¾ˆå‡ºï¼Œæˆ‘ä»¬å…ˆæ¥æ€»ç»“ä¸€ä¸‹ã€‚</p><h2 id="æ–¹æ³•ä¸€ï¼šReact-createClassè‡ªåŠ¨ç»‘å®š"><a href="#æ–¹æ³•ä¸€ï¼šReact-createClassè‡ªåŠ¨ç»‘å®š" class="headerlink" title="æ–¹æ³•ä¸€ï¼šReact.createClassè‡ªåŠ¨ç»‘å®š"></a>æ–¹æ³•ä¸€ï¼šReact.createClassè‡ªåŠ¨ç»‘å®š</h2><p>React ä¸­åˆ›å»ºç»„ä»¶çš„æ–¹å¼å·²ç»å¾ˆå¤šï¼Œæ¯”è¾ƒå¤è€çš„è¯¸å¦‚ React.createClass åº”è¯¥å¾ˆå¤šäººå¹¶ä¸é™Œç”Ÿã€‚å½“ç„¶ï¼Œä» React 0.13 å¼€å§‹ï¼Œå¯ä»¥ä½¿ç”¨ ES6 Class ä»£æ›¿ React.createClass äº†ï¼Œè¿™åº”è¯¥æ˜¯ä»Šåæ¨èçš„æ–¹æ³•ã€‚ä½†æ˜¯éœ€è¦çŸ¥é“ï¼ŒReact.createClass åˆ›å»ºçš„ç»„ä»¶å†…ï¼Œå¯ä»¥è‡ªåŠ¨ç»‘å®š thisã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œthis è¿™ä¸ªå…³é”®å­—ä¼šè‡ªåŠ¨ç»‘å®šåœ¨ç»„ä»¶å®ä¾‹ä¸Šé¢ã€‚</p><pre><code>// This magically works with React.createClass// because `this` is bound for you.onChange = {this.handleChange}</code></pre><p>å½“ç„¶å¾ˆé—æ†¾ï¼Œæˆªè‡³ç›®å‰ï¼Œå®˜æ–¹å·²ç»æ˜ç¡®æŒ‡å‡ºæ›´æ¨èä½¿ç”¨ class å£°æ˜ç»„ä»¶æˆ– functional æ— çŠ¶æ€ç»„ä»¶ï¼š</p><blockquote><p>Later, classes were added to the language as part of ES2015, so we added the ability to create React components using JavaScript classes. Along with functional components, JavaScript classes are now the preferred way to create components in React.<br>For your existing createClass components, we recommend that you migrate them to JavaScript classes. </p></blockquote><p>æˆ‘è®¤ä¸ºï¼Œè¿™å…¶å®æ˜¯ React æ¡†æ¶æœ¬èº«çš„è‡ªæˆ‘å®Œå–„å’Œå‡†ç¡®è¿åˆæœªæ¥ï¼Œæ˜¯æ¡†æ¶å’Œè¯­è¨€å‘å±•çš„å¤§åŠ¿æ‰€è¶‹ã€‚</p><h2 id="æ–¹æ³•äºŒï¼šæ¸²æŸ“æ—¶ç»‘å®š"><a href="#æ–¹æ³•äºŒï¼šæ¸²æŸ“æ—¶ç»‘å®š" class="headerlink" title="æ–¹æ³•äºŒï¼šæ¸²æŸ“æ—¶ç»‘å®š"></a>æ–¹æ³•äºŒï¼šæ¸²æŸ“æ—¶ç»‘å®š</h2><p>é€šè¿‡å‰æ–‡ï¼Œæˆ‘ä»¬çŸ¥é“ä¼ ç»Ÿçš„ç»„ä»¶åˆ›å»ºæ–¹å¼ä¸ä¼šæœ‰ this ç»‘å®šçš„å›°æ‰°ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å‡å®šæ‰€æœ‰çš„ç»„ä»¶éƒ½é‡‡å– ES6 classes æ–¹å¼å£°æ˜ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œthis æ— æ³•è‡ªåŠ¨ç»‘å®šã€‚ä¸€ä¸ªå¸¸è§çš„è§£å†³æ–¹æ¡ˆä¾¿æ˜¯ï¼š</p><pre><code>onChange = {this.handleChange.bind(this)}</code></pre><p>è¿™ç§æ–¹æ³•ç®€æ˜æ‰¼è¦ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªæ½œåœ¨çš„æ€§èƒ½é—®é¢˜ï¼šå½“ç»„ä»¶æ¯æ¬¡é‡æ–°æ¸²æŸ“æ—¶ï¼Œéƒ½ä¼šæœ‰ä¸€ä¸ªæ–°çš„å‡½æ•°åˆ›å»ºã€‚è¿™å¬ä¸Šå»è²Œä¼¼æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„é—®é¢˜ï¼Œä½†æ˜¯å…¶å®åœ¨çœŸæ­£çš„å¼€å‘åœºæ™¯ä¸­å› æ­¤å¼•å‘çš„æ€§èƒ½é—®é¢˜å¾€å¾€ä¸å€¼ä¸€æï¼ˆé™¤éæ˜¯å¤§å‹ç»„ä»¶æ¶ˆè´¹ç±»åº”ç”¨æˆ–æ¸¸æˆï¼‰ã€‚</p><h2 id="æ–¹æ³•ä¸‰ï¼šç®­å¤´å‡½æ•°ç»‘å®š"><a href="#æ–¹æ³•ä¸‰ï¼šç®­å¤´å‡½æ•°ç»‘å®š" class="headerlink" title="æ–¹æ³•ä¸‰ï¼šç®­å¤´å‡½æ•°ç»‘å®š"></a>æ–¹æ³•ä¸‰ï¼šç®­å¤´å‡½æ•°ç»‘å®š</h2><p>è¿™ç§æ–¹æ³•å…¶å®å’Œç¬¬äºŒç§ç±»ä¼¼ï¼Œæ‹œ ES6 ç®­å¤´å‡½æ•°æ‰€èµï¼Œæˆ‘ä»¬å¯ä»¥éšå¼ç»‘å®š thisï¼š</p><pre><code>onChange = {e =&gt; this.handleChange(e)}</code></pre><p>å½“ç„¶ï¼Œå®ƒåŒæ ·å­˜åœ¨æ½œåœ¨çš„æ€§èƒ½é—®é¢˜ã€‚<br>ä¸‹é¢å°†è¦ä»‹ç»çš„ä¸¤ç§æ–¹æ³•ï¼Œå¯ä»¥æœ‰æ•ˆè§„é¿æ­¤é—®é¢˜ï¼Œè¯·ç»§ç»­å…³æ³¨ã€‚</p><h2 id="æ–¹æ³•å››ï¼šConstructor-å†…ç»‘å®š"><a href="#æ–¹æ³•å››ï¼šConstructor-å†…ç»‘å®š" class="headerlink" title="æ–¹æ³•å››ï¼šConstructor å†…ç»‘å®š"></a>æ–¹æ³•å››ï¼šConstructor å†…ç»‘å®š</h2><p>constructoræ–¹æ³•æ˜¯ç±»çš„é»˜è®¤æ–¹æ³•ï¼Œé€šè¿‡newå‘½ä»¤ç”Ÿæˆå¯¹è±¡å®ä¾‹æ—¶ï¼Œè‡ªåŠ¨è°ƒç”¨è¯¥æ–¹æ³•ã€‚<br>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ï¼š</p><pre><code>constructor(props) {    super(props);    this.handleChange = this.handleChange.bind(this);}</code></pre><p>è¿™ç§æ–¹å¼å¾€å¾€è¢«æ¨èä¸ºâ€œæœ€ä½³å®è·µâ€ï¼Œä¹Ÿæ˜¯ç¬”è€…æœ€ä¸ºå¸¸ç”¨çš„æ–¹æ³•ã€‚<br>ä½†æ˜¯å°±ä¸ªäººä¹ æƒ¯è€Œè¨€ï¼Œæˆ‘è®¤ä¸ºä¸å‰ä¸¤ç§æ–¹æ³•ç›¸æ¯”ï¼Œconstructor å†…ç»‘å®šåœ¨å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ä¸Šä¹Ÿè®¸æœ‰äº›æ¬ ç¼ºã€‚<br>åŒæ—¶ï¼Œæˆ‘ä»¬çŸ¥é“åœ¨ constructor å£°æ˜çš„æ–¹æ³•ä¸ä¼šå­˜åœ¨å®ä¾‹çš„åŸå‹ä¸Šï¼Œè€Œè½äºå®ä¾‹æœ¬èº«çš„æ–¹æ³•ã€‚æ¯ä¸ªå®ä¾‹éƒ½æœ‰åŒæ ·ä¸€ä¸ª handleChange æ–¹æ³•ï¼Œæœ¬èº«ä¹Ÿæ˜¯ä¸€ç§é‡å¤å’Œæµªè´¹ã€‚</p><p>å¦‚æœä½ å¯¹ ES next ä¸€ç›´æŠ±æœ‰å¼€æ”¾çš„æ€æƒ³ï¼Œä¸”èƒ½å¤Ÿä½¿ç”¨ stage-2 çš„ç‰¹æ€§ï¼Œä¸å¦¨å°è¯•ä¸€ä¸‹æœ€åä¸€ç§æ–¹æ¡ˆã€‚</p><h2 id="æ–¹æ³•äº”ï¼šClass-å±æ€§ä¸­ä½¿ç”¨-å’Œç®­å¤´å‡½æ•°"><a href="#æ–¹æ³•äº”ï¼šClass-å±æ€§ä¸­ä½¿ç”¨-å’Œç®­å¤´å‡½æ•°" class="headerlink" title="æ–¹æ³•äº”ï¼šClass å±æ€§ä¸­ä½¿ç”¨ = å’Œç®­å¤´å‡½æ•°"></a>æ–¹æ³•äº”ï¼šClass å±æ€§ä¸­ä½¿ç”¨ = å’Œç®­å¤´å‡½æ•°</h2><p>è¿™ä¸ªæ–¹æ³•ä¾èµ–äº ES next çš„æ–°ç‰¹æ€§ï¼Œè¯·å‚è€ƒ<a href="https://tc39.github.io/proposal-class-public-fields/" target="_blank" rel="external">tc 39: Public Class Fields</a></p><pre><code>handleChange = () =&gt; {      // call this function from render       // and this.whatever in here works fine.};</code></pre><p>æˆ‘ä»¬æ¥æ€»ç»“ä¸€ä¸‹è¿™ç§æ–¹å¼çš„ä¼˜ç‚¹ï¼š</p><ul><li>ä½¿ç”¨ç®­å¤´å‡½æ•°ï¼Œæœ‰æ•ˆç»‘å®šäº† thisï¼›</li><li>æ²¡æœ‰ç¬¬äºŒç§æ–¹æ³•å’Œç¬¬ä¸‰ç§æ–¹æ³•çš„æ½œåœ¨æ€§èƒ½é—®é¢˜ï¼›</li><li>é¿å…äº†æ–¹æ³•å››çš„ç»„ä»¶å®ä¾‹é‡å¤é—®é¢˜ï¼›</li><li>æˆ‘ä»¬å¯ä»¥ç›´æ¥ä» ES5 createClass é‡æ„ã€‚</li></ul><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ¬æ–‡åœ¨å¯¹æ¯” React ç»‘å®š this çš„äº”ç§æ–¹æ³•åŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿç”±è¿œåŠè¿‘äº†è§£äº† javascript è¯­è¨€çš„å‘å±•ï¼šä» ES5 çš„ bindï¼Œ åˆ° ES6 çš„ç®­å¤´å‡½æ•°ï¼Œå†åˆ° ES next å¯¹ class çš„æ”¹è¿›ã€‚React ä½œä¸ºè“¬å‹ƒå‘å±•çš„æ¡†æ¶ä¹ŸåŒæ ·åœ¨ä¸æ—¶å…·è¿›ï¼Œä¸æ–­å®Œå–„ã€‚</p><p>æœ€åï¼Œæˆ‘ä»¬é€šè¿‡è¿™å¼ å›¾ç‰‡æ¥å®Œæ•´å›é¡¾ï¼š</p><p>æœ¬æ–‡å‚è€ƒäº† Cory House çš„æ–‡ç« ï¼š<a href="https://medium.freecodecamp.com/react-binding-patterns-5-approaches-for-handling-this-92c651b5af56" target="_blank" rel="external">5 Approaches for Handling <code>this</code></a>ï¼Œå¹¶åœ¨æ­¤åŸºç¡€ä¸Šè¿›è¡Œå»¶ä¼¸ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;åœ¨ Javascript è¯­è¨€ä¸­ï¼Œå…³äº this è¿™ä¸ªå…³é”®å­—çš„è¡Œä¸ºä¸€ç›´ä»¥æ¥å›°æ‰°ç€ä¸€ä»£åˆä¸€ä»£åˆçº§å¼€å‘è€…ã€‚ä½†æ˜¯è¯·åˆ«è¯¯ä¼šï¼Œè¿™ç¯‡æ–‡ç« å¹¶ä¸ä¼šå¯¹ this çš„åŸºæœ¬ç‰¹å¾è¿›è¡Œå…¨æ–¹ä½è®²è§£ï¼Œå› ä¸ºè¿™äº›å†…å®¹éƒ½å¯ä»¥åœ¨å„ç§å‰ç«¯ä¹¦ç±ä¸­æ‰¾åˆ°ç­”æ¡ˆã€‚æˆ‘è¯•å›¾ç»“åˆ React äº‹ä»¶å¤„ç†å‡½æ•°å¯¹ this çš„ç»‘å®šæ¼”åŒ–
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>JSå†»ç»“å¯¹è±¡çš„ã€Šäººé—´è¯è¯ã€‹ å®Œç¾å®ç°ç©¶ç«Ÿæœ‰å‡ å±‚ï¼Ÿ</title>
    <link href="https://exp-team.github.io/blog/2017/06/09/js/freeze-obj/"/>
    <id>https://exp-team.github.io/blog/2017/06/09/js/freeze-obj/</id>
    <published>2017-06-08T16:00:00.000Z</published>
    <updated>2017-06-06T08:34:06.000Z</updated>
    
    <content type="html"><![CDATA[<p>ç‹å›½ç»´åœ¨ã€Šäººé—´è¯è¯ã€‹é‡Œè°ˆåˆ°äº†æ²»å­¦ç»éªŒï¼Œä»–è¯´ï¼šâ€œå¤ä»Šä¹‹æˆå¤§äº‹ä¸šã€å¤§å­¦é—®è€…ï¼Œå¿…ç»è¿‡ä¸‰ç§ä¹‹å¢ƒç•Œã€‚â€</p><p>å·§åˆçš„æ˜¯ï¼Œæœ€è¿‘å— <a href="http://gitbook.cn/" target="_blank" rel="external">git chat ï¼ git book</a> é‚€è¯·ï¼Œåšäº†ä¸€ä¸ªåˆ†äº«ã€‚<br>å…¶ä¸­è°ˆåˆ°JSä¸­å†»ç»“ä¸€ä¸ªå¯¹è±¡å‡ ç§ç”±æµ…å…¥æ·±çš„å®è·µã€‚æƒ³æƒ³ä¹Ÿæš—åˆå›½å­¦å¤§å¸ˆæ‰€è°“çš„ä¸‰é‡å¢ƒç•Œã€‚</p><p>è¿™ç¯‡æ–‡ç« ç”±æµ…å…¥æ·±è®¨è®ºJSä¸­å¯¹è±¡çš„ä¸€äº›é”å®šç‰¹æ€§ã€‚ä½†éƒ½æ˜¯ä¸€äº›åŸºç¡€è¯­æ³•çš„å®ç°ï¼Œç›¸ä¿¡å³ä¾¿æ˜¯å‰ç«¯å°ç™½ä¹Ÿå¯ä»¥å¤§ä½“é¢†ä¼šã€‚ä¸è¿‡éœ€è¦è¯»è€…é¢„å…ˆäº†è§£JSä¸­å¯¹è±¡çš„ç‰¹æ€§ï¼Œå°¤å…¶æ˜¯å¯¹è±¡è‡ªèº«å±æ€§çš„æè¿°ç¬¦ï¼šconfigurableã€writableâ€¦</p><p>å¦å¤–ï¼Œå¦‚æœæ‚¨å¯¹JSä¸­å¯¹è±¡æ“ä½œã€ä¸å¯å˜æ•°æ®ã€å‡½æ•°å¼ç¼–ç¨‹æ„Ÿå…´è¶£ï¼ŒåŒæ ·æ¨èæˆ‘çš„å…¶ä»–ä¸€äº›ç›¸å…³æ–‡ç« ï¼š</p><ul><li><a href="http://www.jianshu.com/p/11fc75f28302" target="_blank" rel="external">å¦‚ä½•ä¼˜é›…å®‰å…¨åœ°åœ¨æ·±å±‚æ•°æ®ç»“æ„ä¸­å–å€¼</a></li><li><a href="http://www.jianshu.com/p/89f1d4245b20" target="_blank" rel="external">ä»JSå¯¹è±¡å¼€å§‹ï¼Œè°ˆä¸€è°ˆâ€œä¸å¯å˜æ•°æ®â€å’Œå‡½æ•°å¼ç¼–ç¨‹</a></li><li><a href="http://www.jianshu.com/p/7a56ac1de2a8" target="_blank" rel="external">è§£æTwitterå‰ç«¯æ¶æ„ å­¦ä¹ å¤æ‚åœºæ™¯æ•°æ®è®¾è®¡</a></li></ul><p>ç­‰ç­‰ã€‚</p><h2 id="æ˜¨å¤œè¥¿é£å‡‹ç¢§æ ‘-ç‹¬ä¸Šé«˜æ¥¼-æœ›å°½å¤©æ¶¯è·¯"><a href="#æ˜¨å¤œè¥¿é£å‡‹ç¢§æ ‘-ç‹¬ä¸Šé«˜æ¥¼-æœ›å°½å¤©æ¶¯è·¯" class="headerlink" title="æ˜¨å¤œè¥¿é£å‡‹ç¢§æ ‘ ç‹¬ä¸Šé«˜æ¥¼ æœ›å°½å¤©æ¶¯è·¯"></a>æ˜¨å¤œè¥¿é£å‡‹ç¢§æ ‘ ç‹¬ä¸Šé«˜æ¥¼ æœ›å°½å¤©æ¶¯è·¯</h2><p>ç¬¬ä¸€ç§å¢ƒç•Œï¼šâ€œæ˜¨å¤œè¥¿é£å‡‹ç¢§æ ‘ï¼Œç‹¬ä¸Šé«˜æ¥¼ï¼Œæœ›å°½å¤©æ¶¯è·¯ã€‚â€<br>è¯¥è¯å¥å‡ºè‡ªæ™æ®Šçš„ã€Šè¶æ‹èŠ±ã€‹ï¼ŒåŸæ„æ˜¯è¯´ï¼Œâ€œæˆ‘â€ä¸Šé«˜æ¥¼çœºæœ›æ‰€è§çš„æ›´ä¸ºè§é£’çš„ç§‹æ™¯ï¼Œè¥¿é£é»„å¶ï¼Œå±±é˜”æ°´é•¿ï¼Œæ¡ˆä¹¦ä½•è¾¾ï¼Ÿ</p><p>ç‹å›½ç»´æ­¤å¥ä¸­è§£æˆï¼šåšå­¦é—®æˆå¤§äº‹ä¸šè€…ï¼Œé¦–å…ˆè¦æœ‰æ‰§ç€çš„è¿½æ±‚ï¼Œç™»é«˜æœ›è¿œï¼Œç°å¯Ÿè·¯å¾„ï¼Œæ˜ç¡®ç›®æ ‡ä¸æ–¹å‘ï¼Œäº†è§£äº‹ç‰©çš„æ¦‚è²Œã€‚</p><p> <strong>æˆ‘ä»¬å°±ä»æœ€åŸºæœ¬çš„åœºæ™¯è¯´èµ·ï¼Œç©¶ç«Ÿä¸ºä»€ä¹ˆè¦å†»ç»“ä¸€ä¸ªå¯¹è±¡ï¼Ÿ</strong></p><ul><li><p>åœºæ™¯ä¸€ï¼š<br>æˆ‘ä»¬é€ äº†ä¸€ä¸ªè½®å­ï¼Œå¯¹å¤–æš´éœ²ä¸€ä¸ªå¯¹è±¡ï¼Œå¼€æ”¾å‡ºæ¥ç»™ç¬¬ä¸‰æ–¹ä½¿ç”¨ã€‚åŒæ—¶éœ€è¦ä¿è¯è¿™ä¸ªå¯¹å¤–æš´éœ²çš„å¯¹è±¡å®Œå…¨å®‰å…¨ï¼Œä¸èƒ½è¢«ä¸šåŠ¡ä»£ç æ‰€æ”¹å†™è¦†ç›–æˆ–ä¸‹é’©å­ï¼ˆhookï¼‰å‡½æ•°ã€‚</p></li><li><p>åœºæ™¯äºŒï¼š<br>å¦‚æœä½ çœ‹è¿‡Vue 2.* ç‰ˆæœ¬æºç ï¼Œä½ ä¼šå‘ç°å†»ç»“ä¸€ä¸ªå¯¹è±¡çš„æ“ä½œé¢‘ç¹å‡ºç°ã€‚</p></li></ul><p><strong>æˆ‘ä»¬å…ˆæ¥çœ‹å†»ç»“å¯¹è±¡çš„ç¬¬ä¸€å±‚å®ç° â€”â€” æ‰©å±•ç‰¹æ€§é”ï¼š</strong></p><p>ä»–åŒ…å«äº†ä¸¤ä¸ªåŸºæœ¬æ–¹æ³•ï¼š</p><ul><li>Object.isExtensible</li><li>Object.preventExtensions</li></ul><p>å¦‚æœä¸€ä¸ªå¯¹è±¡å¯ä»¥æ·»åŠ æ–°çš„å±æ€§ï¼Œåˆ™è¿™ä¸ªå¯¹è±¡æ˜¯å¯æ‰©å±•çš„ã€‚æ‰©å±•ç‰¹æ€§é”å°±æ˜¯è®©è¿™ä¸ªå¯¹è±¡å˜çš„ä¸å¯æ‰©å±•ï¼Œä¹Ÿå°±æ˜¯ä¸èƒ½å†æœ‰æ–°çš„å±æ€§ã€‚</p><h3 id="Object-isExtensible"><a href="#Object-isExtensible" class="headerlink" title="Object.isExtensible"></a>Object.isExtensible</h3><p>MDNä¸Šå†…å®¹æ¦‚è¿°ï¼š</p><pre><code>æ¦‚è¿°    Object.isExtensible() æ–¹æ³•åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯å¯æ‰©å±•çš„ï¼ˆæ˜¯å¦å¯ä»¥åœ¨å®ƒä¸Šé¢æ·»åŠ æ–°çš„å±æ€§ï¼‰ã€‚è¯­æ³•    Object.isExtensible(obj)å‚æ•°    obj éœ€è¦æ£€æµ‹çš„å¯¹è±¡</code></pre><p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬æ­£å¸¸ä½¿ç”¨å¯¹è±¡å­—é¢é‡å£°æ˜çš„å¯¹è±¡éƒ½æ˜¯å¯æ‰©å±•çš„ï¼š</p><pre><code>var person1 = {};person1.name = &quot;Lucas&quot;;console.log(person1);// {name: &quot;Lucas&quot;}</code></pre><p>åŒæ—¶ï¼š</p><pre><code>Object.isExtensible(person1) === true; // true</code></pre><p>ä½ å¯èƒ½è¦é—®äº†ï¼Œé‚£ä¹ˆä½¿ç”¨Object.createæ–¹æ³•å£°æ˜çš„å¯¹è±¡ï¼Œå¹¶å¯¹è¯¥å¯¹è±¡å±æ€§è¿›è¡Œé…ç½®æ˜¯ä»€ä¹ˆæƒ…å†µå‘¢ï¼Ÿ<br>æˆ‘ä»¬çŸ¥é“ï¼Œç”¨ä¸Šé¢å¯¹è±¡å­—é¢é‡å£°æ˜çš„å¯¹è±¡ç›¸å½“äºï¼š</p><pre><code>var person1 = Object.create({},{    &quot;name&quot;:{        value : &quot;Lucas&quot;,        configurable : true, //ä¸å¯é…ç½®        enumerable : true , //å¯æšä¸¾        writable : true //å¯å†™    }});</code></pre><p>å³ä¾¿å°è¯•å°†configurableè®¾ç½®ä¸ºfalse:</p><pre><code>var person1 = Object.create({},{    &quot;name&quot;:{        value : &quot;Lucas&quot;,        configurable : false, //ä¸å¯é…ç½®        enumerable : true, //å¯æšä¸¾        writable : true //å¯å†™    }});</code></pre><p>ä»ç„¶å¾—åˆ°ï¼š</p><pre><code>Object.isExtensible(person1) === true; // true</code></pre><h2 id="Object-preventExtensions"><a href="#Object-preventExtensions" class="headerlink" title="Object.preventExtensions"></a>Object.preventExtensions</h2><p>å½“ç„¶ï¼Œæˆ‘ä»¬è¿˜æ˜¯æœ‰æ–¹æ³•å¯ä»¥ä½¿å¾—ä¸€ä¸ªå¯¹è±¡å˜çš„ä¸å¯æ‰©å±•ã€‚</p><p>MDNä¸Šå†…å®¹æ¦‚è¿°ï¼š</p><pre><code>æ¦‚è¿°    Object.preventExtensions() æ–¹æ³•è®©ä¸€ä¸ªå¯¹è±¡å˜çš„ä¸å¯æ‰©å±•ï¼Œä¹Ÿå°±æ˜¯æ°¸è¿œä¸èƒ½å†æ·»åŠ æ–°çš„å±æ€§ã€‚è¯­æ³•    Object.preventExtensions(obj)å‚æ•°    obj å°†è¦å˜å¾—ä¸å¯æ‰©å±•çš„å¯¹è±¡</code></pre><p>å‡ ä¸ªæ³¨æ„ç‚¹åŒ…æ‹¬ä½†ä¸é™äºï¼š</p><ul><li>ä¸å¯æ‰©å±•çš„å¯¹è±¡çš„å±æ€§é€šå¸¸<strong>ä»ç„¶å¯ä»¥è¢«åˆ é™¤ã€‚</strong></li><li>å°è¯•ç»™ä¸€ä¸ªä¸å¯æ‰©å±•å¯¹è±¡æ·»åŠ æ–°å±æ€§çš„æ“ä½œå°†ä¼šå¤±è´¥ï¼Œä¸è¿‡<strong>å¯èƒ½æ˜¯é™é»˜å¤±è´¥ï¼Œä¹Ÿå¯èƒ½ä¼šæŠ›å‡º TypeError å¼‚å¸¸</strong>ï¼ˆä¸¥æ ¼æ¨¡å¼ä¸‹ï¼‰ã€‚</li><li>Object.preventExtensions åªèƒ½é˜»æ­¢ä¸€ä¸ªå¯¹è±¡ä¸èƒ½å†æ·»åŠ æ–°çš„è‡ªèº«å±æ€§ï¼Œ<strong>ä»ç„¶å¯ä»¥ä¸ºè¯¥å¯¹è±¡çš„åŸå‹æ·»åŠ å±æ€§ã€‚</strong></li></ul><p>æ¯”å¦‚ï¼š</p><pre><code>var person1 = {    name: &quot;Lucas&quot;}Object.preventExtensions(person1);person1.age = 18;// éä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œè¿™é‡Œä¸ä¼šæœ‰æŠ¥é”™ï¼Œå±äºé™é»˜å¤±è´¥person1.age // undefined// æ‰©å±•æ–°å±æ€§å¤±è´¥äº†</code></pre><p>ä»ç„¶å¯ä»¥å‘åŸå‹é“¾æ·»åŠ å±æ€§ï¼š</p><pre><code>person1.__proto__.age = 18;person1.age // 18// å¯ä»¥ä»åŸå‹é“¾ä¸Šå–åˆ°</code></pre><p>åŒæ ·ä¹Ÿå¯ä»¥å¤å†™ä¸€äº›å±æ€§ï¼š</p><pre><code>person1.name = &quot;Eros&quot;;person1.name // &quot;Eros&quot;</code></pre><p>ä¹Ÿå¯ä»¥åˆ é™¤å·²æœ‰å±æ€§ï¼š</p><pre><code>person1.name; //  &quot;Eros&quot;,delete person1.name;person1.name; // undefined</code></pre><p>é€šè¿‡ä»¥ä¸Šæ–¹æ³•ï¼Œæˆ‘ä»¬å®ç°äº†å¯¹ä¸€ä¸ªå¯¹è±¡å±æ€§æ‰©å±•çš„å†»ç»“ã€‚ä½†æ˜¯åŒæ ·ä¹Ÿè®¤è¯†åˆ°ï¼Œè¿™å¹¶ä¸æ˜¯å…¨é¢çš„ä¿æŠ¤ï¼šä¾‹å¦‚å¯ä»¥éšæ„æ”¹åŠ¨å»è¦†ç›–å·²æœ‰å±æ€§ï¼Œåœ¨å¯¹è±¡åŸå‹é“¾ä¸Šå¢åŠ å±æ€§ä¹Ÿè¿˜æ˜¯éš¾ä»¥å±è”½ã€‚</p><h2 id="è¡£å¸¦æ¸å®½ç»ˆä¸æ‚”-ä¸ºä¼Šæ¶ˆå¾—äººæ†”æ‚´"><a href="#è¡£å¸¦æ¸å®½ç»ˆä¸æ‚”-ä¸ºä¼Šæ¶ˆå¾—äººæ†”æ‚´" class="headerlink" title="è¡£å¸¦æ¸å®½ç»ˆä¸æ‚” ä¸ºä¼Šæ¶ˆå¾—äººæ†”æ‚´"></a>è¡£å¸¦æ¸å®½ç»ˆä¸æ‚” ä¸ºä¼Šæ¶ˆå¾—äººæ†”æ‚´</h2><p>ç¬¬äºŒç§å¢ƒç•Œï¼šâ€œè¡£å¸¦æ¸å®½ç»ˆä¸æ‚”ï¼Œä¸ºä¼Šæ¶ˆå¾—äººæ†”æ‚´ã€‚â€<br>è¿™å¼•ç”¨çš„æ˜¯åŒ—å®‹æŸ³æ°¸ã€Šè¶æ‹èŠ±ã€‹æœ€åä¸¤å¥è¯ï¼ŒåŸè¯æ˜¯è¡¨ç°ä½œè€…å¯¹çˆ±çš„è‰°è¾›å’Œçˆ±çš„æ— æ‚”ã€‚è‹¥æŠŠâ€œä¼Šâ€å­—ç†è§£ä¸ºè¯äººæ‰€è¿½æ±‚çš„ç†æƒ³å’Œæ¯•ç”Ÿä»äº‹çš„äº‹ä¸šï¼Œäº¦æ— ä¸å¯ã€‚ç‹å›½ç»´åˆ™åˆ«æœ‰ç”¨å¿ƒï¼Œä»¥æ­¤ä¸¤å¥æ¥æ¯”å–»æˆå¤§äº‹ä¸šã€å¤§å­¦é—®è€…ï¼Œä¸æ˜¯è½»è€Œæ˜“ä¸¾ï¼Œéšä¾¿å¯å¾—çš„ï¼Œå¿…é¡»åšå®šä¸ç§»ï¼Œç»è¿‡ä¸€ç•ªè¾›å‹¤åŠ³åŠ¨ï¼ŒåºŸå¯å¿˜é£Ÿï¼Œå­œå­œä»¥æ±‚ï¼Œç›´è‡³äººç˜¦å¸¦å®½ä¹Ÿä¸åæ‚”ã€‚</p><p><strong>ä¸‹é¢ä»‹ç»ä¸€ä¸ªæ›´æ·±ä¸€å±‚çš„åšæ³•ï¼šå¯†å°ç‰¹æ€§ã€‚</strong></p><p>å¯†å°å¯¹è±¡æ˜¯æŒ‡é‚£äº›ä¸èƒ½æ·»åŠ æ–°çš„å±æ€§ï¼Œä¸èƒ½åˆ é™¤å·²æœ‰å±æ€§ï¼Œä»¥åŠä¸èƒ½ä¿®æ”¹å·²æœ‰å±æ€§çš„å¯æšä¸¾æ€§ï¼ˆenumerableï¼‰ã€å¯é…ç½®æ€§ï¼ˆconfigurableï¼‰ã€å¯å†™æ€§ï¼ˆwritableï¼‰ï¼Œä½†<strong>å¯èƒ½å¯ä»¥ä¿®æ”¹å·²æœ‰å±æ€§çš„å€¼çš„å¯¹è±¡ã€‚</strong></p><p>ä»–åŒæ ·åŒ…å«äº†ä¸¤ä¸ªåŸºæœ¬æ–¹æ³•ï¼š</p><ul><li>Object.isSealed</li><li>Object.seal</li></ul><h3 id="Object-isSealed"><a href="#Object-isSealed" class="headerlink" title="Object.isSealed"></a>Object.isSealed</h3><p>MDNä¸Šå†…å®¹æ¦‚è¿°ï¼š</p><pre><code>æ¦‚è¿°     Object.isSealed() æ–¹æ³•åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯å¯†å°çš„ï¼ˆsealedï¼‰ã€‚è¯­æ³•     Object.isSealed(obj)å‚æ•°    obj å°†è¦æ£€æµ‹çš„å¯¹è±¡</code></pre><p>æ­£å¸¸å¯¹è±¡å­—é¢é‡å£°æ˜çš„å¯¹è±¡æ˜¯ä¸è¢«å¯†å°çš„ï¼š</p><pre><code>var person1 = {    name: &quot;Lucas&quot;}Object.isSealed(person1); // false</code></pre><p>å½“å°†è¿™ä¸ªå¯¹è±¡ç¦æ­¢æ‰©å±•æ—¶ï¼Œå®ƒä¹Ÿä¸ä¼šå˜æˆå¯†å°çš„ï¼š</p><pre><code>var person1 = {    name: &quot;Lucas&quot;}Object.preventExtensions(person1);Object.isSealed(person1); // false</code></pre><p>ä½†æ˜¯åœ¨æ­¤åŸºç¡€ä¸Šï¼Œä½¿ç”¨Object.definePropertyæ–¹æ³•ï¼ŒæŠŠå±æ€§å˜å¾—ä¸å¯é…ç½®ï¼ˆconfigurableï¼‰ï¼Œåˆ™è¿™ä¸ªå¯¹è±¡ä¹Ÿå°±æˆäº†å¯†å°å¯¹è±¡ï¼š</p><pre><code>var person1 = {    name: &quot;Lucas&quot;}Object.defineProperty(person1, &quot;name&quot;, {configurable : false});Object.isSealed(person1); // true</code></pre><p>æ­¤æ—¶ï¼Œæˆ‘ä»¬æœ‰ï¼š</p><pre><code>Object.getOwnPropertyDescriptor(person1, &apos;name&apos;);// å¾—åˆ°ï¼šObject {    value: &quot;Lucas&quot;,     writable: true,     enumerable: true,     configurable: false}</code></pre><p>æ ¹æ®è¿™ä¸ªgetOwnPropertyDescriptorï¼Œæˆ‘ä»¬å¯ä»¥æ›´åŠ æ·±å…¥çš„ç†è§£å¯†å°ç‰¹æ€§ï¼šè¢«å¯†å°çš„å¯¹è±¡ï¼Œå°±æ˜¯åœ¨ä¸å¯æ‰©å±•åŸºç¡€ä¸Šè®²å±æ€§æè¿°ç¬¦configurableè®¾ç½®ä¸ºfalse; åŒæ—¶ï¼Œ<strong>è¢«å¯†å°çš„å¯¹è±¡ï¼Œä»ç„¶æœ‰æœºä¼šæ”¹å˜å±æ€§çš„å€¼ã€‚</strong>åªä¸è¿‡å¯¹äºæ­¤å¯¹è±¡æœ¬èº«è€Œè¨€ï¼Œ<strong>ä¸å¯ä»¥å†æ‰©å±•æ–°çš„å±æ€§ï¼Œä¸å¯ä»¥æ›´æ”¹å·²æœ‰å±æ€§çš„é…ç½®ä¿¡æ¯ã€‚</strong></p><h3 id="Object-seal"><a href="#Object-seal" class="headerlink" title="Object.seal"></a>Object.seal</h3><p>ç›¸å¯¹åº”æˆ‘ä»¬ä¹Ÿæœ‰ä¸€ä¸ªæ–¹æ³•å°†ä¸€ä¸ªå¯¹è±¡å¯†å°ã€‚</p><p>MDNä¸Šå†…å®¹æ¦‚è¿°ï¼š</p><pre><code>æ¦‚è¿°    Object.seal() æ–¹æ³•å¯ä»¥è®©ä¸€ä¸ªå¯¹è±¡å¯†å°ï¼Œå¹¶è¿”å›è¢«å¯†å°åçš„å¯¹è±¡ã€‚è¯­æ³•    Object.seal(obj)å‚æ•°    obj å°†è¦è¢«å¯†å°çš„å¯¹è±¡</code></pre><p>æ¯”å¦‚ï¼š</p><pre><code>var person1 = {    name: &quot;Lucas&quot;}Object.getOwnPropertyDescriptor(person1, &apos;name&apos;);// å¾—åˆ°ï¼šObject {    value: &quot;Lucas&quot;,     writable: true,     enumerable: true,     configurable: true}</code></pre><p>å°†æ­¤å¯¹è±¡å¯†å°åï¼š</p><pre><code>Object.seal(person1);Object.getOwnPropertyDescriptor(person1, &apos;name&apos;);// å¾—åˆ°ï¼šObject {    value: &quot;Lucas&quot;,     writable: true,     enumerable: true,     configurable: false}</code></pre><p>ä¹Ÿå°±æ˜¯è¯´ï¼š</p><pre><code>person1.age = 18;person1.age; // undefined// æ‰©å±•æ–°å±æ€§å¤±è´¥// åŒæ—¶è°ƒç”¨definePropertyå¤±è´¥Object.defineProperty(person1,&quot;name&quot;,{get : function(){return &quot;g&quot;;}});// æŠ›å‡ºå¼‚å¸¸</code></pre><p>ä»»ä½•é™¤æ›´æ”¹å±æ€§å€¼ä»¥å¤–çš„æ“ä½œï¼Œéä¸¥æ ¼æ¨¡å¼ä¸‹éƒ½ä¼šé™é»˜å¤±è´¥ï¼Œå¦‚ä¸Šå¹¶å¦‚ä¸‹ï¼š</p><pre><code>delete person1.name;person1.name; // &quot;Lucas&quot;</code></pre><p>è€Œæ›´æ”¹å±æ€§å€¼å¯ä»¥æˆåŠŸï¼š</p><pre><code>person1.name = &quot;Eros&quot;;person1.name; // &quot;Eros&quot;</code></pre><p>æ€ä¹ˆç†è§£è¿™æ ·çš„ç°è±¡å‘¢ï¼Ÿç‰¢è®°ï¼Œè¢«å¯†å°çš„å¯¹è±¡æ‹¥æœ‰å¦‚ä¸‹çš„å±æ€§æè¿°ç¬¦ï¼š</p><pre><code>Object {    value: &quot;Lucas&quot;,     writable: true,     enumerable: true,     configurable: false}</code></pre><p><strong>è€Œåˆ é™¤å±æ€§å±äºconfigurableï¼Œæ›´æ”¹å±æ€§æ‰å±äºwritableï¼›</strong></p><h3 id="ä¸€ç‚¹å»¶ä¼¸"><a href="#ä¸€ç‚¹å»¶ä¼¸" class="headerlink" title="ä¸€ç‚¹å»¶ä¼¸"></a>ä¸€ç‚¹å»¶ä¼¸</h3><p>å€ŸåŠ©äºæ­¤ï¼Œæˆ‘ä»¬å…¶å®å·²ç»å¯ä»¥å®Œæˆå†»ç»“å¯¹è±¡çš„ç¬¬ä¸‰é‡å¢ƒç•Œï¼šè¾¾åˆ°å³å¯†å°åˆä¸å¯ä¿®æ”¹åŸå±æ€§å€¼ã€‚å› ä¸ºå¯ä»¥è¿™æ ·åšï¼š</p><pre><code>var person1 = {name: &quot;Lucas&quot;};Object.defineProperty(person1, &quot;name&quot;, {configurable: false, writable: false});Object.preventExtensions(o);</code></pre><p>æ€»ç»“ä¸‹å°±æ˜¯è®¾ç½®ï¼š</p><blockquote><p>configurable: false ï¼‹ writable: false ï¼‹ preventExtensions</p></blockquote><p>æˆ–è€…å› ä¸º</p><blockquote><p>configurable: falseï¼‹ preventExtensions ï¼ seal</p></blockquote><p>æ‰€ä»¥ä¹Ÿå¯ä»¥è®¾ç½®ï¼š</p><blockquote><p>seal + writable: false</p></blockquote><h2 id="ä¼—é‡Œå¯»ä»–åƒç™¾åº¦ï¼Œè“¦ç„¶å›é¦–ï¼Œé‚£äººå´åœ¨ï¼Œç¯ç«é˜‘çŠå¤„"><a href="#ä¼—é‡Œå¯»ä»–åƒç™¾åº¦ï¼Œè“¦ç„¶å›é¦–ï¼Œé‚£äººå´åœ¨ï¼Œç¯ç«é˜‘çŠå¤„" class="headerlink" title="ä¼—é‡Œå¯»ä»–åƒç™¾åº¦ï¼Œè“¦ç„¶å›é¦–ï¼Œé‚£äººå´åœ¨ï¼Œç¯ç«é˜‘çŠå¤„"></a>ä¼—é‡Œå¯»ä»–åƒç™¾åº¦ï¼Œè“¦ç„¶å›é¦–ï¼Œé‚£äººå´åœ¨ï¼Œç¯ç«é˜‘çŠå¤„</h2><p>ç¬¬ä¸‰ç§å¢ƒç•Œï¼šâ€œä¼—é‡Œå¯»ä»–åƒç™¾åº¦ï¼Œè“¦ç„¶å›é¦–ï¼Œé‚£äººå´åœ¨ï¼Œç¯ç«é˜‘çŠå¤„ã€‚â€<br>è¿™æ˜¯å¼•ç”¨å—å®‹è¾›å¼ƒç–¾ã€Šé’ç‰æ¡ˆã€‹è¯ä¸­çš„æœ€åå››å¥ã€‚æ¢å¯è¶…ç§°æ­¤è¯â€œè‡ªæ€œå¹½ç‹¬ï¼Œä¼¤å¿ƒäººåˆ«æœ‰æ€€æŠ±â€ã€‚è¿™æ˜¯å€Ÿè¯å–»äº‹ï¼Œä¸æ–‡å­¦èµæå·²æ— äº¤æ¶‰ã€‚ç‹å›½ç»´å·²å…ˆè‡ªè¡¨æ˜ï¼Œâ€œå¾äººå¯ä»¥æ— åŠ³çº è‘›â€ã€‚ä»–ä»¥æ­¤è¯æœ€åçš„å››å¥ä¸ºâ€œå¢ƒç•Œâ€ä¹‹ç¬¬ä¸‰ï¼Œå³æœ€ç»ˆæœ€é«˜å¢ƒç•Œã€‚</p><p>è¿™è™½ä¸æ˜¯è¾›å¼ƒç–¾çš„åŸæ„ï¼Œä½†ä¹Ÿå¯ä»¥å¼•å‡ºæ‚ æ‚ çš„è¿œæ„ï¼šåšå­¦é—®ã€æˆå¤§äº‹ä¸šè€…ï¼Œè¦è¾¾åˆ°ç¬¬ä¸‰å¢ƒç•Œï¼Œå¿…é¡»æœ‰ä¸“æ³¨çš„ç²¾ç¥ã€‚åå¤è¿½å¯»ã€ç ”ç©¶ï¼Œä¸‹è¶³åŠŸå¤«ï¼Œè‡ªç„¶ä¼šè±ç„¶è´¯é€šï¼Œæœ‰æ‰€å‘ç°ï¼Œæœ‰æ‰€å‘æ˜ï¼Œå°±èƒ½å¤Ÿä»å¿…ç„¶ç‹å›½è¿›å…¥è‡ªç”±ç‹å›½ã€‚</p><p>ä¸Šè¾¹é‚£ç§å†»ç»“å¯¹è±¡çš„æ–¹æ³•ï¼Œå…¶å®ä¹Ÿæœ‰åŸç”Ÿå®ç°ï¼Œå¯è°“ï¼šâ€œä¼—é‡Œå¯»ä»–åƒç™¾åº¦ï¼Œè“¦ç„¶å›é¦–ï¼Œé‚£äººå´åœ¨ï¼Œç¯ç«é˜‘çŠå¤„â€</p><p>æˆ‘ä»¬è¿™é‡Œæ‰€è¯´çš„ä¸€ä¸ªå¯¹è±¡çš„å†»ç»“ï¼ˆfrozenï¼‰æ˜¯æŒ‡å®ƒä¸å¯æ‰©å±•ï¼Œæ‰€æœ‰å±æ€§éƒ½æ˜¯ä¸å¯é…ç½®çš„ï¼ˆnon-configurableï¼‰ï¼Œä¸”æ‰€æœ‰æ•°æ®å±æ€§ï¼ˆdata propertiesï¼‰éƒ½æ˜¯ä¸å¯å†™çš„ï¼ˆnon-writableï¼‰ã€‚</p><p>æˆ–è€…è¯´ï¼Œå†»ç»“å¯¹è±¡æ˜¯æŒ‡é‚£äº›ä¸èƒ½æ·»åŠ æ–°çš„å±æ€§ï¼Œä¸èƒ½ä¿®æ”¹å·²æœ‰å±æ€§çš„å€¼ï¼Œä¸èƒ½åˆ é™¤å·²æœ‰å±æ€§ï¼Œä»¥åŠä¸èƒ½ä¿®æ”¹å·²æœ‰å±æ€§çš„å¯æšä¸¾æ€§ã€å¯é…ç½®æ€§ã€å¯å†™æ€§çš„å¯¹è±¡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªå¯¹è±¡æ°¸è¿œæ˜¯ä¸å¯å˜çš„ã€‚</p><p>åŒæ ·ï¼ŒåŒ…å«äº†ä¸¤ä¸ªåŸºæœ¬æ–¹æ³•ï¼š</p><ul><li>Object.isFrozen</li><li>Object.freeze</li></ul><h3 id="Object-isFrozen"><a href="#Object-isFrozen" class="headerlink" title="Object.isFrozen"></a>Object.isFrozen</h3><p>MDNä¸Šå†…å®¹æ¦‚è¿°ï¼š</p><pre><code>æ¦‚è¿°    Object.isFrozen() æ–¹æ³•åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦è¢«å†»ç»“ï¼ˆfrozenï¼‰ã€‚è¯­æ³•    Object.isFrozen(obj)å‚æ•°    obj è¢«æ£€æµ‹çš„å¯¹è±¡</code></pre><h3 id="Object-freeze-æ–¹æ³•"><a href="#Object-freeze-æ–¹æ³•" class="headerlink" title="Object.freeze æ–¹æ³•"></a>Object.freeze æ–¹æ³•</h3><p>MDNä¸Šå†…å®¹æ¦‚è¿°ï¼š</p><pre><code>æ¦‚è¿°    Object.freeze() æ–¹æ³•å¯ä»¥å†»ç»“ä¸€ä¸ªå¯¹è±¡ã€‚è¯­æ³•    Object.freeze(obj)å‚æ•°    obj å°†è¦è¢«å†»ç»“çš„å¯¹è±¡</code></pre><p>å¯ä»¥å…ˆç†è§£ä¸ºï¼Œè¿™æ˜¯æœ€é«˜ä¸€å±‚çš„å†»ç»“å¯¹è±¡ï¼š</p><pre><code>var person1 = {    name: &quot;Lucas&quot;}Object.freeze(person1);</code></pre><p>æ­¤æ—¶ï¼Œæˆ‘ä»¬æœ‰ï¼š</p><pre><code>Object.getOwnPropertyDescriptor(person1, &apos;name&apos;)Object {    value: &quot;Lucas&quot;,     writable: false,     enumerable: true,     configurable: false}// å¯¹å†»ç»“å¯¹è±¡çš„ä»»ä½•æ“ä½œéƒ½ä¼šå¤±è´¥person1.name = &quot;Eros&quot;; // æ”¹å†™å±æ€§å€¼ï¼Œéä¸¥æ ¼æ¨¡å¼ä¸‹é™é»˜å¤±è´¥;person1.age = 18; // æ‰©å±•å±æ€§å€¼ï¼Œéä¸¥æ ¼æ¨¡å¼ä¸‹é™é»˜å¤±è´¥;Object.defineProperty(person1,&quot;name&quot;,{value: &quot;Eros&quot;}); // ä½¿ç”¨definePropertyä¼šç›´æ¥æŠ¥é”™</code></pre><p>æ”¹å†™å±æ€§å€¼ï¼Œæ‰©å±•æ–°å±æ€§ï¼Œè°ƒç”¨definePropertyï¼Œå…¨éƒ¨éƒ½ä¼šå¤±è´¥ã€‚</p><p>ä½†æ˜¯ï¼Œ<strong>è¿™ç§å±‚é¢çš„å†»ç»“ï¼Œåªæ˜¯æµ…å†»ç»“ã€‚</strong>å¦‚æœå¯¹è±¡é‡Œé¢è¿˜åµŒå¥—æœ‰å¯¹è±¡ï¼Œé‚£ä¹ˆè¿™ä¸ªå†…éƒ¨å¯¹è±¡ä¸æ¯«ä¸å—å½±å“ã€‚</p><pre><code>var person1 = {    name: &quot;Lucas&quot;,    family: {        brother: &quot;Eros&quot;    }}Object.freeze(person1);person1.family.brother = &quot;Tim&quot;;person1.family.brother // &quot;Tim&quot;</code></pre><h3 id="ç»ˆæå®ç°"><a href="#ç»ˆæå®ç°" class="headerlink" title="ç»ˆæå®ç°"></a>ç»ˆæå®ç°</h3><p>é‚£ä¹ˆï¼Œå¦‚æœæˆ‘ä»¬æƒ³æ·±å±‚æ¬¡å†»ç»“ä¸€ä¸ªå¯¹è±¡å‘¢ï¼Ÿæ€è·¯å’Œæ·±æ‹·è´æš—åˆï¼Œä½¿ç”¨é€’å½’ï¼š</p><pre><code>Object.prototype.deepFreeze = Object.prototype.deepFreeze || function (o){    var prop, propKey;    Object.freeze(o); // é¦–å…ˆå†»ç»“ç¬¬ä¸€å±‚å¯¹è±¡    for (propKey in o){        prop = o[propKey];        if(!o.hasOwnProperty(propKey) || !(typeof prop === &quot;object&quot;) || Object.isFrozen(prop)){            continue;        }        deepFreeze(prop); // é€’å½’    }}</code></pre><p>è¿™æ ·å­ï¼Œæˆ‘ä»¬å†å›è¿‡å¤´æ¥çœ‹ï¼š</p><pre><code>var person1 = {    name: &quot;Lucas&quot;,    family: {        brother: &quot;Eros&quot;    }}Object.deepFreeze(person1);person1.family.brother = &quot;Tim&quot;;person1.family.brother // &quot;Eros&quot;</code></pre><p>å·²ç»è¾¾åˆ°äº†æ·±å±‚æ¬¡å¯¹è±¡å±æ€§çš„å†»ç»“ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ¬æ–‡å…ˆåä»‹ç»äº†å…³äºå†»ç»“ä¸€ä¸ªå¯¹è±¡çš„ä¸‰ç§è¿›é˜¶æ–¹æ³•ã€‚ä»–ä»¬å±‚å±‚é€’è¿›ï¼Œå´åˆç›¸äº’å…³è”ã€‚å…³ç³»å¦‚å›¾ï¼š</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-55750ea1c4e62989.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å…³ç³»å›¾"></p><p>æ–‡ç« éƒ¨åˆ†æ¦‚å¿µç²˜å–äº†MDNè¯­æ³•ä»‹ç»å’Œ<a href="https://segmentfault.com/a/1190000003894119" target="_blank" rel="external">Tomsonçš„æ–‡ç« ã€‚</a></p><p>åœ¨ã€Šæ–‡å­¦å°è¨€ã€‹ä¸€æ–‡ä¸­ï¼Œç‹å›½ç»´æŠŠä¸Šè¿°ä¸‰å¢ƒç•Œè¯´æˆâ€œä¸‰ç§ä¹‹é˜¶çº§â€ã€‚å¹¶è¯´ï¼šâ€œæœªæœ‰ä¸é˜…ç¬¬ä¸€ç¬¬äºŒé˜¶çº§è€Œèƒ½é½è·»ç¬¬ä¸‰é˜¶çº§è€…ï¼Œæ–‡å­¦äº¦ç„¶ã€‚æ­¤æœ‰æ–‡å­¦ä¸Šä¹‹å¤©æ‰è€…ï¼Œæ‰€ä»¥åˆéœ€è«å¤§ä¹‹ä¿®å…»ä¹Ÿã€‚â€</p><p>ä¸å¤§å®¶å…±å‹‰ã€‚</p><p>Happy coding!</p><p>PS: ä½œè€…<a href="https://github.com/HOUCe" target="_blank" rel="external">Githubä»“åº“</a>ï¼Œæ¬¢è¿é€šè¿‡ä»£ç å„ç§å½¢å¼äº¤æµã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;ç‹å›½ç»´åœ¨ã€Šäººé—´è¯è¯ã€‹é‡Œè°ˆåˆ°äº†æ²»å­¦ç»éªŒï¼Œä»–è¯´ï¼šâ€œå¤ä»Šä¹‹æˆå¤§äº‹ä¸šã€å¤§å­¦é—®è€…ï¼Œå¿…ç»è¿‡ä¸‰ç§ä¹‹å¢ƒç•Œã€‚â€&lt;/p&gt;
&lt;p&gt;å·§åˆçš„æ˜¯ï¼Œæœ€è¿‘å— &lt;a href=&quot;http://gitbook.cn/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;git chat ï¼ git
      
    
    </summary>
    
      <category term="js" scheme="https://exp-team.github.io/categories/js/"/>
    
    
      <category term="js" scheme="https://exp-team.github.io/tags/js/"/>
    
  </entry>
  
  <entry>
    <title>é€šè¿‡React Refç»†å°çŸ¥è¯†ç‚¹ è°ˆè°ˆå‰ç«¯å·¥ç¨‹å¸ˆçš„è¿›é˜¶</title>
    <link href="https://exp-team.github.io/blog/2017/06/04/js/react-ref/"/>
    <id>https://exp-team.github.io/blog/2017/06/04/js/react-ref/</id>
    <published>2017-06-03T16:00:00.000Z</published>
    <updated>2017-06-01T09:31:51.000Z</updated>
    
    <content type="html"><![CDATA[<p>ç†Ÿæ‚‰Reactçš„åŒå­¦å¯èƒ½å¯¹å…¶ä¸­çš„Refå¹¶ä¸é™Œç”Ÿã€‚ä¸çŸ¥é“æ‚¨æ˜¯å¦å¬è¯´â€æœ€æ–°çš„Reactç‰ˆæœ¬(v15.5.4)å·²ç»å¯¹è¿™ä¸ªAPIè¿›è¡Œäº†ä¿®æ”¹å¹¶æ›´æ–°â€ã€‚å¦‚æœæ‚¨ä¸€ç›´ä¿æŒå¯¹Reactæ¡†æ¶çš„è·Ÿè¿›ä¸å­¦ä¹ ï¼Œç›¸ä¿¡ä¼šå¾ˆæ¸…æ¥šï¼Œ<strong>æ–°ç‰ˆæœ¬ä¸­â€refæ”¹ä¸ºä½¿ç”¨å›è°ƒå‡½æ•°çš„æ–¹å¼å»å¼•ç”¨â€ã€‚</strong></p><p>è¿™æ˜¯ä¸€ä¸ªéå¸¸ç»†å°ä½†æ˜¯å¾®å¦™çš„æ”¹åŠ¨ã€‚å½“æˆ‘å¾—çŸ¥æ—¶ï¼Œç¬¬ä¸€ä¸ªå¿µå¤´å°±æ˜¯<strong> â€œè¿™æ ·çš„æ”¹åŠ¨æ„ä¹‰åœ¨å“ªé‡Œï¼Ÿâ€</strong></p><p>å¸¦ç€è¿™ä¸ªç–‘é—®ï¼Œä¸‹ç­åæˆ‘èŠ±äº†ä¸€æ™šä¸Šè¿‘2ä¸ªå°æ—¶æ—¶é—´å»æ¢ç©¶è¿™ä¸€ä¸ªå¾®å°æ”¹åŠ¨ï¼Œæ”¶è·é¢‡ä¸°çš„åŒæ—¶ï¼Œå¯è°“â€çœ¼ç•Œå¤§å¼€â€ã€‚</p><p>è¿™ç¯‡æ–‡ç« æˆ‘ä¼šè®°å½•ä¸€æ­¥ä¸€æ­¥æ¢ç©¶çš„è¿‡ç¨‹ï¼Œä»¥åŠæ€»ç»“åˆ†ææœ€ç»ˆç­”æ¡ˆã€‚åŒæ—¶ï¼Œå¯¹reactæ¡†æ¶åŠå…¶å‘¨è¾¹æŠ€æœ¯æ ˆæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥å‚é˜…æ–§æ­£æˆ‘å…¶ä»–æ–‡ç« ï¼š</p><ul><li><a href="http://www.jianshu.com/p/7a56ac1de2a8" target="_blank" rel="external">è§£æTwitterå‰ç«¯æ¶æ„ å­¦ä¹ å¤æ‚åœºæ™¯æ•°æ®è®¾è®¡</a></li><li><a href="http://www.jianshu.com/p/83c86dd0802d" target="_blank" rel="external">React Conf 2017 å¹²è´§æ€»ç»“1: React + ES next = â™¥</a></li><li><a href="http://www.jianshu.com/p/cde3cf7e2760" target="_blank" rel="external">React+Reduxæ‰“é€ â€œNEWS EARLYâ€å•é¡µåº”ç”¨ ä¸€ä¸ªé¡¹ç›®ç†è§£æœ€å‰æ²¿æŠ€æœ¯æ ˆçœŸè°›</a></li><li><a href="http://www.jianshu.com/p/8e28be0e7ab1" target="_blank" rel="external">ä¸€ä¸ªreact+reduxå·¥ç¨‹å®ä¾‹</a></li><li>â€¦â€¦</li></ul><h2 id="å¤æ¥é’å²è°ä¸è§-ä»Šè§åŠŸåèƒœå¤äºº"><a href="#å¤æ¥é’å²è°ä¸è§-ä»Šè§åŠŸåèƒœå¤äºº" class="headerlink" title="å¤æ¥é’å²è°ä¸è§,ä»Šè§åŠŸåèƒœå¤äºº"></a>å¤æ¥é’å²è°ä¸è§,ä»Šè§åŠŸåèƒœå¤äºº</h2><p>åœ¨å¯¹Refä½¿ç”¨æ–¹å¼çš„æ”¹åŠ¨åˆ†æå‰ï¼Œæˆ‘ä»¬å…ˆè¦å¯¹å…¶æœ‰ä¸€ä¸ªå…¨é¢çš„äº†è§£å’Œè®¤è¯†ã€‚å½“ç„¶ï¼Œæœ€ç›´æ¥æœ€æœ‰æ•ˆçš„æ–¹å¼å°±æ˜¯å»<a href="https://facebook.github.io/react/docs/refs-and-the-dom.html" target="_blank" rel="external">å®˜ç½‘</a>å­¦ä¹ ã€‚</p><p>å› ä¸ºReactæœ¬èº«æ›´è¿­è¿…é€Ÿï¼Œå…³äºRefçš„æ–‡æ¡£ä¿¡æ¯ä¹Ÿç»å†è¿‡å¤šæ¬¡ä¿®æ­£ã€‚å®˜ç½‘ä¸Šä¿æŒç€æœ€æ–°ç‰ˆçš„è¾“å‡ºï¼Œæ­£æ‰€è°“â€å¤æ¥é’å²è°ä¸è§,ä»Šè§åŠŸåèƒœå¤äººâ€ã€‚</p><p>è¿™é‡Œå…ˆæ€»ç»“ä¸€ä¸‹åŸºæœ¬æ¦‚å¿µã€‚</p><p><em>*</em> Refsè¯ç”ŸèƒŒæ™¯</p><p>æˆ‘ä»¬éƒ½çŸ¥é“Reactè®²ç©¶çš„æ˜¯<strong>å•é¡¹æ•°æ®æµ</strong>ï¼Œä¹Ÿå°±æ˜¯è¯´çˆ¶ç»„ä»¶ä¸å…¶å­ç»„ä»¶ä¹‹é—´çš„é€šä¿¡ä¾é propsæ¥å®ç°ã€‚å¦‚æœä½ æƒ³é€šè¿‡çˆ¶ç»„ä»¶å»æ›´æ”¹ä¸€ä¸ªå­ç»„ä»¶ï¼Œé‚£ä¹ˆå°±è¦ä»çˆ¶ç»„ä»¶å¤„ä¼ é€’ä¸€ä¸ªæ–°çš„propså€¼ï¼Œå·²è¾¾åˆ°è®©å­ç»„ä»¶re-renderçš„ç›®çš„ã€‚</p><p>ä½†æ˜¯åœ¨ä¸€äº›æƒ…å†µä¸‹ï¼Œè¿™æ ·ä¸¥æ ¼ç•¥æ˜¾æ•™æ¡çš„æ•°æ®æµæˆ–é€šä¿¡æ–¹å¼å¹¶ä¸èƒ½æ»¡è¶³æˆ‘ä»¬éœ€æ±‚ã€‚è¿™æ—¶å€™ï¼Œå°±æ˜¯Refæ´¾ä¸Šç”¨åœºçš„æ—¶å€™äº†ã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬åœ¨å…·ä½“å“ªäº›åœºæ™¯ä¸‹ä¼šç”¨åˆ°Refå‘¢ï¼Ÿ</p><ul><li>å¤„ç†è¾“å…¥æ¡†èšç„¦ï¼Œæ–‡æœ¬é€‰æ‹©ï¼Œæˆ–å…¶ä»–å¤šåª’ä½“åé¦ˆä¿¡æ¯æ—¶ï¼›</li><li>è§¦å‘éœ€è¦çš„åŠ¨ç”»æ—¶ï¼›</li><li>ä¸ç¬¬ä¸‰æ–¹æ“ä½œDOMçš„ç±»åº“äº¤äº’æ—¶ã€‚</li></ul><p><strong>å…¶ä»–æƒ…å†µä¸‹ï¼Œä¸ºäº†é¿å…ç ´åReactçš„å“²å­¦æ€æƒ³ï¼Œéƒ½æ˜¯ä¸è¢«å»ºè®®ä½¿ç”¨çš„ã€‚</strong> </p><p>æ¯”å¦‚ï¼Œä¸€ä¸ªå¼¹æ¡†ç»„ä»¶ï¼Œæˆ‘ä»¬ä¸åº”è¯¥æš´éœ²ç±»ä¼¼ open(), close()è¿™æ ·çš„æ–¹æ³•ï¼Œä»¥é€šè¿‡refæ§åˆ¶æ¥è°ƒç”¨ã€‚æ›´åˆç†çš„åšæ³•æ˜¯é€šè¿‡ä¸€ä¸ªç±»ä¼¼ isOpençš„propå»åœ¨ç»„ä»¶ä¹‹é—´ä¼ é€’åè°ƒã€‚</p><h3 id="Refsä½¿ç”¨æ–¹æ³•"><a href="#Refsä½¿ç”¨æ–¹æ³•" class="headerlink" title="Refsä½¿ç”¨æ–¹æ³•"></a>Refsä½¿ç”¨æ–¹æ³•</h3><p>æ­£å¦‚å…ˆå‰æ‰€è¯´ï¼Œrefå±æ€§ç›®å‰æ¥æ”¶ä¸€ä¸ªå›æ‰å‡½æ•°ã€‚<strong>å½“ç›¸åº”ç»„ä»¶mountenæˆ–è€…unmountedæ—¶ï¼Œè¯¥å›æ‰å‡½æ•°ä¼šè¢«ç«‹å³è°ƒç”¨</strong></p><p>æ¯”å¦‚ï¼Œæˆ‘ä»¬æƒ³è®©ä¸€ä¸ªè¾“å…¥æ¡†ç»„ä»¶åœ¨æ¸²æŸ“åï¼Œè‡ªåŠ¨èšç„¦ï¼Œå¯ä»¥ï¼š</p><p>ä¸Šè¿°å†…å®¹æ˜¯åœ¨ç»„ä»¶å†…å¼•ç”¨Ref, åŒæ ·ï¼Œç±»ä¼¼çˆ¶å­ç»„ä»¶é€šè¿‡propsé€šä¿¡ï¼Œæˆ‘ä»¬å¯ä»¥å®Œæˆ<strong>çˆ¶ç»„ä»¶é€šè¿‡Refæ§åˆ¶å­ç»„ä»¶è¡Œä¸º</strong>:</p><p>æ›´å¤šçš„ç”¨æ³•å’Œæ³¨æ„äº‹é¡¹ä¸å†è¿‡å¤šä»‹ç»ï¼Œè¿™å¹¶éæ­¤æ–‡ä¸»é¢˜ï¼Œè¯»è€…å¯ä»¥é€šè¿‡å®˜ç½‘å­¦åˆ°æ‰€æœ‰çš„å†…å®¹ã€‚</p><h2 id="é—®æ¸ å“ªå¾—æ¸…å¦‚è®¸ï¼Ÿä¸ºæœ‰æºå¤´æ´»æ°´æ¥ã€‚"><a href="#é—®æ¸ å“ªå¾—æ¸…å¦‚è®¸ï¼Ÿä¸ºæœ‰æºå¤´æ´»æ°´æ¥ã€‚" class="headerlink" title="é—®æ¸ å“ªå¾—æ¸…å¦‚è®¸ï¼Ÿä¸ºæœ‰æºå¤´æ´»æ°´æ¥ã€‚"></a>é—®æ¸ å“ªå¾—æ¸…å¦‚è®¸ï¼Ÿä¸ºæœ‰æºå¤´æ´»æ°´æ¥ã€‚</h2><p>è€ç‰ˆæœ¬å…³äºRefçš„ç”¨æ³•è¿œæ²¡æœ‰è¿™ä¹ˆå¤æ‚ã€‚Refå®Œå…¨å¯ä»¥é€šè¿‡å­—ç¬¦ä¸²æ¥å®šä¹‰ã€‚åŒæ ·çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å®ç°ï¼š</p><p>å›åˆ°æˆ‘ä»¬çš„æ¢ç´¢ä¹‹è·¯ï¼ŒåˆæœŸæˆ‘æ˜¯å¾ˆéš¾ç†è§£è¿™æ ·çš„å˜åŠ¨æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿå¹¶ä¸”æ›´è®©æˆ‘å›°æƒ‘çš„æ˜¯ï¼Œå®˜æ–¹çš„ä¸€æ®µè¯´æ³•ï¼š</p><blockquote><p>If you worked with React before, you might be familiar with an older API where the ref attribute is a string. <strong>We advise against it because string refs are considered legacy, and are likely to be removed in one of the future releases</strong>. Although string refs are not deprecated, they are considered legacy, and will likely be deprecated at some point in the future. Callback refs are preferred.</p></blockquote><p>å®˜æ–¹è®¤ä¸ºä¹‹å‰çš„â€å­—ç¬¦ä¸²æ¨¡å¼â€æ˜¯ä¸€ç§â€åæ¨¡å¼â€ ,åœ¨æœªæ¥ç‰ˆæœ¬ä¸­å¾ˆæœ‰å¯èƒ½ä¼šè¢«åºŸé™¤ã€‚å¼ºçƒˆå‘å¤§å®¶æ¨èäº†å›æ‰å‡½æ•°å¼çš„ç”¨æ³•ã€‚</p><p>å¸¦ç€ç–‘æƒ‘ï¼Œæˆ‘Googleäº†æ­¤é—®é¢˜ï¼ˆåŸè°…æˆ‘æœå•†è¾ƒä½ï¼‰ï¼š</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-00ebd947dadb6beb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æœç´¢å†…å®¹"></p><p>ä¸è¦åæ§½æˆ‘â€è¿å¥è‹±æ–‡éƒ½è¯´ä¸æ¸…æ¥šâ€ï¼Œå› ä¸ºæˆ‘è®¤ä¸ºè¿™æ ·çš„å…³é”®å­—æœç´¢æ–¹å¼æ›´æœ‰åˆ©äºæ‰¾åˆ°æœ‰ä»·å€¼çš„å†…å®¹ã€‚ï¼ˆæ‚¨çœŸå½“æ‚¨è·Ÿæœç´¢å¼•æ“å¯¹è¯å‘¢ï¼Ÿï¼‰</p><p>ä¸å‡ºæ‰€æ–™ï¼Œæœç´¢ç»“æœå¾ˆå¤šä¸”æ‚ä¹±ã€‚<br>ç¬¬ä¸€æ¡ç»“æœå±äºReactå®˜ç½‘ï¼Œä¸‹é¢ä¾¿æœ‰Stack Overflowçš„ç›¸å…³ä¿¡æ¯ã€‚<br>ç¬¬ä¸€æ¡ï¼š</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-b7d617b5b0016416.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ç±»ä¼¼é—®é¢˜"></p><p>æ­¤æé—®è€…è¿˜åŠ äº†ä¸€å¥ï¼š</p><blockquote><p>NB: Iâ€™m looking for the â€œofficialâ€ answer to the statement in the documentation, Iâ€™m not asking about personal preferences and so on.</p></blockquote><p>æœ€é«˜åˆ†çš„ç­”æ¡ˆè´¡çŒ®äº†ä¸€ä¸‹å†…å®¹ï¼š</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-b31dafe4c9fe8d8e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="é—®é¢˜ç­”æ¡ˆ"></p><p><a href="https://stackoverflow.com/questions/30710076/react-saving-a-component-in-the-ref-callback" target="_blank" rel="external">æ­¤ç­”æ¡ˆ</a>åˆ—ä¸¾äº†7æ¡è€ç‰ˆæœ¬ç”¨æ³•çš„é—®é¢˜ã€‚å…¶å®æˆ‘åœ¨å·¥ä½œå½“ä¸­ï¼Œå¹¶ä¸æ˜¯ç”¨ReactæŠ€æœ¯æ ˆï¼Œæ‰€æœ‰çŸ¥è¯†å‚¨å¤‡ä»¥ç†è®ºä¸ºä¸»ã€‚æ‰€ä»¥ï¼Œå…¶ä¸­çš„å¾ˆå¤šæ¡æˆ‘å¹¶ä¸èƒ½å®Œå…¨èµåŒã€‚</p><p>å¹¶ä¸”ç­”æ¡ˆä¹Ÿæ²¡æœ‰å…·ä½“çš„ä»£ç ç¤ºä¾‹ï¼Œè™½ç„¶æ²¡ä¸€æ¡ç›®è‹±è¯­å±‚é¢ä¸Šä¸€æ¸…äºŒç™½ï¼Œä½†æ˜¯å…·ä½“åœ¨è¯´ä»€ä¹ˆæŸäº›æ¡ç›®ä¸Šå¹¶æ²¡æœ‰å®Œå…¨ç†è§£ã€‚</p><p>å…ˆå­˜èµ·æ¥ï¼Œåè¾¹æ…¢æ…¢æ¶ˆåŒ–å°è¯•ç†è§£ï¼Œç»§ç»­å¯»æ‰¾ç­”æ¡ˆã€‚ <strong>å˜æ¢ç­–ç•¥ï¼Œæˆ‘ç›´æ¥å»React Githubä»“åº“å¯»æ‰¾ç­”æ¡ˆã€‚</strong>æœç„¶ï¼Œé‡Œé¢éå¸¸å¤šè¯¦å°½çš„å¹²è´§ã€‚</p><p>æˆ‘åœ¨<a href="https://github.com/facebook/react/pull/8333" target="_blank" rel="external">ç¬¬8333å·Pull Requestsä¸­</a>ï¼Œæ‰¾åˆ°äº†ReduxåŸä½œè€…ï¼Œç°åœ¨å·²ç»åŠ å…¥Facebook Reactå›¢é˜Ÿçš„Dan Abramovçš„â€å®˜æ–¹å›ç­”â€ï¼š</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-292bb281019f1405.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Dan Abramov"></p><p>è§£ç­”å†…å®¹ä¸º ï¼ˆæ„è¯‘éç›´è¯‘ï¼‰ï¼š</p><ul><li>è€ç‰ˆæœ¬åŸºäºå­—ç¬¦ä¸²çš„Refä¼šè¿½è¸ªå…¶ç»„ä»¶ï¼Œå› ä¸ºä¸åˆ©äºReactçš„è¿è¡Œé€Ÿåº¦å’Œæ€§èƒ½ä¿è¯ï¼›</li><li>Refåœ¨æ·±å±‚æ¬¡çš„ç»„ä»¶ä¸­ï¼Œéš¾ä»¥æ»¡è¶³ä½¿ç”¨è€…å¯¹å…¶çš„è°ƒç”¨éœ€æ±‚ï¼›</li><li>è€ç‰ˆæœ¬åŸºäºå­—ç¬¦ä¸²çš„Refå¹¶ä¸åƒæ–°ç‰ˆæœ¬é‡‡ç”¨å›æ‰æ–¹å¼å¸¦æ¥çš„å¯ç»„åˆ(Composable)ç›Šå¤„ã€‚</li></ul><p>è™½ç„¶æ˜¯ç”·ç¥è§£æƒ‘ï¼Œå¯æ˜¯ååº”è¿Ÿé’æ™ºå•†æ‹™æ€¥çš„æˆ‘è¿˜æ˜¯å¾ˆéš¾å½»åº•ç†è§£ã€‚</p><p>éš¾é“å°±è¿™æ ·ç¡å»å—ï¼Ÿä¸‹ç­å›å®¶åå·²ç»æŒç»­ç ”ç©¶äº†ä¸€ä¸ªå°æ—¶äº†ï¼Œå¥³æœ‹å‹è²Œä¼¼åœ¨ä¸‹ä¸€ç§’å°±è¦çˆ†å‘ã€‚ã€‚ã€‚</p><p><strong>æˆ‘å½“ç„¶æ˜¯ä¸ç”˜å¿ƒçš„ï¼Œè¿½æ±‚ç­”æ¡ˆåœ¨æ­¤åˆ»ä¼˜å…ˆçº§å·²ç»æº¢å‡ºï¼</strong></p><p>ç´§æ¥ç€ï¼Œæˆ‘ç¿»åˆ°äº†Facebook Reactå›¢é˜Ÿæˆå‘˜Sebastian MarkbÃ¥geæ—©åœ¨2014å¹´çš„<a href="https://github.com/facebook/react/issues/1373" target="_blank" rel="external">å¯¹Refçš„ â€œåæ§½â€</a>ï¼Œæ­¤issuesä¸€å…±å¤šè¾¾30å¤šä¸ªcomments, å»¶ç»­åˆ°äº†2015å¹´ã€‚å¹¶æœ€ç»ˆåœ¨2014å¹´åº•ï¼Œå¯¹Refçš„æ”¹è¿›å†™å…¥äº†react-futureï¼Œå…·ä½“ä¿¡æ¯ <a href="https://github.com/reactjs/react-future/blob/master/01%20-%20Core/06%20-%20Refs.js" target="_blank" rel="external">ç‚¹å‡»è¿™é‡Œå¯ä»¥è¿½æº¯</a>ï¼Œå½“æ—¶çš„ä»£ç æ³¨é‡Šä¿¡æ¯å†™çš„éå¸¸æ¸…æ™°ï¼š</p><blockquote><p>This is a refs proposal that uses callbacks instead of strings. The callback can be easily statically typed and solves most use cases.<br>When a ref is attached, it gets passed the instance as the first argument.<br>When a ref is detached, the callback is invoked with null as the argument.</p></blockquote><p>æ¥ç€ï¼Œæˆ‘æ‰¾åˆ°äº†2015å¹´9æœˆreactæºç æäº¤çš„<a href="https://github.com/facebook/react/commit/5ee8a93280987bf1547687f5d8665be89058f321#all_commit_comments" target="_blank" rel="external">commitä¿¡æ¯</a>ï¼Œæœ€å…³é”®çš„å†…å®¹æç‚¼å‡ºæ¥ï¼š</p><blockquote><p>Callback refs are preferred. We plan to deprecate string refs at some point in the future, but just havenâ€™t gotten around to it yet.<br>String refs are very â€œmagicalâ€ and is not idiomatic javascript, which is bad on principal. But there are also some practical reasonsâ€¦<br>String refs could never be implemented in user space (callbacks can; just have the component call the callback). The ramifications of this are far-reaching. For instance, if you wanted to create a HOC (Higher Order Component) that transparently wraps another component, you could forward all the propsâ€¦ but you couldnâ€™t forward a string ref. Or if you wanted a parent and a grandparent to both have a ref to a component, callback refs allow you to wrap the callback and pass it down, but string refs do not. The list goes on, but in the interest of time, Iâ€™ll truncate it here.</p></blockquote><p>å»ºè®®è¯»è€…å…ˆè‡ªå·±å°è¯•å»ç†è§£ï¼Œä¸‹æ–‡ä¸­æˆ‘ä¼šè¿›è¡Œæ±‰è¯­æ€»ç»“ã€‚<br>åŒæ—¶æˆ‘ä¹Ÿçœ‹åˆ°äº†facebook reactå›¢é˜Ÿå¦å¤–ä¸€åæˆå‘˜Jimçš„è¯ï¼š</p><blockquote><p>Basically, our team has had countless discussions on this topic and arrived at the consensus that string refs should be phased out in favor of callback refs.</p></blockquote><p>å¯è§ï¼Œå…³äºRefè¿™ä¸ªAPIè®¾è®¡è°ƒæ•´çš„é—®é¢˜ï¼Œæºç å›¢é˜Ÿä¹Ÿæ˜¯ç»å†äº†æ— æ•°æ¬¡è®¨è®ºä¸äº‰æ‰§ã€‚æ­¤æ—¶ï¼Œæˆ‘æ›´åŠ è¿«ä¸åŠå¾…åœ°å»æŒ–æ˜ä½“ä¼šæ›´å¤šä¿¡æ¯ã€‚</p><h2 id="å·åœ°é£æ¥å¿½å¹æ•£ï¼Œæœ›æ¹–æ¥¼ä¸‹æ°´å¦‚å¤©"><a href="#å·åœ°é£æ¥å¿½å¹æ•£ï¼Œæœ›æ¹–æ¥¼ä¸‹æ°´å¦‚å¤©" class="headerlink" title="å·åœ°é£æ¥å¿½å¹æ•£ï¼Œæœ›æ¹–æ¥¼ä¸‹æ°´å¦‚å¤©"></a>å·åœ°é£æ¥å¿½å¹æ•£ï¼Œæœ›æ¹–æ¥¼ä¸‹æ°´å¦‚å¤©</h2><p>è¯´æ¥æœ‰è¶£ï¼Œæœ€ç»ˆè®©æˆ‘æŠŠä¼—å¤šä¿¡æ¯â€èä¼šè´¯é€šâ€çš„å¥‘æœºæ¥è‡ªäº<a href="https://twitter.com/dan_abramov" target="_blank" rel="external"><strong>Dan Abramovçš„ä¸€æ¡Twitterï¼š</strong>â€ </a></p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-df4edea15393570c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Dan&#39;s Twitter"></p><p>é€šè¿‡è¿™æ¡Twitterä»¥åŠè¯¥Twitterä¸‹çš„è¯„è®ºå’Œå›å¤ï¼Œå°¤å…¶æ˜¯é™„å¸¦çš„ä»£ç æˆªå›¾ï¼Œæˆ‘ç¬é—´ç†è§£äº†ä¹‹å‰çš„å¾ˆå¤šä¿¡æ¯ã€‚</p><p>å…ˆå‘ç»™å¤§å®¶ä½“ä¼šï¼š</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-db606be5928801bd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ä»£ç 1"></p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-ae8681234a038bf7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ä»£ç 2"></p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-9c40dbff15d1122a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ä»£ç 3"></p><p>ä»”ç»†æ£æ‘©ï¼Œä½ èƒ½ä½“ä¼šåˆ°ä»€ä¹ˆå‘¢ï¼Ÿ</p><p>å…¶å®Dan Abramovç§äººè¿˜ç»´æŠ¤ç€ä¸€ä¸ªReactç»„ä»¶åº“ï¼šReact DnDï¼Œè¿™ä¸ªç»„ä»¶åº“å…¶å®å°±æ˜¯ä¸€ä¸ª <a href="https://facebook.github.io/react/docs/higher-order-components.html" target="_blank" rel="external">HOCï¼ˆHigher-Order Componentsï¼‰</a>ï¼Œæµ…æ˜¾æ¥è¯´æœ¬è´¨ä¸Šï¼ŒDnDå¯¹å¤–æš´éœ²ä¸€ä¸ªé«˜é˜¶ç»„ä»¶ï¼Œè¿™ä¸ªç»„ä»¶æ¥æ”¶ç”¨æˆ·å®šä¹‰çš„ç»„ä»¶ï¼Œå¹¶é€šè¿‡â€ä¸€ç³»åˆ—é­”æ³•â€ï¼Œåˆè¿”å›ç”¨æˆ·ä¼ å…¥çš„è‡ªå®šä¹‰çš„ç»„ä»¶ï¼Œæ­¤æ—¶è¿™ä¸ªç»„ä»¶å¯æ‹–æ‹½ã€‚</p><p>ç”¨æœ€ç®€å•çš„ä»£ç å±•ç¤ºï¼Œç±»ä¼¼ï¼š</p><p>æˆ‘ä»¬çœ‹ä»£ç 1ï¼ŒdragSourceRefå‡½æ•°ä½œä¸ºè‡ªå®šä¹‰ï¼ˆå³éœ€è¦å®ç°æ‹–æ‹½çš„ç»„ä»¶ï¼‰ç»„ä»¶çš„refå›æ‰å‡½æ•°ï¼Œåœ¨React DnDç»„ä»¶åº“ä¸­ï¼Œå˜è·å–äº†è¿™ä¸ªç»„ä»¶instanceï¼›</p><p>å¦‚æœè¿˜æ˜¯å­—ç¬¦ä¸²æ–¹å¼ï¼Œåœ¨React DnDç»„ä»¶åº“ä¸­åªèƒ½é¢„å…ˆå®šä¹‰åå•†å¥½çš„refå€¼ï¼Œä»¥æ–¹ä¾¿è¯¥ç»„ä»¶åº“è¿›è¡Œâ€é­”æ³•å¤„ç†â€ã€‚<br>ä½†æ˜¯å¦‚æœéœ€è¦è¿›è¡Œå¯æ‹–æ‹½åŒ–çš„ç»„ä»¶å¾ˆå¤šæ—¶ï¼Œrefå€¼å°±é¢ä¸´å†²çªçš„é—®é¢˜ã€‚<br>å½“ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªé¢„ç•™çš„æ•°ç»„ï¼Œåœ¨ç»„ä»¶åº“å’Œä¸šåŠ¡ä»£ç é‡Œä¼ é€’refså€¼ã€‚ä½†æ˜¯è¿™æ ·çš„å®ç°æ˜¾ç„¶æ˜¯å¾ˆä¸‘é™‹çš„ã€‚</p><p>å‚è€ƒ <a href="https://github.com/facebook/react/issues/8734" target="_blank" rel="external">facebook react 8734å·issue</a>ï¼š</p><p><img src="http://upload-images.jianshu.io/upload_images/4363003-597c140d4d6d5613.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="facebook react 8734å·issue"></p><p>è¿™æ˜¾ç„¶ï¼Œå·²ç»æ˜¯æ–°Ref APIå˜é©å¸¦æ¥çš„å·¨å¤§å¥½å¤„ã€‚</p><p>åŒæ—¶ä»”ç»†æ£æ‘©ä¸Šé¢ä»£ç 2ï¼Œ3æˆªå›¾ï¼Œä¾¿æ˜¯å¯¹composableçš„æœ‰åŠ›è¯´æ˜ã€‚å½“ç„¶ï¼Œé€šè¿‡è€ç‰ˆæœ¬å­—ç¬¦ä¸²æ–¹å¼å¯ä»¥å®ç°åŒæ ·çš„åŠŸèƒ½(æœ‰å†…å­˜ç®¡ç†çš„ç‘•ç–µï¼Œå…·ä½“è§ä¸‹æ–‡è¯´æ˜)ï¼Œé‚£ä¹ˆcomposableçš„ä¼˜åŠ¿ï¼Œæˆ‘è®¤ä¸ºå¯èƒ½åªä¼šä½“ç°åœ¨â€å…ˆè¿›çš„æ€æƒ³å±‚é¢å’Œçµæ´»æ€§å±‚é¢â€ã€‚</p><h2 id="çº¸ä¸Šå¾—æ¥ç»ˆè§‰æµ…-ç»çŸ¥æ­¤äº‹è¦èº¬è¡Œ"><a href="#çº¸ä¸Šå¾—æ¥ç»ˆè§‰æµ…-ç»çŸ¥æ­¤äº‹è¦èº¬è¡Œ" class="headerlink" title="çº¸ä¸Šå¾—æ¥ç»ˆè§‰æµ… ç»çŸ¥æ­¤äº‹è¦èº¬è¡Œ"></a>çº¸ä¸Šå¾—æ¥ç»ˆè§‰æµ… ç»çŸ¥æ­¤äº‹è¦èº¬è¡Œ</h2><p>é™¤äº†ä¸Šè¿°React ä»“åº“commitã€issueã€pull requestsä¹‹å¤–ï¼Œæˆ‘åˆå‚è€ƒäº†æ›´å¤šä¿¡æ¯ã€‚</p><p>å…³äºå®˜æ–¹å›¢é˜Ÿç»™å‡ºçš„ä¼˜åŠ¿ï¼Œæˆ‘è®¤ä¸ºå¾ˆå¤šæ¡ç›®æ˜¯åœ¨å‘Functional Programmingé æ‹¢ï¼Œæ›´å¤šæ„ä¹‰ä¸Šæ˜¯ä¸€ç§æ€ç»´æ¨¡å¼çš„è½¬å˜ã€‚</p><p>æ¯”å¦‚è¯´ï¼Œæˆ‘æƒ³å®ç°â€åœ¨ä¸‰å±‚åµŒå¥—ï¼ˆGrandparent-&gt;Parent-&gt;childï¼‰ç»“æ„ä¸­ï¼ŒGrandparentç»„ä»¶æ“æ§childç»„ä»¶â€ï¼Œè¿™æ ·çš„åœºæ™¯éœ€æ±‚æ–°è€ä¸¤ç§ç‰ˆæœ¬éƒ½å¯ä»¥å®ç°ï¼š<br>å›æ‰æ–¹å¼ï¼š</p><p>è€ç‰ˆæœ¬å­—ç¬¦ä¸²æ–¹å¼ï¼š</p><p>ä½†æ˜¯ä»”ç»†å¯¹æ¯”è¿™ä¸¤ç§æ–¹å¼ï¼Œåœ¨è€ç‰ˆæœ¬ä¸­çš„å®ç°ï¼Œå…ˆä¸è¯´æˆ‘ä»¬ä½¿ç”¨äº†</p><pre><code>this.refs.myInput2.refs.myInput1.refs.myInput</code></pre><p>è¿™ä¹ˆä¸€é•¿ä¸²æ‰èƒ½æ‹¿åˆ°instance,æ›´åº”è¯¥æ³¨æ„åˆ°ä¸ºäº†æ‹¿åˆ°ç¬¬ä¸‰å±‚çš„instanceï¼Œæˆ‘ä»¬è¢«è¿«æ–°å¢äº†ä¸¤ä¸ªåªç”¨äºä¸­é—´ä¼ é€’çš„refsã€‚</p><p>è¿™è¿˜æ²¡æœ‰å®Œï¼Œå‰æ–‡æåˆ°è¿‡å†…å­˜ç®¡ç†ã€‚æˆ‘ä»¬å†æ¥æ€è€ƒä¸€ä¸‹ï¼Œå½“child unmountæ—¶ï¼ŒåŸºäºå­—ç¬¦ä¸²çš„refæ–¹å¼æ— æ³•æ„ŸçŸ¥ã€‚æ³¨æ„è¿™éƒ½æ˜¯åœ¨å†…å­˜å±‚é¢ï¼Œå³åæ˜ åœ¨è™šæ‹ŸDOMçš„å¼€é”€ä¸Šã€‚ä»–å¹¶ä¸æ˜¯çœŸæ­£çš„DOMèŠ‚ç‚¹ï¼Œè‡ªç„¶ä¸ä¼šæœ‰ä¾èµ–äºæµè§ˆå™¨çš„åƒåœ¾å›æ”¶æœºåˆ¶ã€‚</p><p>å½“ç¨‹åºä¸­æœ‰å¤§é‡ç±»ä¼¼åœºæ™¯æ—¶ï¼Œå¤§é‡unmountç»„ä»¶å‡ºç°ï¼Œå°±ä¼šæœ‰å¤§é‡çš„æ— æ„ä¹‰å†…å­˜å ç”¨ã€‚</p><p>å¦‚æœä½¿ç”¨æ–°çš„Ref APIæ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨trackçš„ç»„ä»¶unmountæ—¶å¾—åˆ°é€šçŸ¥ã€‚å› ä¸ºï¼š</p><blockquote><p>The ref attribute takes a callback function, and <strong>the callback will be executed immediately after the component is mounted or unmounted.</strong></p></blockquote><p>æ³¨æ„<strong>the callback will be executed immediately after the component is mounted or unmounted.</strong>æˆ‘ä»¬åªéœ€è¦åœ¨childç»„ä»¶ä¸­è¿›è¡Œç›‘æµ‹ï¼Œunmountåå°†this.input = nullï¼Œå³å¯å®Œæˆæ‰‹åŠ¨åƒåœ¾å›æ”¶ï¼š</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;ç†Ÿæ‚‰Reactçš„åŒå­¦å¯èƒ½å¯¹å…¶ä¸­çš„Refå¹¶ä¸é™Œç”Ÿã€‚ä¸çŸ¥é“æ‚¨æ˜¯å¦å¬è¯´â€æœ€æ–°çš„Reactç‰ˆæœ¬(v15.5.4)å·²ç»å¯¹è¿™ä¸ªAPIè¿›è¡Œäº†ä¿®æ”¹å¹¶æ›´æ–°â€ã€‚å¦‚æœæ‚¨ä¸€ç›´ä¿æŒå¯¹Reactæ¡†æ¶çš„è·Ÿè¿›ä¸å­¦ä¹ ï¼Œç›¸ä¿¡ä¼šå¾ˆæ¸…æ¥šï¼Œ&lt;strong&gt;æ–°ç‰ˆæœ¬ä¸­â€refæ”¹ä¸ºä½¿ç”¨å›è°ƒå‡½æ•°çš„æ–¹å¼å»å¼•ç”¨â€ã€‚&lt;/stro
      
    
    </summary>
    
      <category term="js" scheme="https://exp-team.github.io/categories/js/"/>
    
    
      <category term="js" scheme="https://exp-team.github.io/tags/js/"/>
    
  </entry>
  
  <entry>
    <title>expfeæŠ€æœ¯å‘¨åˆŠç¬¬11110æœŸ</title>
    <link href="https://exp-team.github.io/blog/2017/05/20/weekly/weekly-11110/"/>
    <id>https://exp-team.github.io/blog/2017/05/20/weekly/weekly-11110/</id>
    <published>2017-05-19T16:00:00.000Z</published>
    <updated>2017-11-05T02:36:55.000Z</updated>
    
    <content type="html"><![CDATA[<p>5.15-5.20ï¼Œæµè§ˆå™¨æ”¯æŒES6åŸç”Ÿæ¨¡å—å•¦ï¼</p><a id="more"></a><h2 id="æœ¬æœŸæ¨è"><a href="#æœ¬æœŸæ¨è" class="headerlink" title="æœ¬æœŸæ¨è"></a>æœ¬æœŸæ¨è</h2><h3 id="ä»€ä¹ˆæ‰æ˜¯ä½ å¿ƒç›®ä¸­çš„å‰ç«¯åœˆ"><a href="#ä»€ä¹ˆæ‰æ˜¯ä½ å¿ƒç›®ä¸­çš„å‰ç«¯åœˆ" class="headerlink" title="ä»€ä¹ˆæ‰æ˜¯ä½ å¿ƒç›®ä¸­çš„å‰ç«¯åœˆ?"></a><a href="https://www.zhihu.com/question/59758480" target="_blank" rel="external">ä»€ä¹ˆæ‰æ˜¯ä½ å¿ƒç›®ä¸­çš„å‰ç«¯åœˆ?</a></h3><h3 id="æ¯”è¾ƒä¸ç†è§£Reactçš„Componentsï¼ŒElementså’ŒInstances"><a href="#æ¯”è¾ƒä¸ç†è§£Reactçš„Componentsï¼ŒElementså’ŒInstances" class="headerlink" title="æ¯”è¾ƒä¸ç†è§£Reactçš„Componentsï¼ŒElementså’ŒInstances"></a><a href="https://mp.weixin.qq.com/s?__biz=MjM5MTA1MjAxMQ==&amp;mid=2651226492&amp;idx=1&amp;sn=4a20787048f4269b11548689fe73a47e&amp;chksm=bd4958f88a3ed1eed2eccf59912268f6cd2bb13ed699b5b427e62c4f6cc8dbe1cd11fe15f58d&amp;mpshare=1&amp;scene=1&amp;srcid=0515EYgoDmAu1dVKeNhAn9A8" target="_blank" rel="external">æ¯”è¾ƒä¸ç†è§£Reactçš„Componentsï¼ŒElementså’ŒInstances</a></h3><h3 id="ä¸ºä½•-ES-Module-å¦‚æ­¤å§—å§—æ¥è¿Ÿ"><a href="#ä¸ºä½•-ES-Module-å¦‚æ­¤å§—å§—æ¥è¿Ÿ" class="headerlink" title="ä¸ºä½• ES Module å¦‚æ­¤å§—å§—æ¥è¿Ÿ"></a><a href="https://segmentfault.com/a/1190000004940294" target="_blank" rel="external">ä¸ºä½• ES Module å¦‚æ­¤å§—å§—æ¥è¿Ÿ</a></h3><h2 id="å‰ç«¯"><a href="#å‰ç«¯" class="headerlink" title="å‰ç«¯"></a>å‰ç«¯</h2><h3 id="WebSocket-æ•™ç¨‹"><a href="#WebSocket-æ•™ç¨‹" class="headerlink" title="WebSocket æ•™ç¨‹"></a><a href="http://www.ruanyifeng.com/blog/2017/05/websocket.html" target="_blank" rel="external">WebSocket æ•™ç¨‹</a></h3><h3 id="Babel-ä»å…¥é—¨åˆ°æ’ä»¶å¼€å‘"><a href="#Babel-ä»å…¥é—¨åˆ°æ’ä»¶å¼€å‘" class="headerlink" title="Babel ä»å…¥é—¨åˆ°æ’ä»¶å¼€å‘"></a><a href="http://web.jobbole.com/91277/" target="_blank" rel="external">Babel ä»å…¥é—¨åˆ°æ’ä»¶å¼€å‘</a></h3><h3 id="å¦‚ä½•æ‰èƒ½è·¨è¿‡å‰ç«¯çš„é«˜çº§çº§åˆ«ï¼Œè­¬å¦‚è…¾è®¯çš„t3-1-æˆ–è€…æ˜¯é˜¿é‡Œçš„p7ã€‚å¹³æ—¶çš„å‰ç«¯çŸ¥è¯†å¹¶ä¸è¶³å¤Ÿè·¨è¿‡è¿™ä¸ªé—¨æ§›"><a href="#å¦‚ä½•æ‰èƒ½è·¨è¿‡å‰ç«¯çš„é«˜çº§çº§åˆ«ï¼Œè­¬å¦‚è…¾è®¯çš„t3-1-æˆ–è€…æ˜¯é˜¿é‡Œçš„p7ã€‚å¹³æ—¶çš„å‰ç«¯çŸ¥è¯†å¹¶ä¸è¶³å¤Ÿè·¨è¿‡è¿™ä¸ªé—¨æ§›" class="headerlink" title="å¦‚ä½•æ‰èƒ½è·¨è¿‡å‰ç«¯çš„é«˜çº§çº§åˆ«ï¼Œè­¬å¦‚è…¾è®¯çš„t3-1,æˆ–è€…æ˜¯é˜¿é‡Œçš„p7ã€‚å¹³æ—¶çš„å‰ç«¯çŸ¥è¯†å¹¶ä¸è¶³å¤Ÿè·¨è¿‡è¿™ä¸ªé—¨æ§›?"></a><a href="https://www.zhihu.com/question/59747367" target="_blank" rel="external">å¦‚ä½•æ‰èƒ½è·¨è¿‡å‰ç«¯çš„é«˜çº§çº§åˆ«ï¼Œè­¬å¦‚è…¾è®¯çš„t3-1,æˆ–è€…æ˜¯é˜¿é‡Œçš„p7ã€‚å¹³æ—¶çš„å‰ç«¯çŸ¥è¯†å¹¶ä¸è¶³å¤Ÿè·¨è¿‡è¿™ä¸ªé—¨æ§›?</a></h3>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;5.15-5.20ï¼Œæµè§ˆå™¨æ”¯æŒES6åŸç”Ÿæ¨¡å—å•¦ï¼&lt;/p&gt;
    
    </summary>
    
      <category term="weekly" scheme="https://exp-team.github.io/categories/weekly/"/>
    
    
      <category term="weekly" scheme="https://exp-team.github.io/tags/weekly/"/>
    
  </entry>
  
  <entry>
    <title>æˆ‘ä»¬èƒ½ä»ä¸€åœºâ€œæ•°æ®è®¾è®¡çš„æ’•é€¼â€ä¸­å­¦åˆ°å“ªäº›ç²¾å</title>
    <link href="https://exp-team.github.io/blog/2017/05/14/js/Converting%20an%20Array%20of%20Objects%20to%20an%20Object/"/>
    <id>https://exp-team.github.io/blog/2017/05/14/js/Converting an Array of Objects to an Object/</id>
    <published>2017-05-13T16:00:00.000Z</published>
    <updated>2017-05-11T06:40:58.000Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘çœ‹äº†ä¸€ç¯‡Chris Burginçš„<a href="https://medium.com/dailyjs/rewriting-javascript-converting-an-array-of-objects-to-an-object-ec579cafbfc7" target="_blank" rel="external">æ–‡ç« ï¼šRewriting JavaScript: Converting an Array of Objects to an Object</a>ï¼Œå…¶ä¸­å¯¹æ¯”è®¨è®ºäº†ä¸¤ç§æ•°æ®è®¾è®¡çš„ä¸åŒç‚¹ã€‚å¹¶æ¨å¹¿ä»â€œä¸€ä¸ªåŒ…å«å¯¹è±¡çš„æ•°ç»„â€è¿ç§»åˆ°æ‰å¹³åŒ–çš„â€œå¯¹è±¡â€å­˜å‚¨ç»“æ„ã€‚</p><p>è¿™ä¸ï¼Œé¥ç›¸å‘¼åº”çš„æ˜¯ï¼Œæˆ‘ä¹Ÿåœ¨YouTubeä¸Šçœ‹åˆ°äº†ä¸€ç¯‡ç±»ä¼¼çš„è§†é¢‘ï¼š<a href="https://www.youtube.com/watch?v=aJxcVidE0I0" target="_blank" rel="external">[Redux] The Best Way to Store Data</a></p><p>æˆ‘ä»¬çŸ¥é“Reactï¼‹ReduxæŠ€æœ¯æ ˆç”±äºå…¶è®¾è®¡æ€è·¯ï¼Œä½¿å¾—å‰ç«¯åº”ç”¨å¹¶ç®¡ç†å¤æ‚æ•°æ®è¶Šæ¥è¶Šé‡è¦ã€‚æ¯”å¦‚ï¼Œè¯»è€…æœ‹å‹å¯ä»¥å‚è€ƒæˆ‘ä¹‹å‰åˆ†æè¿‡çš„Twitterå‰ç«¯æ•°æ®æ¶æ„<a href="http://www.jianshu.com/p/7a56ac1de2a8" target="_blank" rel="external">ä¸€æ–‡ï¼šè§£æTwitterå‰ç«¯æ¶æ„ å­¦ä¹ å¤æ‚åœºæ™¯æ•°æ®è®¾è®¡ã€‚</a></p><p>ä½†æ˜¯ï¼Œä¸Šé¢æçš„æ•°æ®è®¾è®¡æ–¹å¼åˆ°åº•æ˜¯æŒ‡çš„ä»€ä¹ˆï¼Ÿå½“æˆ‘ä»¬åœ¨è¯´æ‰å¹³åŒ–çš„è®¾è®¡æ—¶ï¼Œåˆ°åº•åœ¨è¯´ä»€ä¹ˆï¼Ÿè¿™æ ·çš„è®¾è®¡çœŸçš„â€œç™¾åˆ©è€Œæ— ä¸€å®³â€å—ï¼Ÿ</p><p>åˆ«æ€¥ï¼Œä¸‹æ–‡æˆ‘è®²ç»†ç»†é“æ¥ã€‚</p><h2 id="é€šè¿‡åœºæ™¯æ¥çœ‹é€è®¾è®¡"><a href="#é€šè¿‡åœºæ™¯æ¥çœ‹é€è®¾è®¡" class="headerlink" title="é€šè¿‡åœºæ™¯æ¥çœ‹é€è®¾è®¡"></a>é€šè¿‡åœºæ™¯æ¥çœ‹é€è®¾è®¡</h2><p>å‡è®¾æˆ‘ä»¬éœ€è¦ç»´æŠ¤ä¸€ä¸ªå©šæ‹äº¤å‹ç”¨æˆ·åˆ—è¡¨ï¼ŒåŒ…å«äº†æ‰€æœ‰æ³¨å†Œç”¨æˆ·ã€‚æ¯ä¸ªç”¨æˆ·æœ‰å”¯ä¸€idä½œä¸ºè¾¨è¯†ï¼ŒåŒæ—¶å«æœ‰ç”¨æˆ·åå’Œå¹´é¾„ä¿¡æ¯ã€‚<br>ä¸€ä¸ªå¾ˆå¸¸è§çš„åšæ³•æ˜¯ï¼š</p><pre><code>const userArray = [    {        id: 123,        name: &apos;LucasHC&apos;,        age: 18    },    {        id: 456,        name: &apos;maxiao&apos;,        age: 38    },    {        id: 789,        name: &apos;chengwen&apos;,        age: 22    },    {        id: 101,        name: &apos;yanhaijing&apos;,        age: 28    },    {        id: 102,        name: &apos;zhaowenlin&apos;,        age: 8    }]</code></pre><p>è¿™æ ·çš„å‚¨å­˜è®¾è®¡æ–¹å¼éå¸¸çš„ç®€å•ï¼Œä¹Ÿç¬¦åˆé€»è¾‘ã€‚</p><p>ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬æƒ³é€‰å‡ºidä¸º101ç”¨æˆ·ï¼Œé‚£å°±å¿…é¡»è¦éå†è¿™ä¸ªæ•°ç»„ã€‚é€šå¸¸çš„åšæ³•åŒ…æ‹¬ä½†ä¸é™äºï¼š</p><pre><code>let idToSelect = 101;let selectedUser;for (let user of userArray) {    if (user.id === idToSelect) {        selectedUser = user;        // ...        break;    }}</code></pre><p>æˆ‘ä»¬ä½¿ç”¨äº†ES6å½“ä¸­çš„forâ€¦ofæ–¹æ³•ã€‚<br>å½“ç„¶é™¤æ­¤ä¹‹å¤–ï¼Œä½¿ç”¨æ•°ç»„çš„filteræ–¹æ³•ã€findæ–¹æ³•ç­‰ç­‰éƒ½æ˜¯å¯è¡Œçš„ã€‚æ¯”å¦‚ï¼š</p><pre><code>const selectedUser = userArray.find(user =&gt; user.id === idToSelect)</code></pre><p>ä½†æ˜¯ä¸å¯é¿å…çš„å°±æ˜¯éœ€è¦éå†è¿™ä¸ªæ•°ç»„ã€‚<br>æƒ³è±¡ä¸€ä¸‹å¦‚æœè¿™ä¸ªç”¨æˆ·æ•°ç»„æ¯”è¾ƒå¤§ï¼Œå‚åŠ å©šæ‹äº¤å‹çš„ç”¨æˆ·å¾ˆå¤šï¼Œæ€§èƒ½ä¸Šå…ˆä¸è¯´ï¼Œè¿™æ ·çš„æ›´æ–°ç”¨æˆ·ä¿¡æ¯æ–¹å¼ä¹Ÿæ˜¯æ¯”è¾ƒå¤æ‚çš„ã€‚</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒChris Burginçš„åŸæ–‡å½“ä¸­ï¼Œè§‚ç‚¹è¿˜æœ‰</p><blockquote><p>This is fairly simple and will traverse the array and assign the correct person to selectedPerson. This presents many problems though, mainly it introduces mutation into your code. Scary!</p></blockquote><p>ä¸è¿‡ï¼Œæ®æˆ‘ç†è§£ï¼Œä¸Šè¿°çš„æ“ä½œæ–¹å¼å¦‚æœéè¦è¿™ä¹ˆç†è§£æ‰€è°“çš„â€œmutationâ€çš„è¯ï¼ŒChris Burginå¯èƒ½æƒ³è¡¨è¾¾userèµ‹å€¼ç»™selectedUserå±äºå¼•ç”¨èµ‹å€¼ï¼Œç¡®å®ä¼šå­˜åœ¨â€œå…±äº«â€çš„é—®é¢˜ã€‚ä½†æ˜¯ä»–æä¾›çš„æ–¹æ³•ï¼ˆè§ä¸‹æ–‡ï¼‰ï¼Œä¹ŸåŒæ ·æ²¡æœ‰è§„é¿è¿™æ ·çš„é—®é¢˜ã€‚</p><p>å½“ç„¶ï¼Œä¸æ­¢æˆ‘æ³¨æ„äº†è¿™æ ·çš„ç»†èŠ‚ã€‚åŸæ–‡ä¸‹é¢çš„è¯„è®ºï¼Œä¹Ÿæœ‰å¾ˆå¤šè¯»è€…ç•™è¨€è¡¨ç¤ºï¼š</p><blockquote><p>I donâ€™t see a mutation here? </p><p>I donâ€™t understand how it mutates the array. Does this portion â€œlet person of peopleArrayâ€ somehow change the array?</p></blockquote><p>çœ‹åˆ°è¿™é‡Œï¼Œå¦‚æœæ‚¨æœ‰è‡ªå·±å¯¹äºâ€œmutationâ€çš„çœ‹æ³•ï¼Œä¹Ÿæ¬¢è¿å’Œæˆ‘äº¤æµã€‚</p><h2 id="æ›´å¥½çš„æ–¹å¼"><a href="#æ›´å¥½çš„æ–¹å¼" class="headerlink" title="æ›´å¥½çš„æ–¹å¼"></a>æ›´å¥½çš„æ–¹å¼</h2><p>æ›´ç†æƒ³çš„æ–¹å¼æ˜¯æŠŠåˆšæ‰çš„userArrayæ•°ç»„è½¬æ¢ä¸ºå¯¹è±¡æ¥å­˜å‚¨ã€‚å°±åƒä¸‹é¢æ‰€åšçš„è¿™æ ·ï¼š</p><pre><code>const userObject = {    &quot;123&quot;: { id: 123, name: &quot;LucasHC&quot;, age: 18 },    &quot;456&quot;: { id: 456, name: &quot;maxiao&quot;, age: 38 },    &quot;789&quot;: { id: 789, name: &quot;chengwen&quot;, age: 22 },    &quot;101&quot;: { id: 101, name: &quot;yanhaijing&quot;, age: 28 },    &quot;102&quot;: { id: 102, name: &quot;zhaowenlin&quot;, age: 8 }}</code></pre><p>è¿™ç§æ–¹å¼ä¸‹ï¼Œæˆ‘ä»¬æƒ³è¦é€‰å‡ºidä¸º101ç”¨æˆ·çš„æ“ä½œæ›´ç®€å•äº†ï¼š</p><pre><code>const idToSelect = &quot;101&quot;;const selectedUser = userObject[idToSelect];// ...</code></pre><p>åªéœ€è¦æŒ‰ç…§å”¯ä¸€idä¾¿å¯è¾¾åˆ°æˆ‘ä»¬çš„ç›®çš„ã€‚å®Œå…¨ä¸å†éœ€è¦éå†ä¸€ä¸ªæ•°ç»„ï¼</p><p>è¿™ç§æ–¹å¼æ›´åŠ ç®€æ´æ¸…æ™°ã€‚æŒ‰ç…§Chris Burginçš„è¯´æ³•ï¼ŒåŒæ ·è¿˜å¯ä»¥â€œremoves mutationâ€ã€‚å½“ç„¶ï¼Œæˆ‘å¯¹æ­¤æŒä¿ç•™æ€åº¦ã€‚</p><h2 id="æ•°æ®è½¬æ¢"><a href="#æ•°æ®è½¬æ¢" class="headerlink" title="æ•°æ®è½¬æ¢"></a>æ•°æ®è½¬æ¢</h2><p>å½“ç„¶ï¼Œåœ¨æŸäº›åœºæ™¯ä¸‹å°±å¦‚ä¸Šæ–‡æ‰€è®²ï¼Œæ•°ç»„è½¬æ¢ä¸ºå¯¹è±¡æ¥å­˜å‚¨æ•°æ®æ˜¯ä¸€ç§æå¥½çš„æ–¹å¼ã€‚å¯æ˜¯æœ‰æ—¶å€™æˆ‘ä»¬å¹¶æ²¡æœ‰è®¾è®¡æ•°æ®çš„ä¸»åŠ¨æƒã€‚æ¯”å¦‚ä»åç«¯è¿”å›çš„æ•°æ®å°±æ˜¯</p><pre><code>    const userArray = [    {        id: 123,        name: &apos;LucasHC&apos;,        age: 18    },    {        id: 456,        name: &apos;maxiao&apos;,        age: 38    },    {        id: 789,        name: &apos;chengwen&apos;,        age: 22    },    {        id: 101,        name: &apos;yanhaijing&apos;,        age: 28    },    {        id: 102,        name: &apos;zhaowenlin&apos;,        age: 8    }]</code></pre><p>è¿™ç§å½¢å¼ã€‚è¿™å°±éœ€è¦æˆ‘ä»¬è¿›è¡Œæ‰‹åŠ¨è½¬æ¢ã€‚å…¶ä¸­ä¸€ç§JSåŸç”Ÿè½¬æ¢æ–¹å¼ä¸ºï¼š</p><pre><code>const arrayToObject = (array) =&gt;    array.reduce((obj, item) =&gt; { obj[item.id] = item; return obj }, {})const idToSelect = &quot;101&quot;;const userObject = arrayToObject(userArray);console.log(userObject[idToSelect]);</code></pre><p>å…³äºreduceå‡½æ•°çš„ç”¨æ³•ï¼Œå¦‚æœæ‚¨è¿˜ä¸ç†Ÿæ‚‰ï¼Œå»ºè®®å»è¡¥ä¸€è¡¥è¯¾ã€‚è¿™ä¸ªæå…·å‡½æ•°å¼é£æƒ…çš„APIç»å¯¹å€¼å¾—å­¦ä¹ ã€‚</p><p>å½“ç„¶æˆ‘ä»¬å¯ä»¥å°†è½¬æ¢å‡½æ•°åšçš„æ›´åŠ é€šç”¨ä¸€äº›ï¼š</p><pre><code>const arrayToObject = (array, keyField) =&gt;   array.reduce((obj, item) =&gt; { obj[item[keyField]] = item;return obj }, {})</code></pre><p>æˆ‘ä»¬æ¥å—keyFieldå‚æ•°ä½œä¸ºæå–å› å­ã€‚</p><p>å½“ç„¶ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æ¢ä¸€ç§å§¿åŠ¿è¿›è¡Œï¼š</p><pre><code>const arrayToObject = (arr, keyField) =&gt;    Object.assign({}, ...arr.map(item =&gt; ({[item[keyField]]: item})))</code></pre><p>è¿™äº›éƒ½èƒ½å®Œå…¨è¾¾åˆ°æˆ‘ä»¬çš„ç›®çš„ã€‚</p><h2 id="ä¸€äº›æ€è€ƒ"><a href="#ä¸€äº›æ€è€ƒ" class="headerlink" title="ä¸€äº›æ€è€ƒ"></a>ä¸€äº›æ€è€ƒ</h2><p>å®ç°äº†æˆ‘ä»¬æ‰€æœ‰æƒ³è¦çš„ç»“æœï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜åº”è¯¥è¿›è¡Œæ›´è¿›ä¸€æ­¥çš„æ€è€ƒã€‚<br>å…³äºä¸¤ç§æ–¹å¼çš„æ¯”è¾ƒï¼Œæˆ‘ä»¬æ€è€ƒè¿™ä¹ˆä¸€ä¸ªé—®é¢˜ï¼šå¦‚æœåœºæ™¯éœ€æ±‚æˆ‘ä»¬åœ¨éå†æ•°æ®æ—¶ä¿è¯é¡ºåºæ€§ï¼Œæˆ–è€…å­˜å‚¨çš„æ•°æ®æœ‰ä¸¥æ ¼çš„é¡ºåºè¦æ±‚ã€‚è¿™æ—¶å€™ä¹Ÿè®¸ä½¿ç”¨æ•°ç»„æ˜¯ä¸€ç§æ›´åŠ å¯é çš„æ–¹æ³•ã€‚</p><p>å¦å¤–ï¼Œæˆ‘ä»¬å®ç°äº†arrayToObjectï¼Œä½†æ˜¯æœ‰æ—¶å€™arrayToMapï¼Œä½¿ç”¨Mapç»“æ„æ¥å­˜å–æ•°æ®ä¹Ÿè®¸æ›´åŠ å¿…è¦ã€‚ES6ä¸ºæˆ‘ä»¬æä¾›äº†Mapæ•°æ®ç»“æ„ã€‚å®ƒæ˜¯ä¸€ä¸ªâ€value-valueâ€çš„å¯¹åº”ã€‚å…³äºä½¿ç”¨Objectè¿˜æ˜¯Mapï¼Œè¿™ä¸¤ç§æ•°æ®ç»“æ„çš„æ¯”è¾ƒï¼Œæˆ‘ç»™å¤§å®¶æ¨è<a href="https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Map#Objects_and_maps_compared" target="_blank" rel="external">è¿™é‡Œï¼Œè¿›è¡Œäº†è§£</a>ï¼Œæ¯•ç«ŸæŸç§æƒ…å†µä¸‹ï¼ŒMapçš„å–å€¼ç›¸æ¯”Objectè¿˜æ˜¯æœ‰ä¼˜åŠ¿çš„ã€‚</p><p>å¦å¤–ï¼Œå…³äºarrayToMapçš„å®ç°ï¼Œä¹Ÿå¾ˆç®€å•ï¼š</p><pre><code>const arrayToMap = (array, keyField) =&gt; new Map(    array.map((item) =&gt; [ item[keyField], item ]))</code></pre><p>æœ€åï¼Œå…³äºå¹¿å—äº‰è®®çš„â€Mutationâ€ä¹‹äº‰ï¼Œæˆ‘ä¹Ÿç»™å‡ºæˆ‘çš„æƒ³æ³•ã€‚Chris Burginçš„å‰åä¸¤ç§å®ç°ï¼Œæˆ‘è®¤ä¸ºæ˜¯å¦å­˜åœ¨Mutation.å…³é”®åœ¨äºï¼šå–å‡ºå…ƒç´ ä¹‹åï¼Œæ¥ä¸‹æ¥ä¼šå¦‚ä½•æ“ä½œå»æ›´æ–°userObject/userArray.<br>æ‹¿update dataä¸¾ä¾‹ï¼Œå¦‚ä¸‹ï¼š</p><pre><code>const userObject = {    &quot;123&quot;: { id: 123, name: &quot;LucasHC&quot;, age: 18 },    &quot;456&quot;: { id: 456, name: &quot;maxiao&quot;, age: 38 },    &quot;789&quot;: { id: 789, name: &quot;chengwen&quot;, age: 22 },    &quot;101&quot;: { id: 101, name: &quot;yanhaijing&quot;, age: 28 },    &quot;102&quot;: { id: 102, name: &quot;zhaowenlin&quot;, age: 8 }}const idToSelect = &quot;101&quot;;const selectedUser = userObject[idToSelect];selectedUser.name = &quot;xulinfeng&quot;;const userObject2 = Object.assign({}, userObject, {    &quot;101&quot;: selectedUser});</code></pre><p>è¿™ç§æ›´æ”¹ï¼Œæˆ‘ä»¬å¾—åˆ°æ›´æ–°åçš„userObject2åŒæ—¶ï¼Œä¹Ÿæ›´æ”¹äº†åŸæœ‰çš„userObject;</p><p>ä½†æ˜¯ä¸ºäº†æ¼”ç¤ºï¼Œæˆ‘ä»¬å¦‚æœåµŒå¥—ä¸¤å±‚Object.assignï¼Œé‚£ä¹ˆå°±ä¸ä¼šæœ‰ç±»ä¼¼é—®é¢˜ã€‚</p><pre><code>const userObject = {    &quot;123&quot;: { id: 123, name: &quot;LucasHC&quot;, age: 18 },    &quot;456&quot;: { id: 456, name: &quot;maxiao&quot;, age: 38 },    &quot;789&quot;: { id: 789, name: &quot;chengwen&quot;, age: 22 },    &quot;101&quot;: { id: 101, name: &quot;yanhaijing&quot;, age: 28 },    &quot;102&quot;: { id: 102, name: &quot;zhaowenlin&quot;, age: 8 }}const idToSelect = &quot;101&quot;;const selectedUser = userObject[idToSelect];const userObject2 = Object.assign({}, userObject, {    &quot;101&quot;: Object.assign({}, selectedUser, {name: &quot;xulinfeng&quot;})});</code></pre><p>å½“ç„¶ï¼Œå­˜åœ¨æ›´ä¼˜é›…çš„æ–¹æ³•ï¼Œæ¯”å¦‚ä½¿ç”¨å¯¹è±¡çš„è§£æ„å»å®ç°ã€‚</p><p>æœ€åï¼Œå…³äºæ•°æ®æ‰å¹³åŒ–çš„è®¾è®¡ä¸Šï¼Œå¤§å®¶å¯ä»¥å…³æ³¨<a href="https://github.com/paularmstrong/normalizr" target="_blank" rel="external">normalizrç±»åº“</a></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æˆ‘æƒ³ï¼Œç”±Chris Burginçš„æ–‡ç« ï¼Œå­¦ä¹ åˆ°çš„çŸ¥è¯†ä¸å°‘ï¼›æ›´é‡è¦çš„æ˜¯ç”±æ­¤å¼•å‡ºçš„æ€è€ƒã€‚å¸Œæœ›è¿™ç¯‡æ–‡ç« å¯¹äºå¤§å®¶åœ¨å‰ç«¯æ•°æ®å­˜å‚¨çš„è®¾è®¡ä¸Šã€Javascriptè¯­è¨€ç‰¹æ€§ä¸Šã€ç”šè‡³å‡½æ•°å¼ç¼–ç¨‹æ€æƒ³ä¸Šç­‰éƒ½æœ‰ä¸åŒç¨‹åº¦çš„å¯å‘ã€‚<br>æ¬¢è¿ä¸æˆ‘è®¨è®ºã€‚</p><p>Happy Coding!</p><p>PS: ä½œè€…<a href="https://github.com/HOUCe" target="_blank" rel="external">Githubä»“åº“</a>ï¼Œæ¬¢è¿é€šè¿‡ä»£ç å„ç§å½¢å¼äº¤æµã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;æœ€è¿‘çœ‹äº†ä¸€ç¯‡Chris Burginçš„&lt;a href=&quot;https://medium.com/dailyjs/rewriting-javascript-converting-an-array-of-objects-to-an-object-ec579cafbfc7&quot; tar
      
    
    </summary>
    
      <category term="js" scheme="https://exp-team.github.io/categories/js/"/>
    
    
      <category term="js" scheme="https://exp-team.github.io/tags/js/"/>
    
  </entry>
  
  <entry>
    <title>expfeæŠ€æœ¯å‘¨åˆŠç¬¬11101æœŸ</title>
    <link href="https://exp-team.github.io/blog/2017/05/12/weekly/weekly-11101/"/>
    <id>https://exp-team.github.io/blog/2017/05/12/weekly/weekly-11101/</id>
    <published>2017-05-11T16:00:00.000Z</published>
    <updated>2017-11-05T02:36:55.000Z</updated>
    
    <content type="html"><![CDATA[<p>5.8-5.12ï¼Œä½ çš„è‹±è¯­æ°´å¹³åˆ¶çº¦ä½ çš„å­¦ä¹ äº†å—ï¼Ÿ</p><a id="more"></a><h2 id="æœ¬æœŸæ¨è"><a href="#æœ¬æœŸæ¨è" class="headerlink" title="æœ¬æœŸæ¨è"></a>æœ¬æœŸæ¨è</h2><h3 id="ç¨‹åºå‘˜æ‹¿ä»€ä¹ˆæ¥å­¦è‹±è¯­"><a href="#ç¨‹åºå‘˜æ‹¿ä»€ä¹ˆæ¥å­¦è‹±è¯­" class="headerlink" title="ç¨‹åºå‘˜æ‹¿ä»€ä¹ˆæ¥å­¦è‹±è¯­"></a><a href="http://www.jianshu.com/p/5c3f19c78f25" target="_blank" rel="external">ç¨‹åºå‘˜æ‹¿ä»€ä¹ˆæ¥å­¦è‹±è¯­</a></h3><h3 id="è€ç”Ÿå¸¸è°ˆ-ä»è¾“å…¥urlåˆ°é¡µé¢å±•ç¤ºåˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆ"><a href="#è€ç”Ÿå¸¸è°ˆ-ä»è¾“å…¥urlåˆ°é¡µé¢å±•ç¤ºåˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆ" class="headerlink" title="è€ç”Ÿå¸¸è°ˆ-ä»è¾“å…¥urlåˆ°é¡µé¢å±•ç¤ºåˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆ"></a><a href="http://www.cnblogs.com/xianyulaodi/p/6547807.html" target="_blank" rel="external">è€ç”Ÿå¸¸è°ˆ-ä»è¾“å…¥urlåˆ°é¡µé¢å±•ç¤ºåˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆ</a></h3><h3 id="åœ¨-2017-å¹´å­¦ä¹ -React-Redux-çš„ä¸€äº›å»ºè®®ï¼ˆä¸Šç¯‡ï¼‰"><a href="#åœ¨-2017-å¹´å­¦ä¹ -React-Redux-çš„ä¸€äº›å»ºè®®ï¼ˆä¸Šç¯‡ï¼‰" class="headerlink" title="åœ¨ 2017 å¹´å­¦ä¹  React + Redux çš„ä¸€äº›å»ºè®®ï¼ˆä¸Šç¯‡ï¼‰"></a><a href="https://github.com/iuap-design/blog/issues/178" target="_blank" rel="external">åœ¨ 2017 å¹´å­¦ä¹  React + Redux çš„ä¸€äº›å»ºè®®ï¼ˆä¸Šç¯‡ï¼‰</a></h3><h3 id="CSS"><a href="#CSS" class="headerlink" title="CSS"></a>CSS</h3><h3 id="CSS-å˜é‡æ•™ç¨‹"><a href="#CSS-å˜é‡æ•™ç¨‹" class="headerlink" title="CSS å˜é‡æ•™ç¨‹"></a><a href="http://www.ruanyifeng.com/blog/2017/05/css-variables.html" target="_blank" rel="external">CSS å˜é‡æ•™ç¨‹</a></h3><h3 id="JavaScript"><a href="#JavaScript" class="headerlink" title="JavaScript"></a>JavaScript</h3><h3 id="æ€ä¹ˆç”¨ç›®å‰æœ€å¥½çš„å·¥å…·æ¥è°ƒè¯•Node-js"><a href="#æ€ä¹ˆç”¨ç›®å‰æœ€å¥½çš„å·¥å…·æ¥è°ƒè¯•Node-js" class="headerlink" title="æ€ä¹ˆç”¨ç›®å‰æœ€å¥½çš„å·¥å…·æ¥è°ƒè¯•Node.js"></a><a href="http://zcfy.cc/article/how-to-debug-node-js-with-the-best-tools-available-risingstack-2710.html" target="_blank" rel="external">æ€ä¹ˆç”¨ç›®å‰æœ€å¥½çš„å·¥å…·æ¥è°ƒè¯•Node.js</a></h3><h3 id="æ„å»º-React-js-åº”ç”¨çš„åä½³-UI-æ¡†æ¶ï¼Œéƒ½åœ¨è¿™äº†ï¼"><a href="#æ„å»º-React-js-åº”ç”¨çš„åä½³-UI-æ¡†æ¶ï¼Œéƒ½åœ¨è¿™äº†ï¼" class="headerlink" title="æ„å»º React.js åº”ç”¨çš„åä½³ UI æ¡†æ¶ï¼Œéƒ½åœ¨è¿™äº†ï¼"></a><a href="https://my.oschina.net/editorial-story/blog/897707" target="_blank" rel="external">æ„å»º React.js åº”ç”¨çš„åä½³ UI æ¡†æ¶ï¼Œéƒ½åœ¨è¿™äº†ï¼</a></h3><h3 id="React-é«˜é˜¶ç»„ä»¶-HOC-å…¥é—¨æŒ‡å—"><a href="#React-é«˜é˜¶ç»„ä»¶-HOC-å…¥é—¨æŒ‡å—" class="headerlink" title="React é«˜é˜¶ç»„ä»¶(HOC)å…¥é—¨æŒ‡å—"></a><a href="https://juejin.im/post/5914fb4a0ce4630069d1f3f6" target="_blank" rel="external">React é«˜é˜¶ç»„ä»¶(HOC)å…¥é—¨æŒ‡å—</a></h3><h3 id="ES6-æ¨¡å—åŸç”Ÿæ”¯æŒåœ¨æµè§ˆå™¨ä¸­è½åœ°ï¼Œæ˜¯æ—¶å€™è¯¥é‡æ–°è€ƒè™‘æ‰“åŒ…äº†å—ï¼Ÿ"><a href="#ES6-æ¨¡å—åŸç”Ÿæ”¯æŒåœ¨æµè§ˆå™¨ä¸­è½åœ°ï¼Œæ˜¯æ—¶å€™è¯¥é‡æ–°è€ƒè™‘æ‰“åŒ…äº†å—ï¼Ÿ" class="headerlink" title="ES6 æ¨¡å—åŸç”Ÿæ”¯æŒåœ¨æµè§ˆå™¨ä¸­è½åœ°ï¼Œæ˜¯æ—¶å€™è¯¥é‡æ–°è€ƒè™‘æ‰“åŒ…äº†å—ï¼Ÿ"></a><a href="https://juejin.im/post/590a990a5c497d005852cf61" target="_blank" rel="external">ES6 æ¨¡å—åŸç”Ÿæ”¯æŒåœ¨æµè§ˆå™¨ä¸­è½åœ°ï¼Œæ˜¯æ—¶å€™è¯¥é‡æ–°è€ƒè™‘æ‰“åŒ…äº†å—ï¼Ÿ</a></h3><h3 id="javascriptä¸­é‚£äº›æŠ˜ç£¨äººçš„é¢è¯•é¢˜"><a href="#javascriptä¸­é‚£äº›æŠ˜ç£¨äººçš„é¢è¯•é¢˜" class="headerlink" title="javascriptä¸­é‚£äº›æŠ˜ç£¨äººçš„é¢è¯•é¢˜"></a><a href="https://segmentfault.com/a/1190000006129337" target="_blank" rel="external">javascriptä¸­é‚£äº›æŠ˜ç£¨äººçš„é¢è¯•é¢˜</a></h3>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;5.8-5.12ï¼Œä½ çš„è‹±è¯­æ°´å¹³åˆ¶çº¦ä½ çš„å­¦ä¹ äº†å—ï¼Ÿ&lt;/p&gt;
    
    </summary>
    
      <category term="weekly" scheme="https://exp-team.github.io/categories/weekly/"/>
    
    
      <category term="weekly" scheme="https://exp-team.github.io/tags/weekly/"/>
    
  </entry>
  
  <entry>
    <title>expfeæŠ€æœ¯å‘¨åˆŠç¬¬11100æœŸ</title>
    <link href="https://exp-team.github.io/blog/2017/05/05/weekly/weekly-11100/"/>
    <id>https://exp-team.github.io/blog/2017/05/05/weekly/weekly-11100/</id>
    <published>2017-05-04T16:00:00.000Z</published>
    <updated>2017-11-05T02:36:55.000Z</updated>
    
    <content type="html"><![CDATA[<p>5.1-5.5ï¼Œä½ æ²¡å­¦å¥½ï¼Œä¸åªæ˜¯è´¥ç»™äº†æ—¶é—´</p><a id="more"></a><h2 id="æœ¬æœŸæ¨è"><a href="#æœ¬æœŸæ¨è" class="headerlink" title="æœ¬æœŸæ¨è"></a>æœ¬æœŸæ¨è</h2><h3 id="HTTP-HTTP2-0-SPDY-HTTPSçœ‹è¿™ç¯‡å°±å¤Ÿäº†"><a href="#HTTP-HTTP2-0-SPDY-HTTPSçœ‹è¿™ç¯‡å°±å¤Ÿäº†" class="headerlink" title="HTTP,HTTP2.0,SPDY,HTTPSçœ‹è¿™ç¯‡å°±å¤Ÿäº†"></a><a href="http://m.sanwen8.cn/p/3edfj7S.html" target="_blank" rel="external">HTTP,HTTP2.0,SPDY,HTTPSçœ‹è¿™ç¯‡å°±å¤Ÿäº†</a></h3><h3 id="ä½ æ²¡å­¦å¥½ï¼Œä¸åªæ˜¯è´¥ç»™äº†æ—¶é—´"><a href="#ä½ æ²¡å­¦å¥½ï¼Œä¸åªæ˜¯è´¥ç»™äº†æ—¶é—´" class="headerlink" title="ä½ æ²¡å­¦å¥½ï¼Œä¸åªæ˜¯è´¥ç»™äº†æ—¶é—´"></a><a href="https://mp.weixin.qq.com/s?__biz=MjM5ODQ2MDIyMA==&amp;mid=2650713198&amp;idx=1&amp;sn=c59420502eeedcb1c1c28c4ecebe9799&amp;chksm=bec0623d89b7eb2b5b0efe26597f7aa186e44fcbbeba09343ba81f5e061d2b8286794b2dc866&amp;mpshare=1&amp;scene=1&amp;srcid=0427JqH0mUhXFREOJQRjCH9n#rd" target="_blank" rel="external">ä½ æ²¡å­¦å¥½ï¼Œä¸åªæ˜¯è´¥ç»™äº†æ—¶é—´</a></h3><h3 id="æˆ‘æ˜¯è¿™æ ·å­¦ä¹ å‰ç«¯çš„"><a href="#æˆ‘æ˜¯è¿™æ ·å­¦ä¹ å‰ç«¯çš„" class="headerlink" title="æˆ‘æ˜¯è¿™æ ·å­¦ä¹ å‰ç«¯çš„"></a><a href="https://github.com/icepy/we-writing/issues/39" target="_blank" rel="external">æˆ‘æ˜¯è¿™æ ·å­¦ä¹ å‰ç«¯çš„</a></h3><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="React-Conf-2017-å¹²è´§æ€»ç»“1-React-ES-next-â™¥"><a href="#React-Conf-2017-å¹²è´§æ€»ç»“1-React-ES-next-â™¥" class="headerlink" title="React Conf 2017 å¹²è´§æ€»ç»“1: React + ES next = â™¥"></a><a href="http://www.jianshu.com/p/83c86dd0802d" target="_blank" rel="external">React Conf 2017 å¹²è´§æ€»ç»“1: React + ES next = â™¥</a></h3><h3 id="å‡½æ•°å¼ç¼–ç¨‹å…¥é—¨æ•™ç¨‹"><a href="#å‡½æ•°å¼ç¼–ç¨‹å…¥é—¨æ•™ç¨‹" class="headerlink" title="å‡½æ•°å¼ç¼–ç¨‹å…¥é—¨æ•™ç¨‹"></a><a href="http://www.ruanyifeng.com/blog/2017/02/fp-tutorial.html" target="_blank" rel="external">å‡½æ•°å¼ç¼–ç¨‹å…¥é—¨æ•™ç¨‹</a></h3><h3 id="ç™¾åº¦é å®ƒå›éœ¸ä¸»åœ°ä½ï¼ŸMIPã€PWAä¸¤å¤§æ‹›æ”¹å˜æœç´¢"><a href="#ç™¾åº¦é å®ƒå›éœ¸ä¸»åœ°ä½ï¼ŸMIPã€PWAä¸¤å¤§æ‹›æ”¹å˜æœç´¢" class="headerlink" title="ç™¾åº¦é å®ƒå›éœ¸ä¸»åœ°ä½ï¼ŸMIPã€PWAä¸¤å¤§æ‹›æ”¹å˜æœç´¢"></a><a href="https://mp.weixin.qq.com/s?__biz=MzI2NzEzNDg2Mg==&amp;mid=2650195907&amp;idx=1&amp;sn=cd8a699951b0ce31b828226fc03cf18c&amp;chksm=f2811522c5f69c348ea4bf6ab86bbd3a46fd2cf37f79a054cd9f1e6bbe06b094636c2d3ea776&amp;mpshare=1&amp;scene=1&amp;srcid=0426qjKqiI5HJunPHMGNoDtc#rd" target="_blank" rel="external">ç™¾åº¦é å®ƒå›éœ¸ä¸»åœ°ä½ï¼ŸMIPã€PWAä¸¤å¤§æ‹›æ”¹å˜æœç´¢</a></h3><h3 id="é€šè¿‡-PWA-æˆ‘ä»¬è®©æ–°ç”¨æˆ·è½¬åŒ–ç‡æå‡äº†-104"><a href="#é€šè¿‡-PWA-æˆ‘ä»¬è®©æ–°ç”¨æˆ·è½¬åŒ–ç‡æå‡äº†-104" class="headerlink" title="é€šè¿‡ PWA æˆ‘ä»¬è®©æ–°ç”¨æˆ·è½¬åŒ–ç‡æå‡äº† 104%"></a><a href="https://zhuanlan.zhihu.com/p/26445223" target="_blank" rel="external">é€šè¿‡ PWA æˆ‘ä»¬è®©æ–°ç”¨æˆ·è½¬åŒ–ç‡æå‡äº† 104%</a></h3><h3 id="å•é¡µå¼åº”ç”¨æ€§èƒ½ä¼˜åŒ–-é¦–å±æ•°æ®æ¸è¿›å¼é¢„åŠ è½½"><a href="#å•é¡µå¼åº”ç”¨æ€§èƒ½ä¼˜åŒ–-é¦–å±æ•°æ®æ¸è¿›å¼é¢„åŠ è½½" class="headerlink" title="å•é¡µå¼åº”ç”¨æ€§èƒ½ä¼˜åŒ– - é¦–å±æ•°æ®æ¸è¿›å¼é¢„åŠ è½½"></a><a href="https://juejin.im/entry/58ff0ea78d6d810058a6a3c5" target="_blank" rel="external">å•é¡µå¼åº”ç”¨æ€§èƒ½ä¼˜åŒ– - é¦–å±æ•°æ®æ¸è¿›å¼é¢„åŠ è½½</a></h3><h3 id="é«˜æ€§èƒ½æ»šåŠ¨-scroll-åŠé¡µé¢æ¸²æŸ“ä¼˜åŒ–"><a href="#é«˜æ€§èƒ½æ»šåŠ¨-scroll-åŠé¡µé¢æ¸²æŸ“ä¼˜åŒ–" class="headerlink" title="é«˜æ€§èƒ½æ»šåŠ¨ scroll åŠé¡µé¢æ¸²æŸ“ä¼˜åŒ–"></a><a href="http://web.jobbole.com/86158/" target="_blank" rel="external">é«˜æ€§èƒ½æ»šåŠ¨ scroll åŠé¡µé¢æ¸²æŸ“ä¼˜åŒ–</a></h3><h3 id="å¦‚ä½•ç”¨-JavaScript-å®ç°çœŸæ­£çš„ç§æœ‰å±æ€§"><a href="#å¦‚ä½•ç”¨-JavaScript-å®ç°çœŸæ­£çš„ç§æœ‰å±æ€§" class="headerlink" title="å¦‚ä½•ç”¨ JavaScript å®ç°çœŸæ­£çš„ç§æœ‰å±æ€§"></a><a href="https://mp.weixin.qq.com/s?__biz=MzA4NjE3MDg4OQ==&amp;mid=2650964432&amp;idx=1&amp;sn=fcc4e6b1e3b82f98c309bbd52e9d46ee&amp;chksm=843aedb6b34d64a0c32a53ad8ba877385d6edb78cbda73454755dd4d7b505e8f3aae04f9a541&amp;mpshare=1&amp;scene=1&amp;srcid=0418PcXD5JXFklIavqSXvGEQ" target="_blank" rel="external">å¦‚ä½•ç”¨ JavaScript å®ç°çœŸæ­£çš„ç§æœ‰å±æ€§</a></h3><h3 id="ä¸ºä»€ä¹ˆä½ ç»Ÿè®¡-PV-çš„æ–¹å¼æ˜¯é”™çš„ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆä½ ç»Ÿè®¡-PV-çš„æ–¹å¼æ˜¯é”™çš„ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆä½ ç»Ÿè®¡ PV çš„æ–¹å¼æ˜¯é”™çš„ï¼Ÿ"></a><a href="https://zhuanlan.zhihu.com/p/26341409" target="_blank" rel="external">ä¸ºä»€ä¹ˆä½ ç»Ÿè®¡ PV çš„æ–¹å¼æ˜¯é”™çš„ï¼Ÿ</a></h3><h2 id="Other"><a href="#Other" class="headerlink" title="Other"></a>Other</h2><h3 id="æˆ‘ä¸ºä»€ä¹ˆä¸åœ¨ä¹äººå·¥æ™ºèƒ½"><a href="#æˆ‘ä¸ºä»€ä¹ˆä¸åœ¨ä¹äººå·¥æ™ºèƒ½" class="headerlink" title="æˆ‘ä¸ºä»€ä¹ˆä¸åœ¨ä¹äººå·¥æ™ºèƒ½"></a><a href="http://www.yinwang.org/blog-cn/2017/04/23/ai" target="_blank" rel="external">æˆ‘ä¸ºä»€ä¹ˆä¸åœ¨ä¹äººå·¥æ™ºèƒ½</a></h3>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;5.1-5.5ï¼Œä½ æ²¡å­¦å¥½ï¼Œä¸åªæ˜¯è´¥ç»™äº†æ—¶é—´&lt;/p&gt;
    
    </summary>
    
      <category term="weekly" scheme="https://exp-team.github.io/categories/weekly/"/>
    
    
      <category term="weekly" scheme="https://exp-team.github.io/tags/weekly/"/>
    
  </entry>
  
</feed>
